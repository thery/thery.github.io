<!DOCTYPE html>
<html class="alectryon-standalone"><head><title>extra.v</title><meta charset="utf-8"><meta content="Alectryon" name="generator"><meta name="viewport" content="width=device-width, initial-scale=1"><link href="alectryon.css" rel="stylesheet"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" /><script src="alectryon.js"></script><style type="text/css">pre { line-height: 125%; }
td.linenos pre { color: #000000; background-color: #f0f0f0; padding-left: 5px; padding-right: 5px; }
span.linenos { color: #000000; background-color: #f0f0f0; padding-left: 5px; padding-right: 5px; }
td.linenos pre.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight .c { color: #555753; font-style: italic } /* Comment */
.highlight .err { color: #a40000; border: 1px solid #cc0000 } /* Error */
.highlight .g { color: #000000 } /* Generic */
.highlight .k { color: #8f5902 } /* Keyword */
.highlight .l { color: #2e3436 } /* Literal */
.highlight .n { color: #000000 } /* Name */
.highlight .o { color: #000000 } /* Operator */
.highlight .x { color: #2e3436 } /* Other */
.highlight .p { color: #000000 } /* Punctuation */
.highlight .ch { color: #555753; font-weight: bold; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #555753; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #3465a4; font-style: italic } /* Comment.Preproc */
.highlight .cpf { color: #555753; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #555753; font-style: italic } /* Comment.Single */
.highlight .cs { color: #3465a4; font-weight: bold; font-style: italic } /* Comment.Special */
.highlight .gd { color: #a40000 } /* Generic.Deleted */
.highlight .ge { color: #000000; font-style: italic } /* Generic.Emph */
.highlight .gr { color: #a40000 } /* Generic.Error */
.highlight .gh { color: #a40000; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #4e9a06 } /* Generic.Inserted */
.highlight .go { color: #000000; font-style: italic } /* Generic.Output */
.highlight .gp { color: #8f5902 } /* Generic.Prompt */
.highlight .gs { color: #000000; font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #000000; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #000000; font-style: italic } /* Generic.Traceback */
.highlight .kc { color: #204a87; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #4e9a06; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #4e9a06; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #204a87 } /* Keyword.Pseudo */
.highlight .kr { color: #8f5902 } /* Keyword.Reserved */
.highlight .kt { color: #204a87 } /* Keyword.Type */
.highlight .ld { color: #2e3436 } /* Literal.Date */
.highlight .m { color: #2e3436 } /* Literal.Number */
.highlight .s { color: #ad7fa8 } /* Literal.String */
.highlight .na { color: #c4a000 } /* Name.Attribute */
.highlight .nb { color: #75507b } /* Name.Builtin */
.highlight .nc { color: #204a87 } /* Name.Class */
.highlight .no { color: #ce5c00 } /* Name.Constant */
.highlight .nd { color: #3465a4; font-weight: bold } /* Name.Decorator */
.highlight .ni { color: #c4a000; text-decoration: underline } /* Name.Entity */
.highlight .ne { color: #cc0000 } /* Name.Exception */
.highlight .nf { color: #a40000 } /* Name.Function */
.highlight .nl { color: #3465a4; font-weight: bold } /* Name.Label */
.highlight .nn { color: #000000 } /* Name.Namespace */
.highlight .nx { color: #000000 } /* Name.Other */
.highlight .py { color: #000000 } /* Name.Property */
.highlight .nt { color: #a40000 } /* Name.Tag */
.highlight .nv { color: #ce5c00 } /* Name.Variable */
.highlight .ow { color: #8f5902 } /* Operator.Word */
.highlight .w { color: #d3d7cf; text-decoration: underline } /* Text.Whitespace */
.highlight .mb { color: #2e3436 } /* Literal.Number.Bin */
.highlight .mf { color: #2e3436 } /* Literal.Number.Float */
.highlight .mh { color: #2e3436 } /* Literal.Number.Hex */
.highlight .mi { color: #2e3436 } /* Literal.Number.Integer */
.highlight .mo { color: #2e3436 } /* Literal.Number.Oct */
.highlight .sa { color: #ad7fa8 } /* Literal.String.Affix */
.highlight .sb { color: #ad7fa8 } /* Literal.String.Backtick */
.highlight .sc { color: #ad7fa8; font-weight: bold } /* Literal.String.Char */
.highlight .dl { color: #ad7fa8 } /* Literal.String.Delimiter */
.highlight .sd { color: #ad7fa8 } /* Literal.String.Doc */
.highlight .s2 { color: #ad7fa8 } /* Literal.String.Double */
.highlight .se { color: #ad7fa8; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #ad7fa8; text-decoration: underline } /* Literal.String.Heredoc */
.highlight .si { color: #ce5c00 } /* Literal.String.Interpol */
.highlight .sx { color: #ad7fa8 } /* Literal.String.Other */
.highlight .sr { color: #ad7fa8 } /* Literal.String.Regex */
.highlight .s1 { color: #ad7fa8 } /* Literal.String.Single */
.highlight .ss { color: #8f5902 } /* Literal.String.Symbol */
.highlight .bp { color: #5c35cc } /* Name.Builtin.Pseudo */
.highlight .fm { color: #a40000 } /* Name.Function.Magic */
.highlight .vc { color: #ce5c00 } /* Name.Variable.Class */
.highlight .vg { color: #ce5c00; text-decoration: underline } /* Name.Variable.Global */
.highlight .vi { color: #ce5c00 } /* Name.Variable.Instance */
.highlight .vm { color: #ce5c00 } /* Name.Variable.Magic */
.highlight .il { color: #2e3436 } /* Literal.Number.Integer.Long */</style></head><body><article class="alectryon-root alectryon-centered alectryon-coqdoc"><div class="alectryon-banner">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running Coq+SerAPI v8.13.0+0.13.0. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus. On Mac, use <kbd>‚åò</kbd> instead of <kbd>Ctrl</kbd>.</div><pre class="alectryon-io"><!-- Generator: Alectryon --><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk0" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk0"><span class="highlight"><span class="kn">From</span> mathcomp <span class="kn">Require Import</span> all_ssreflect finmap.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-messages"><blockquote class="alectryon-message"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;[ rel _ _ | _ ]&quot;</span> was already used <span class="kr">in</span> scope
fun_scope. [notation-overridden,parsing]</span></blockquote><blockquote class="alectryon-message"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;[ rel _ _ : _ | _ ]&quot;</span> was already used <span class="kr">in</span>
scope fun_scope. [notation-overridden,parsing]</span></blockquote><blockquote class="alectryon-message"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;[ rel _ _ in _ &amp; _ | _ ]&quot;</span> was already used
<span class="kr">in</span> scope fun_scope. [notation-overridden,parsing]</span></blockquote><blockquote class="alectryon-message"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;[ rel _ _ in _ &amp; _ ]&quot;</span> was already used <span class="kr">in</span>
scope fun_scope. [notation-overridden,parsing]</span></blockquote><blockquote class="alectryon-message"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;[ rel _ _ in _ | _ ]&quot;</span> was already used <span class="kr">in</span>
scope fun_scope. [notation-overridden,parsing]</span></blockquote><blockquote class="alectryon-message"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;[ rel _ _ in _ ]&quot;</span> was already used <span class="kr">in</span> scope
fun_scope. [notation-overridden,parsing]</span></blockquote><blockquote class="alectryon-message"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;_ + _&quot;</span> was already used <span class="kr">in</span> scope nat_scope.
[notation-overridden,parsing]</span></blockquote><blockquote class="alectryon-message"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;_ - _&quot;</span> was already used <span class="kr">in</span> scope nat_scope.
[notation-overridden,parsing]</span></blockquote><blockquote class="alectryon-message"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;_ &lt;= _&quot;</span> was already used <span class="kr">in</span> scope nat_scope.
[notation-overridden,parsing]</span></blockquote><blockquote class="alectryon-message"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;_ &lt; _&quot;</span> was already used <span class="kr">in</span> scope nat_scope.
[notation-overridden,parsing]</span></blockquote><blockquote class="alectryon-message"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;_ &gt;= _&quot;</span> was already used <span class="kr">in</span> scope nat_scope.
[notation-overridden,parsing]</span></blockquote><blockquote class="alectryon-message"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;_ &gt; _&quot;</span> was already used <span class="kr">in</span> scope nat_scope.
[notation-overridden,parsing]</span></blockquote><blockquote class="alectryon-message"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;_ &lt;= _ &lt;= _&quot;</span> was already used <span class="kr">in</span> scope
nat_scope. [notation-overridden,parsing]</span></blockquote><blockquote class="alectryon-message"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;_ &lt; _ &lt;= _&quot;</span> was already used <span class="kr">in</span> scope
nat_scope. [notation-overridden,parsing]</span></blockquote><blockquote class="alectryon-message"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;_ &lt;= _ &lt; _&quot;</span> was already used <span class="kr">in</span> scope
nat_scope. [notation-overridden,parsing]</span></blockquote><blockquote class="alectryon-message"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;_ &lt; _ &lt; _&quot;</span> was already used <span class="kr">in</span> scope
nat_scope. [notation-overridden,parsing]</span></blockquote><blockquote class="alectryon-message"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;_ * _&quot;</span> was already used <span class="kr">in</span> scope nat_scope.
[notation-overridden,parsing]</span></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Set Implicit Arguments</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Unset Strict Implicit</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="sd">(******************************************************************************)</span>
<span class="c">(*                                                                            *)</span>
<span class="c">(*   Extra theorems and definitions                                           *)</span>
<span class="c">(*                                                                            *)</span>
<span class="sd">(******************************************************************************)</span>

<span class="sd">(******************************************************************************)</span>
<span class="c">(*                                                                            *)</span>
<span class="c">(*   Extra theorems about lists                                               *)</span>
<span class="c">(*                                                                            *)</span>
<span class="sd">(******************************************************************************)</span>


</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">rcons_injl</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">a</span>: seq A) : injective (rcons a).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">injective (rcons a)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk2" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk2"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">injective (rcons a)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">elim</span>: a =&gt; /= [s1 s2 /= [] | b l IH s1 s2 [] /IH].</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk3" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk3"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">rcons_injr</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">a</span>: A) : injective (rcons ^~a).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">injective (rcons^~ a)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk4" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk4"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">injective (rcons^~ a)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk5" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk5"><span class="highlight"><span class="nb">elim</span> =&gt; [ [|b [|c]] //= | b s1 IH /= [/= [] -&gt; |c s2 [] -&gt; /IH-&gt; //]].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">x2</span> : seq A,
rcons s1 a = rcons x2 a -&gt; s1 = x2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">rcons s1 a = [::] -&gt; a :: s1 = [::]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">case</span>: (s1) =&gt; // [] [].</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk6" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk6"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">cat_injl</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">a</span>: seq A) : injective (cat a).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">injective (cat a)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk7" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk7"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">injective (cat a)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">elim</span>: a =&gt; // b l IH s1 s2 /= [] /IH.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk8" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk8"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">cat_injr</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">a</span>: seq A) : injective (cat ^~a).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">injective (cat^~ a)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk9" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk9"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">injective (cat^~ a)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chka" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chka"><span class="highlight"><span class="nb">elim</span>: a =&gt; [s1 s2 |b l IH s1 s2]; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> !cats0.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kt">Type</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">injective (cat^~ l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">s1 ++ b :: l = s2 ++ b :: l -&gt; s1 = s2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> -!cat_rcons =&gt; /IH; <span class="nb">apply</span>: rcons_injr.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkb" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkb"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">in_split</span> (<span class="nv">A</span> : eqType) (<span class="nv">a</span> : A)  <span class="nv">l</span> :
  a \<span class="kr">in</span> l -&gt; <span class="kr">exists</span> <span class="nv">l1</span>, <span class="kr">exists</span> <span class="nv">l2</span>, l = l1 ++ a :: l2.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq_predType A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">a \<span class="kr">in</span> l -&gt; <span class="kr">exists</span> <span class="nv">l1</span> <span class="nv">l2</span> : seq A, l = l1 ++ a :: l2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkc" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkc"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq_predType A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">a \<span class="kr">in</span> l -&gt; <span class="kr">exists</span> <span class="nv">l1</span> <span class="nv">l2</span> : seq A, l = l1 ++ a :: l2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkd" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkd"><span class="highlight"><span class="nb">elim</span>: l =&gt; //= b l IH; <span class="nb">rewrite</span> inE =&gt; /orP[/eqP&lt;-|aIl].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a \<span class="kr">in</span> l -&gt;
<span class="kr">exists</span> <span class="nv">l1</span> <span class="nv">l2</span> : seq A, l = l1 ++ a :: l2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">l1</span> <span class="nv">l2</span> : seq A, a :: l = l1 ++ a :: l2</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chke" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a \<span class="kr">in</span> l -&gt;
<span class="kr">exists</span> <span class="nv">l1</span> <span class="nv">l2</span> : seq A, l = l1 ++ a :: l2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">aIl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a \<span class="kr">in</span> l</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chke"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">l1</span> <span class="nv">l2</span> : seq A, b :: l = l1 ++ a :: l2</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkf" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkf"><span class="highlight"><span class="bp">by</span> <span class="kr">exists</span> [::]; <span class="kr">exists</span> <span class="nv">l</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a \<span class="kr">in</span> l -&gt;
<span class="kr">exists</span> <span class="nv">l1</span> <span class="nv">l2</span> : seq A, l = l1 ++ a :: l2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">aIl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a \<span class="kr">in</span> l</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">l1</span> <span class="nv">l2</span> : seq A, b :: l = l1 ++ a :: l2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk10" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk10"><span class="highlight"><span class="nb">case</span>: (IH aIl) =&gt; l1 [l2 lE].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a \<span class="kr">in</span> l -&gt;
<span class="kr">exists</span> <span class="nv">l1</span> <span class="nv">l2</span> : seq A, l = l1 ++ a :: l2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">aIl</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a \<span class="kr">in</span> l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1, l2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">lE</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">l = l1 ++ a :: l2</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists</span> <span class="nv">l1</span> <span class="nv">l2</span> : seq A, b :: l = l1 ++ a :: l2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="kr">exists</span> (<span class="nv">b</span> :: l1); <span class="kr">exists</span> <span class="nv">l2</span>; <span class="nb">rewrite</span> /= lE.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk11" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk11"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">split_first</span> (<span class="nv">A</span> : eqType) (<span class="nv">l</span> : seq A) (<span class="nv">P</span> : pred A) :
  ~~ <span class="kp">all</span> [predC P] l -&gt; {bl1l2 : (A * seq A * seq A) |
    [/\ <span class="kp">all</span> [predC P] bl1l2.<span class="mi">1</span>.<span class="mi">2</span>, P bl1l2.<span class="mi">1</span>.<span class="mi">1</span> &amp;  
             l = bl1l2.<span class="mi">1</span>.<span class="mi">2</span> ++ bl1l2.<span class="mi">1</span>.<span class="mi">1</span> :: bl1l2.<span class="mi">2</span>]}.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">pred A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~~ <span class="kp">all</span> [predC P] l -&gt;
{bl1l2 : A * seq A * seq A
| [/\ <span class="kp">all</span> [predC P] bl1l2.<span class="mi">1</span>.<span class="mi">2</span>, P bl1l2.<span class="mi">1</span>.<span class="mi">1</span>
    &amp; l = bl1l2.<span class="mi">1</span>.<span class="mi">2</span> ++ bl1l2.<span class="mi">1</span>.<span class="mi">1</span> :: bl1l2.<span class="mi">2</span>]}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk12" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk12"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">pred A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~~ <span class="kp">all</span> [predC P] l -&gt;
{bl1l2 : A * seq A * seq A
| [/\ <span class="kp">all</span> [predC P] bl1l2.<span class="mi">1</span>.<span class="mi">2</span>, P bl1l2.<span class="mi">1</span>.<span class="mi">1</span>
    &amp; l = bl1l2.<span class="mi">1</span>.<span class="mi">2</span> ++ bl1l2.<span class="mi">1</span>.<span class="mi">1</span> :: bl1l2.<span class="mi">2</span>]}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk13" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk13"><span class="highlight"><span class="nb">elim</span>: l =&gt; //= b l IH.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">pred A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ <span class="kp">all</span> [predC P] l -&gt;
{bl1l2 : A * seq A * seq A
| [/\ <span class="kp">all</span> [predC P] bl1l2.<span class="mi">1</span>.<span class="mi">2</span>, P bl1l2.<span class="mi">1</span>.<span class="mi">1</span>
    &amp; l = bl1l2.<span class="mi">1</span>.<span class="mi">2</span> ++ bl1l2.<span class="mi">1</span>.<span class="mi">1</span> :: bl1l2.<span class="mi">2</span>]}</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~~ ((b \notin P) &amp;&amp; <span class="kp">all</span> [predC P] l) -&gt;
{bl1l2 : A * seq A * seq A
| [/\ <span class="kp">all</span> [predC P] bl1l2.<span class="mi">1</span>.<span class="mi">2</span>, P bl1l2.<span class="mi">1</span>.<span class="mi">1</span>
    &amp; b :: l = bl1l2.<span class="mi">1</span>.<span class="mi">2</span> ++ bl1l2.<span class="mi">1</span>.<span class="mi">1</span> :: bl1l2.<span class="mi">2</span>]}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk14" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk14"><span class="highlight"><span class="nb">rewrite</span> negb_and negbK; <span class="nb">case</span>: (boolP (b \<span class="kr">in</span> P)) =&gt;
      [bIP _| bNIP /= /IH [[[c l1] l2] [H1 H2 -&gt;]]].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">pred A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ <span class="kp">all</span> [predC P] l -&gt;
{bl1l2 : A * seq A * seq A
| [/\ <span class="kp">all</span> [predC P] bl1l2.<span class="mi">1</span>.<span class="mi">2</span>, P bl1l2.<span class="mi">1</span>.<span class="mi">1</span>
    &amp; l = bl1l2.<span class="mi">1</span>.<span class="mi">2</span> ++ bl1l2.<span class="mi">1</span>.<span class="mi">1</span> :: bl1l2.<span class="mi">2</span>]}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">bIP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">b \<span class="kr">in</span> P</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">{bl1l2 : A * seq A * seq A
| [/\ <span class="kp">all</span> [predC P] bl1l2.<span class="mi">1</span>.<span class="mi">2</span>, P bl1l2.<span class="mi">1</span>.<span class="mi">1</span>
    &amp; b :: l = bl1l2.<span class="mi">1</span>.<span class="mi">2</span> ++ bl1l2.<span class="mi">1</span>.<span class="mi">1</span> :: bl1l2.<span class="mi">2</span>]}</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk15" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">pred A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ <span class="kp">all</span> [predC P] l -&gt;
{bl1l2 : A * seq A * seq A
| [/\ <span class="kp">all</span> [predC P] bl1l2.<span class="mi">1</span>.<span class="mi">2</span>, P bl1l2.<span class="mi">1</span>.<span class="mi">1</span>
    &amp; l = bl1l2.<span class="mi">1</span>.<span class="mi">2</span> ++ bl1l2.<span class="mi">1</span>.<span class="mi">1</span> :: bl1l2.<span class="mi">2</span>]}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">bNIP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">b \notin P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1, l2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">all</span> [predC P] (c, l1, l2).<span class="mi">1</span>.<span class="mi">2</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (c, l1, l2).<span class="mi">1</span>.<span class="mi">1</span></span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk15"><hr></label><div class="goal-conclusion"><span class="highlight">{bl1l2 : A * seq A * seq A
| [/\ <span class="kp">all</span> [predC P] bl1l2.<span class="mi">1</span>.<span class="mi">2</span>, P bl1l2.<span class="mi">1</span>.<span class="mi">1</span>
    &amp; b
      :: (c, l1, l2).<span class="mi">1</span>.<span class="mi">2</span> ++
         (c, l1, l2).<span class="mi">1</span>.<span class="mi">1</span> :: (c, l1, l2).<span class="mi">2</span> =
      bl1l2.<span class="mi">1</span>.<span class="mi">2</span> ++ bl1l2.<span class="mi">1</span>.<span class="mi">1</span> :: bl1l2.<span class="mi">2</span>]}</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk16" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk16"><span class="highlight"><span class="bp">by</span> <span class="kr">exists</span> (<span class="nv">b</span>, [::], l); <span class="nb">split</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">pred A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ <span class="kp">all</span> [predC P] l -&gt;
{bl1l2 : A * seq A * seq A
| [/\ <span class="kp">all</span> [predC P] bl1l2.<span class="mi">1</span>.<span class="mi">2</span>, P bl1l2.<span class="mi">1</span>.<span class="mi">1</span>
    &amp; l = bl1l2.<span class="mi">1</span>.<span class="mi">2</span> ++ bl1l2.<span class="mi">1</span>.<span class="mi">1</span> :: bl1l2.<span class="mi">2</span>]}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">bNIP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">b \notin P</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1, l2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">all</span> [predC P] (c, l1, l2).<span class="mi">1</span>.<span class="mi">2</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (c, l1, l2).<span class="mi">1</span>.<span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">{bl1l2 : A * seq A * seq A
| [/\ <span class="kp">all</span> [predC P] bl1l2.<span class="mi">1</span>.<span class="mi">2</span>, P bl1l2.<span class="mi">1</span>.<span class="mi">1</span>
    &amp; b
      :: (c, l1, l2).<span class="mi">1</span>.<span class="mi">2</span> ++
         (c, l1, l2).<span class="mi">1</span>.<span class="mi">1</span> :: (c, l1, l2).<span class="mi">2</span> =
      bl1l2.<span class="mi">1</span>.<span class="mi">2</span> ++ bl1l2.<span class="mi">1</span>.<span class="mi">1</span> :: bl1l2.<span class="mi">2</span>]}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="kr">exists</span> (<span class="nv">c</span>, b :: l1, l2); <span class="nb">split</span>; <span class="nb">rewrite</span> /= <span class="nl">?bNIP</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk17" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk17"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">split_last</span> (<span class="nv">A</span> : eqType) (<span class="nv">l</span> : seq A) (<span class="nv">P</span> : pred A) :
  ~~ <span class="kp">all</span> [predC P] l  -&gt; 
  {bl1l2 | [/\  P bl1l2.<span class="mi">1</span>.<span class="mi">1</span>, <span class="kp">all</span> [predC  P] bl1l2.<span class="mi">2</span> &amp;  
                l = bl1l2.<span class="mi">1</span>.<span class="mi">2</span> ++ bl1l2.<span class="mi">1</span>.<span class="mi">1</span> :: bl1l2.<span class="mi">2</span>]}.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">pred A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~~ <span class="kp">all</span> [predC P] l -&gt;
{bl1l2 : A * seq A * seq A
| [/\ P bl1l2.<span class="mi">1</span>.<span class="mi">1</span>, <span class="kp">all</span> [predC P] bl1l2.<span class="mi">2</span>
    &amp; l = bl1l2.<span class="mi">1</span>.<span class="mi">2</span> ++ bl1l2.<span class="mi">1</span>.<span class="mi">1</span> :: bl1l2.<span class="mi">2</span>]}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk18" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk18"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">pred A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~~ <span class="kp">all</span> [predC P] l -&gt;
{bl1l2 : A * seq A * seq A
| [/\ P bl1l2.<span class="mi">1</span>.<span class="mi">1</span>, <span class="kp">all</span> [predC P] bl1l2.<span class="mi">2</span>
    &amp; l = bl1l2.<span class="mi">1</span>.<span class="mi">2</span> ++ bl1l2.<span class="mi">1</span>.<span class="mi">1</span> :: bl1l2.<span class="mi">2</span>]}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk19" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk19"><span class="highlight"><span class="nb">move</span>=&gt; lA.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">pred A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">lA</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ <span class="kp">all</span> [predC P] l</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">{bl1l2 : A * seq A * seq A
| [/\ P bl1l2.<span class="mi">1</span>.<span class="mi">1</span>, <span class="kp">all</span> [predC P] bl1l2.<span class="mi">2</span>
    &amp; l = bl1l2.<span class="mi">1</span>.<span class="mi">2</span> ++ bl1l2.<span class="mi">1</span>.<span class="mi">1</span> :: bl1l2.<span class="mi">2</span>]}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1a" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1a"><span class="highlight"><span class="nb">case</span>: (@split_first _ (rev l) P); <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> all_rev.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">pred A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">lA</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ <span class="kp">all</span> [predC P] l</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">x</span> : A * seq A * seq A,
[/\ <span class="kp">all</span> [predC P] x.<span class="mi">1</span>.<span class="mi">2</span>, P x.<span class="mi">1</span>.<span class="mi">1</span>
  &amp; rev l = x.<span class="mi">1</span>.<span class="mi">2</span> ++ x.<span class="mi">1</span>.<span class="mi">1</span> :: x.<span class="mi">2</span>] -&gt;
{bl1l2 : A * seq A * seq A
| [/\ P bl1l2.<span class="mi">1</span>.<span class="mi">1</span>, <span class="kp">all</span> [predC P] bl1l2.<span class="mi">2</span>
    &amp; l = bl1l2.<span class="mi">1</span>.<span class="mi">2</span> ++ bl1l2.<span class="mi">1</span>.<span class="mi">1</span> :: bl1l2.<span class="mi">2</span>]}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1b" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1b"><span class="highlight"><span class="nb">move</span>=&gt; [[b l1] l2] [H1 H2 H3].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">pred A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">lA</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ <span class="kp">all</span> [predC P] l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1, l2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">all</span> [predC P] (b, l1, l2).<span class="mi">1</span>.<span class="mi">2</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (b, l1, l2).<span class="mi">1</span>.<span class="mi">1</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">rev l =
(b, l1, l2).<span class="mi">1</span>.<span class="mi">2</span> ++
(b, l1, l2).<span class="mi">1</span>.<span class="mi">1</span> :: (b, l1, l2).<span class="mi">2</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">{bl1l2 : A * seq A * seq A
| [/\ P bl1l2.<span class="mi">1</span>.<span class="mi">1</span>, <span class="kp">all</span> [predC P] bl1l2.<span class="mi">2</span>
    &amp; l = bl1l2.<span class="mi">1</span>.<span class="mi">2</span> ++ bl1l2.<span class="mi">1</span>.<span class="mi">1</span> :: bl1l2.<span class="mi">2</span>]}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1c" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1c"><span class="highlight"><span class="kr">exists</span> (<span class="nv">b</span>, rev l2, rev l1); <span class="nb">split</span> =&gt; //; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> all_rev.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">pred A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">lA</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ <span class="kp">all</span> [predC P] l</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1, l2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kp">all</span> [predC P] (b, l1, l2).<span class="mi">1</span>.<span class="mi">2</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P (b, l1, l2).<span class="mi">1</span>.<span class="mi">1</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">rev l =
(b, l1, l2).<span class="mi">1</span>.<span class="mi">2</span> ++
(b, l1, l2).<span class="mi">1</span>.<span class="mi">1</span> :: (b, l1, l2).<span class="mi">2</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">l =
(b, rev l2, rev l1).<span class="mi">1</span>.<span class="mi">2</span> ++
(b, rev l2, rev l1).<span class="mi">1</span>.<span class="mi">1</span> :: (b, rev l2, rev l1).<span class="mi">2</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> -{<span class="mi">1</span>}[l]revK H3 rev_cat /= rev_cons cat_rcons.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1d" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1d"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">split_head</span> (<span class="nv">A</span> : eqType) (<span class="nv">a</span> <span class="nv">b</span> : A) <span class="nv">l1</span> <span class="nv">l2</span> <span class="nv">l3</span> <span class="nv">l4</span> :
  l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
  [\/ [/\ l1 = l3, a = b &amp; l2 = l4],
      <span class="kr">exists</span> <span class="nv">l5</span>, l3 = l1 ++ a :: l5 |
      <span class="kr">exists</span> <span class="nv">l5</span>, l1 = l3 ++ b :: l5].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1, l2, l3, l4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l3 = l1 ++ a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l1 = l3 ++ b :: l5]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1e" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1e"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1, l2, l3, l4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l3 = l1 ++ a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l1 = l3 ++ b :: l5]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1f" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1f"><span class="highlight"><span class="nb">elim</span>: l1 l3 =&gt; /= [[[&lt;- &lt;-]|c l3 [&lt;- -&gt;]] /= | c l1 IH [[&lt;- &lt;-]|d l3 /= [&lt;-]]].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2, l4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">[\/ [/\ [::] = [::], a = a &amp; l2 = l2],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, [::] = a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, [::] = a :: l5]</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk20" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2, l4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk20"><hr></label><div class="goal-conclusion"><span class="highlight">[\/ [/\ [::] = a :: l3, a = b &amp; l3 ++ b :: l4 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, a :: l3 = a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, [::] = a :: l3 ++ b :: l5]</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="extra-v-chk21" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2, l4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l3</span> : seq A,
l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l3 = l1 ++ a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l1 = l3 ++ b :: l5]</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk21"><hr></label><div class="goal-conclusion"><span class="highlight">[\/ [/\ c :: l1 = [::], a = c &amp; l2 = l1 ++ a :: l2],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, [::] = c :: l1 ++ a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, c :: l1 = [::] ++ c :: l5]</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="extra-v-chk22" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2, l4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l3</span> : seq A,
l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l3 = l1 ++ a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l1 = l3 ++ b :: l5]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk22"><hr></label><div class="goal-conclusion"><span class="highlight">l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ c :: l1 = c :: l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, c :: l3 = c :: l1 ++ a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, c :: l1 = c :: l3 ++ b :: l5]</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk23" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk23"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2, l4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">[\/ [/\ [::] = [::], a = a &amp; l2 = l2],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, [::] = a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, [::] = a :: l5]</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk24" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2, l4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk24"><hr></label><div class="goal-conclusion"><span class="highlight">[\/ [/\ [::] = a :: l3, a = b &amp; l3 ++ b :: l4 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, a :: l3 = a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, [::] = a :: l3 ++ b :: l5]</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="extra-v-chk25" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2, l4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l3</span> : seq A,
l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l3 = l1 ++ a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l1 = l3 ++ b :: l5]</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk25"><hr></label><div class="goal-conclusion"><span class="highlight">[\/ [/\ c :: l1 = [::], a = c &amp; l2 = l1 ++ a :: l2],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, [::] = c :: l1 ++ a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, c :: l1 = [::] ++ c :: l5]</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="extra-v-chk26" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2, l4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l3</span> : seq A,
l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l3 = l1 ++ a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l1 = l3 ++ b :: l5]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk26"><hr></label><div class="goal-conclusion"><span class="highlight">l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ c :: l1 = c :: l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, c :: l3 = c :: l1 ++ a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, c :: l1 = c :: l3 ++ b :: l5]</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk27" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk27"><span class="highlight"><span class="bp">by</span> <span class="nb">apply</span>: Or31.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2, l4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">[\/ [/\ [::] = a :: l3, a = b &amp; l3 ++ b :: l4 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, a :: l3 = a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, [::] = a :: l3 ++ b :: l5]</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk28" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2, l4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l3</span> : seq A,
l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l3 = l1 ++ a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l1 = l3 ++ b :: l5]</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk28"><hr></label><div class="goal-conclusion"><span class="highlight">[\/ [/\ c :: l1 = [::], a = c &amp; l2 = l1 ++ a :: l2],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, [::] = c :: l1 ++ a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, c :: l1 = [::] ++ c :: l5]</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="extra-v-chk29" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2, l4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l3</span> : seq A,
l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l3 = l1 ++ a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l1 = l3 ++ b :: l5]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk29"><hr></label><div class="goal-conclusion"><span class="highlight">l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ c :: l1 = c :: l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, c :: l3 = c :: l1 ++ a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, c :: l1 = c :: l3 ++ b :: l5]</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk2a" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk2a"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2, l4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">[\/ [/\ [::] = a :: l3, a = b &amp; l3 ++ b :: l4 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, a :: l3 = a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, [::] = a :: l3 ++ b :: l5]</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk2b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2, l4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l3</span> : seq A,
l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l3 = l1 ++ a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l1 = l3 ++ b :: l5]</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk2b"><hr></label><div class="goal-conclusion"><span class="highlight">[\/ [/\ c :: l1 = [::], a = c &amp; l2 = l1 ++ a :: l2],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, [::] = c :: l1 ++ a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, c :: l1 = [::] ++ c :: l5]</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="extra-v-chk2c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2, l4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l3</span> : seq A,
l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l3 = l1 ++ a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l1 = l3 ++ b :: l5]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk2c"><hr></label><div class="goal-conclusion"><span class="highlight">l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ c :: l1 = c :: l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, c :: l3 = c :: l1 ++ a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, c :: l1 = c :: l3 ++ b :: l5]</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk2d" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk2d"><span class="highlight"><span class="bp">by</span> <span class="nb">apply</span>: Or32; <span class="kr">exists</span> <span class="nv">l3</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2, l4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l3</span> : seq A,
l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l3 = l1 ++ a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l1 = l3 ++ b :: l5]</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">[\/ [/\ c :: l1 = [::], a = c &amp; l2 = l1 ++ a :: l2],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, [::] = c :: l1 ++ a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, c :: l1 = [::] ++ c :: l5]</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk2e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2, l4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l3</span> : seq A,
l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l3 = l1 ++ a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l1 = l3 ++ b :: l5]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk2e"><hr></label><div class="goal-conclusion"><span class="highlight">l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ c :: l1 = c :: l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, c :: l3 = c :: l1 ++ a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, c :: l1 = c :: l3 ++ b :: l5]</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk2f" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk2f"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2, l4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l3</span> : seq A,
l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l3 = l1 ++ a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l1 = l3 ++ b :: l5]</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">[\/ [/\ c :: l1 = [::], a = c &amp; l2 = l1 ++ a :: l2],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, [::] = c :: l1 ++ a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, c :: l1 = [::] ++ c :: l5]</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk30" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2, l4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l3</span> : seq A,
l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l3 = l1 ++ a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l1 = l3 ++ b :: l5]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk30"><hr></label><div class="goal-conclusion"><span class="highlight">l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ c :: l1 = c :: l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, c :: l3 = c :: l1 ++ a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, c :: l1 = c :: l3 ++ b :: l5]</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk31" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk31"><span class="highlight"><span class="bp">by</span> <span class="nb">apply</span>: Or33; <span class="kr">exists</span> <span class="nv">l1</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2, l4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l3</span> : seq A,
l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l3 = l1 ++ a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l1 = l3 ++ b :: l5]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ c :: l1 = c :: l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, c :: l3 = c :: l1 ++ a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, c :: l1 = c :: l3 ++ b :: l5]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk32" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk32"><span class="highlight"><span class="nb">move</span>=&gt; /IH[[&lt;- &lt;- &lt;-]|[l5 -&gt;]|].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2, l4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l3</span> : seq A,
l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l3 = l1 ++ a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l1 = l3 ++ b :: l5]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">[\/ [/\ c :: l1 = c :: l1, a = a &amp; l2 = l2],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, c :: l1 = c :: l1 ++ a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, c :: l1 = c :: l1 ++ a :: l5]</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk33" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2, l4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l3</span> : seq A,
l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l3 = l1 ++ a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l1 = l3 ++ b :: l5]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l3, l5</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk33"><hr></label><div class="goal-conclusion"><span class="highlight">[\/ [/\ c :: l1 = c :: l1 ++ a :: l5, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l6</span> : seq A,
      c :: l1 ++ a :: l5 = c :: l1 ++ a :: l6
  | <span class="kr">exists</span> <span class="nv">l6</span> : seq A,
      c :: l1 = c :: (l1 ++ a :: l5) ++ b :: l6]</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="extra-v-chk34" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2, l4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l3</span> : seq A,
l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l3 = l1 ++ a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l1 = l3 ++ b :: l5]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk34"><hr></label><div class="goal-conclusion"><span class="highlight">(<span class="kr">exists</span> <span class="nv">l5</span> : seq A, l1 = l3 ++ b :: l5) -&gt;
[\/ [/\ c :: l1 = c :: l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, c :: l3 = c :: l1 ++ a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, c :: l1 = c :: l3 ++ b :: l5]</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk35" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk35"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2, l4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l3</span> : seq A,
l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l3 = l1 ++ a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l1 = l3 ++ b :: l5]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">[\/ [/\ c :: l1 = c :: l1, a = a &amp; l2 = l2],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, c :: l1 = c :: l1 ++ a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, c :: l1 = c :: l1 ++ a :: l5]</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk36" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2, l4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l3</span> : seq A,
l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l3 = l1 ++ a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l1 = l3 ++ b :: l5]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l3, l5</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk36"><hr></label><div class="goal-conclusion"><span class="highlight">[\/ [/\ c :: l1 = c :: l1 ++ a :: l5, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l6</span> : seq A,
      c :: l1 ++ a :: l5 = c :: l1 ++ a :: l6
  | <span class="kr">exists</span> <span class="nv">l6</span> : seq A,
      c :: l1 = c :: (l1 ++ a :: l5) ++ b :: l6]</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="extra-v-chk37" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2, l4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l3</span> : seq A,
l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l3 = l1 ++ a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l1 = l3 ++ b :: l5]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk37"><hr></label><div class="goal-conclusion"><span class="highlight">(<span class="kr">exists</span> <span class="nv">l5</span> : seq A, l1 = l3 ++ b :: l5) -&gt;
[\/ [/\ c :: l1 = c :: l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, c :: l3 = c :: l1 ++ a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, c :: l1 = c :: l3 ++ b :: l5]</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk38" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk38"><span class="highlight"><span class="bp">by</span> <span class="nb">apply</span>: Or31.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2, l4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l3</span> : seq A,
l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l3 = l1 ++ a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l1 = l3 ++ b :: l5]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l3, l5</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">[\/ [/\ c :: l1 = c :: l1 ++ a :: l5, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l6</span> : seq A,
      c :: l1 ++ a :: l5 = c :: l1 ++ a :: l6
  | <span class="kr">exists</span> <span class="nv">l6</span> : seq A,
      c :: l1 = c :: (l1 ++ a :: l5) ++ b :: l6]</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk39" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2, l4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l3</span> : seq A,
l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l3 = l1 ++ a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l1 = l3 ++ b :: l5]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk39"><hr></label><div class="goal-conclusion"><span class="highlight">(<span class="kr">exists</span> <span class="nv">l5</span> : seq A, l1 = l3 ++ b :: l5) -&gt;
[\/ [/\ c :: l1 = c :: l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, c :: l3 = c :: l1 ++ a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, c :: l1 = c :: l3 ++ b :: l5]</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk3a" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk3a"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2, l4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l3</span> : seq A,
l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l3 = l1 ++ a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l1 = l3 ++ b :: l5]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l3, l5</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">[\/ [/\ c :: l1 = c :: l1 ++ a :: l5, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l6</span> : seq A,
      c :: l1 ++ a :: l5 = c :: l1 ++ a :: l6
  | <span class="kr">exists</span> <span class="nv">l6</span> : seq A,
      c :: l1 = c :: (l1 ++ a :: l5) ++ b :: l6]</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk3b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2, l4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l3</span> : seq A,
l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l3 = l1 ++ a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l1 = l3 ++ b :: l5]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk3b"><hr></label><div class="goal-conclusion"><span class="highlight">(<span class="kr">exists</span> <span class="nv">l5</span> : seq A, l1 = l3 ++ b :: l5) -&gt;
[\/ [/\ c :: l1 = c :: l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, c :: l3 = c :: l1 ++ a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, c :: l1 = c :: l3 ++ b :: l5]</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk3c" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk3c"><span class="highlight"><span class="bp">by</span> <span class="nb">apply</span>: Or32; <span class="kr">exists</span> <span class="nv">l5</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l2, l4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l3</span> : seq A,
l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l3 = l1 ++ a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l1 = l3 ++ b :: l5]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l3</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">exists</span> <span class="nv">l5</span> : seq A, l1 = l3 ++ b :: l5) -&gt;
[\/ [/\ c :: l1 = c :: l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, c :: l3 = c :: l1 ++ a :: l5
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, c :: l1 = c :: l3 ++ b :: l5]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">case</span>=&gt; l5 -&gt;; <span class="nb">apply</span>: Or33; <span class="kr">exists</span> <span class="nv">l5</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk3d" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk3d"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">split_tail</span> (<span class="nv">A</span> : eqType) (<span class="nv">a</span> <span class="nv">b</span> : A) <span class="nv">l1</span> <span class="nv">l2</span> <span class="nv">l3</span> <span class="nv">l4</span> :
  l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
  [\/ [/\ l1 = l3, a = b &amp; l2 = l4],
      <span class="kr">exists</span> <span class="nv">l5</span>, l4 = l5 ++ a :: l2 |
      <span class="kr">exists</span> <span class="nv">l5</span>, l2 = l5 ++ b :: l4].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1, l2, l3, l4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l4 = l5 ++ a :: l2
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l2 = l5 ++ b :: l4]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk3e" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk3e"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1, l2, l3, l4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l4 = l5 ++ a :: l2
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l2 = l5 ++ b :: l4]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk3f" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk3f"><span class="highlight"><span class="nb">elim</span>/last_ind : l2 l4 =&gt; [l4|l2 c IH l4].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1, l3, l4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">l1 ++ [:: a] = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; [::] = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l4 = l5 ++ [:: a]
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, [::] = l5 ++ b :: l4]</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk40" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1, l3, l2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l4</span> : seq A,
l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l4 = l5 ++ a :: l2
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l2 = l5 ++ b :: l4]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk40"><hr></label><div class="goal-conclusion"><span class="highlight">l1 ++ a :: rcons l2 c = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; rcons l2 c = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l4 = l5 ++ a :: rcons l2 c
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, rcons l2 c = l5 ++ b :: l4]</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk41" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk41"><span class="highlight"><span class="nb">case</span>: (lastP l4) =&gt; /= [|l5 c].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1, l3, l4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">l1 ++ [:: a] = l3 ++ [:: b] -&gt;
[\/ [/\ l1 = l3, a = b &amp; [::] = [::]],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, [::] = l5 ++ [:: a]
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, [::] = l5 ++ [:: b]]</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk42" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1, l3, l4, l5</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk42"><hr></label><div class="goal-conclusion"><span class="highlight">l1 ++ [:: a] = l3 ++ b :: rcons l5 c -&gt;
[\/ [/\ l1 = l3, a = b &amp; [::] = rcons l5 c],
    <span class="kr">exists</span> <span class="nv">l6</span> : seq A, rcons l5 c = l6 ++ [:: a]
  | <span class="kr">exists</span> <span class="nv">l6</span> : seq A, [::] = l6 ++ b :: rcons l5 c]</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="extra-v-chk43" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1, l3, l2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l4</span> : seq A,
l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l4 = l5 ++ a :: l2
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l2 = l5 ++ b :: l4]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk43"><hr></label><div class="goal-conclusion"><span class="highlight">l1 ++ a :: rcons l2 c = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; rcons l2 c = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l4 = l5 ++ a :: rcons l2 c
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, rcons l2 c = l5 ++ b :: l4]</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk44" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk44"><span class="highlight"><span class="nb">rewrite</span> !cats1 =&gt; /rcons_inj[&lt;- &lt;-].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1, l3, l4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">[\/ [/\ l1 = l1, a = a &amp; [::] = [::]],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, [::] = l5 ++ [:: a]
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, [::] = l5 ++ [:: a]]</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk45" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1, l3, l4, l5</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk45"><hr></label><div class="goal-conclusion"><span class="highlight">l1 ++ [:: a] = l3 ++ b :: rcons l5 c -&gt;
[\/ [/\ l1 = l3, a = b &amp; [::] = rcons l5 c],
    <span class="kr">exists</span> <span class="nv">l6</span> : seq A, rcons l5 c = l6 ++ [:: a]
  | <span class="kr">exists</span> <span class="nv">l6</span> : seq A, [::] = l6 ++ b :: rcons l5 c]</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="extra-v-chk46" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1, l3, l2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l4</span> : seq A,
l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l4 = l5 ++ a :: l2
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l2 = l5 ++ b :: l4]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk46"><hr></label><div class="goal-conclusion"><span class="highlight">l1 ++ a :: rcons l2 c = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; rcons l2 c = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l4 = l5 ++ a :: rcons l2 c
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, rcons l2 c = l5 ++ b :: l4]</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk47" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk47"><span class="highlight"><span class="bp">by</span> <span class="nb">apply</span>: Or31.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1, l3, l4, l5</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">l1 ++ [:: a] = l3 ++ b :: rcons l5 c -&gt;
[\/ [/\ l1 = l3, a = b &amp; [::] = rcons l5 c],
    <span class="kr">exists</span> <span class="nv">l6</span> : seq A, rcons l5 c = l6 ++ [:: a]
  | <span class="kr">exists</span> <span class="nv">l6</span> : seq A, [::] = l6 ++ b :: rcons l5 c]</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk48" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1, l3, l2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l4</span> : seq A,
l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l4 = l5 ++ a :: l2
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l2 = l5 ++ b :: l4]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk48"><hr></label><div class="goal-conclusion"><span class="highlight">l1 ++ a :: rcons l2 c = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; rcons l2 c = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l4 = l5 ++ a :: rcons l2 c
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, rcons l2 c = l5 ++ b :: l4]</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk49" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk49"><span class="highlight"><span class="nb">rewrite</span> cats1 -rcons_cons -rcons_cat =&gt; /rcons_inj[-&gt; &lt;-].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1, l3, l4, l5</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">[\/ [/\ l3 ++ b :: l5 = l3, a = b &amp; [::] = rcons l5 a],
    <span class="kr">exists</span> <span class="nv">l6</span> : seq A, rcons l5 a = l6 ++ [:: a]
  | <span class="kr">exists</span> <span class="nv">l6</span> : seq A, [::] = l6 ++ rcons (b :: l5) a]</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk4a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1, l3, l2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l4</span> : seq A,
l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l4 = l5 ++ a :: l2
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l2 = l5 ++ b :: l4]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk4a"><hr></label><div class="goal-conclusion"><span class="highlight">l1 ++ a :: rcons l2 c = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; rcons l2 c = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l4 = l5 ++ a :: rcons l2 c
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, rcons l2 c = l5 ++ b :: l4]</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk4b" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk4b"><span class="highlight"><span class="bp">by</span> <span class="nb">apply</span>: Or32; <span class="kr">exists</span> <span class="nv">l5</span>; <span class="nb">rewrite</span> cats1.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1, l3, l2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l4</span> : seq A,
l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l4 = l5 ++ a :: l2
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l2 = l5 ++ b :: l4]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">l1 ++ a :: rcons l2 c = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; rcons l2 c = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l4 = l5 ++ a :: rcons l2 c
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, rcons l2 c = l5 ++ b :: l4]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk4c" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk4c"><span class="highlight"><span class="nb">case</span>: (lastP l4) =&gt; /= [|l5 d].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1, l3, l2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l4</span> : seq A,
l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l4 = l5 ++ a :: l2
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l2 = l5 ++ b :: l4]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">l1 ++ a :: rcons l2 c = l3 ++ [:: b] -&gt;
[\/ [/\ l1 = l3, a = b &amp; rcons l2 c = [::]],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, [::] = l5 ++ a :: rcons l2 c
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, rcons l2 c = l5 ++ [:: b]]</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk4d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1, l3, l2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l4</span> : seq A,
l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l4 = l5 ++ a :: l2
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l2 = l5 ++ b :: l4]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l4, l5</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk4d"><hr></label><div class="goal-conclusion"><span class="highlight">l1 ++ a :: rcons l2 c = l3 ++ b :: rcons l5 d -&gt;
[\/ [/\ l1 = l3, a = b &amp; rcons l2 c = rcons l5 d],
    <span class="kr">exists</span> <span class="nv">l6</span> : seq A,
      rcons l5 d = l6 ++ a :: rcons l2 c
  | <span class="kr">exists</span> <span class="nv">l6</span> : seq A,
      rcons l2 c = l6 ++ b :: rcons l5 d]</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk4e" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk4e"><span class="highlight"><span class="nb">rewrite</span> cats1 -rcons_cons -rcons_cat =&gt; /rcons_inj[&lt;- -&gt;].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1, l3, l2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l4</span> : seq A,
l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l4 = l5 ++ a :: l2
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l2 = l5 ++ b :: l4]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l4</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">[\/ [/\ l1 = l1 ++ a :: l2, a = b &amp; rcons l2 b = [::]],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, [::] = l5 ++ rcons (a :: l2) b
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, rcons l2 b = l5 ++ [:: b]]</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk4f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1, l3, l2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l4</span> : seq A,
l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l4 = l5 ++ a :: l2
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l2 = l5 ++ b :: l4]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l4, l5</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk4f"><hr></label><div class="goal-conclusion"><span class="highlight">l1 ++ a :: rcons l2 c = l3 ++ b :: rcons l5 d -&gt;
[\/ [/\ l1 = l3, a = b &amp; rcons l2 c = rcons l5 d],
    <span class="kr">exists</span> <span class="nv">l6</span> : seq A,
      rcons l5 d = l6 ++ a :: rcons l2 c
  | <span class="kr">exists</span> <span class="nv">l6</span> : seq A,
      rcons l2 c = l6 ++ b :: rcons l5 d]</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk50" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk50"><span class="highlight"><span class="bp">by</span> <span class="nb">apply</span>: Or33; <span class="kr">exists</span> <span class="nv">l2</span>; <span class="nb">rewrite</span> cats1.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1, l3, l2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l4</span> : seq A,
l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l4 = l5 ++ a :: l2
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l2 = l5 ++ b :: l4]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l4, l5</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">l1 ++ a :: rcons l2 c = l3 ++ b :: rcons l5 d -&gt;
[\/ [/\ l1 = l3, a = b &amp; rcons l2 c = rcons l5 d],
    <span class="kr">exists</span> <span class="nv">l6</span> : seq A,
      rcons l5 d = l6 ++ a :: rcons l2 c
  | <span class="kr">exists</span> <span class="nv">l6</span> : seq A,
      rcons l2 c = l6 ++ b :: rcons l5 d]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk51" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk51"><span class="highlight"><span class="nb">rewrite</span> -!rcons_cons -!rcons_cat =&gt; 
   /rcons_inj[/IH [[&lt;- &lt;- &lt;-]|[l6 -&gt;]|[l6 -&gt;]]] &lt;-.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1, l3, l2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l4</span> : seq A,
l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l4 = l5 ++ a :: l2
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l2 = l5 ++ b :: l4]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l4, l5</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">[\/ [/\ l1 = l1, a = a &amp; rcons l2 c = rcons l2 c],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A,
      rcons l2 c = l5 ++ rcons (a :: l2) c
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A,
      rcons l2 c = l5 ++ rcons (a :: l2) c]</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk52" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1, l3, l2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l4</span> : seq A,
l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l4 = l5 ++ a :: l2
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l2 = l5 ++ b :: l4]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l4, l5</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l6</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk52"><hr></label><div class="goal-conclusion"><span class="highlight">[\/ [/\ l1 = l3, a = b
      &amp; rcons l2 c = rcons (l6 ++ a :: l2) c],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A,
      rcons (l6 ++ a :: l2) c =
      l5 ++ rcons (a :: l2) c
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A,
      rcons l2 c = l5 ++ rcons (b :: l6 ++ a :: l2) c]</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="extra-v-chk53" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1, l3, l2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l4</span> : seq A,
l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l4 = l5 ++ a :: l2
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l2 = l5 ++ b :: l4]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l4, l5</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l6</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk53"><hr></label><div class="goal-conclusion"><span class="highlight">[\/ [/\ l1 = l3, a = b
      &amp; rcons (l6 ++ b :: l5) c = rcons l5 c],
    <span class="kr">exists</span> <span class="nv">l7</span> : seq A,
      rcons l5 c = l7 ++ rcons (a :: l6 ++ b :: l5) c
  | <span class="kr">exists</span> <span class="nv">l7</span> : seq A,
      rcons (l6 ++ b :: l5) c =
      l7 ++ rcons (b :: l5) c]</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk54" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk54"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1, l3, l2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l4</span> : seq A,
l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l4 = l5 ++ a :: l2
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l2 = l5 ++ b :: l4]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l4, l5</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">[\/ [/\ l1 = l1, a = a &amp; rcons l2 c = rcons l2 c],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A,
      rcons l2 c = l5 ++ rcons (a :: l2) c
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A,
      rcons l2 c = l5 ++ rcons (a :: l2) c]</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk55" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1, l3, l2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l4</span> : seq A,
l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l4 = l5 ++ a :: l2
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l2 = l5 ++ b :: l4]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l4, l5</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l6</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk55"><hr></label><div class="goal-conclusion"><span class="highlight">[\/ [/\ l1 = l3, a = b
      &amp; rcons l2 c = rcons (l6 ++ a :: l2) c],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A,
      rcons (l6 ++ a :: l2) c =
      l5 ++ rcons (a :: l2) c
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A,
      rcons l2 c = l5 ++ rcons (b :: l6 ++ a :: l2) c]</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="extra-v-chk56" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1, l3, l2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l4</span> : seq A,
l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l4 = l5 ++ a :: l2
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l2 = l5 ++ b :: l4]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l4, l5</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l6</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk56"><hr></label><div class="goal-conclusion"><span class="highlight">[\/ [/\ l1 = l3, a = b
      &amp; rcons (l6 ++ b :: l5) c = rcons l5 c],
    <span class="kr">exists</span> <span class="nv">l7</span> : seq A,
      rcons l5 c = l7 ++ rcons (a :: l6 ++ b :: l5) c
  | <span class="kr">exists</span> <span class="nv">l7</span> : seq A,
      rcons (l6 ++ b :: l5) c =
      l7 ++ rcons (b :: l5) c]</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk57" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk57"><span class="highlight"><span class="bp">by</span> <span class="nb">apply</span>: Or31.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1, l3, l2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l4</span> : seq A,
l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l4 = l5 ++ a :: l2
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l2 = l5 ++ b :: l4]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l4, l5</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l6</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">[\/ [/\ l1 = l3, a = b
      &amp; rcons l2 c = rcons (l6 ++ a :: l2) c],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A,
      rcons (l6 ++ a :: l2) c =
      l5 ++ rcons (a :: l2) c
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A,
      rcons l2 c = l5 ++ rcons (b :: l6 ++ a :: l2) c]</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk58" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1, l3, l2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l4</span> : seq A,
l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l4 = l5 ++ a :: l2
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l2 = l5 ++ b :: l4]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l4, l5</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l6</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk58"><hr></label><div class="goal-conclusion"><span class="highlight">[\/ [/\ l1 = l3, a = b
      &amp; rcons (l6 ++ b :: l5) c = rcons l5 c],
    <span class="kr">exists</span> <span class="nv">l7</span> : seq A,
      rcons l5 c = l7 ++ rcons (a :: l6 ++ b :: l5) c
  | <span class="kr">exists</span> <span class="nv">l7</span> : seq A,
      rcons (l6 ++ b :: l5) c =
      l7 ++ rcons (b :: l5) c]</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk59" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk59"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1, l3, l2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l4</span> : seq A,
l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l4 = l5 ++ a :: l2
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l2 = l5 ++ b :: l4]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l4, l5</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l6</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">[\/ [/\ l1 = l3, a = b
      &amp; rcons l2 c = rcons (l6 ++ a :: l2) c],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A,
      rcons (l6 ++ a :: l2) c =
      l5 ++ rcons (a :: l2) c
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A,
      rcons l2 c = l5 ++ rcons (b :: l6 ++ a :: l2) c]</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk5a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1, l3, l2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l4</span> : seq A,
l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l4 = l5 ++ a :: l2
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l2 = l5 ++ b :: l4]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l4, l5</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l6</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk5a"><hr></label><div class="goal-conclusion"><span class="highlight">[\/ [/\ l1 = l3, a = b
      &amp; rcons (l6 ++ b :: l5) c = rcons l5 c],
    <span class="kr">exists</span> <span class="nv">l7</span> : seq A,
      rcons l5 c = l7 ++ rcons (a :: l6 ++ b :: l5) c
  | <span class="kr">exists</span> <span class="nv">l7</span> : seq A,
      rcons (l6 ++ b :: l5) c =
      l7 ++ rcons (b :: l5) c]</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk5b" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk5b"><span class="highlight"><span class="bp">by</span> <span class="nb">apply</span>: Or32; <span class="kr">exists</span> <span class="nv">l6</span>; <span class="nb">rewrite</span> -rcons_cat.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">eqType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l1, l3, l2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">l4</span> : seq A,
l1 ++ a :: l2 = l3 ++ b :: l4 -&gt;
[\/ [/\ l1 = l3, a = b &amp; l2 = l4],
    <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l4 = l5 ++ a :: l2
  | <span class="kr">exists</span> <span class="nv">l5</span> : seq A, l2 = l5 ++ b :: l4]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l4, l5</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">A</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l6</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">seq A</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">[\/ [/\ l1 = l3, a = b
      &amp; rcons (l6 ++ b :: l5) c = rcons l5 c],
    <span class="kr">exists</span> <span class="nv">l7</span> : seq A,
      rcons l5 c = l7 ++ rcons (a :: l6 ++ b :: l5) c
  | <span class="kr">exists</span> <span class="nv">l7</span> : seq A,
      rcons (l6 ++ b :: l5) c =
      l7 ++ rcons (b :: l5) c]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">apply</span>: Or33; <span class="kr">exists</span> <span class="nv">l6</span>; <span class="nb">rewrite</span> -rcons_cat.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="sd">(******************************************************************************)</span>
<span class="c">(* We develop a twisted version of split that fills &#39;I_{m + n} with           *)</span>
<span class="c">(* first the element of &#39;I_n (x -&gt; x) then the element of m (x -&gt; x + n)      *)</span>
<span class="c">(* This is mostly motivated to naturally get an element of &#39;I_n from &#39;I_n.+1  *)</span>
<span class="c">(* by removing max_ord                                                        *)</span>
<span class="sd">(******************************************************************************)</span>

</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk5c" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk5c"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">tlshift_subproof</span> <span class="nv">m</span> <span class="nv">n</span> (<span class="nv">i</span> : &#39;I_m) : i + n &lt; m + n.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_m</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">i + n &lt; m + n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk5d" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk5d"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_m</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">i + n &lt; m + n</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> ltn_add2r.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk5e" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk5e"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">trshift_subproof</span> <span class="nv">m</span> <span class="nv">n</span> (<span class="nv">i</span> : &#39;I_n) : i &lt; m + n.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">i &lt; m + n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk5f" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk5f"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">i &lt; m + n</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">apply</span>: leq_trans (valP i) _; <span class="nb">apply</span>: leq_addl.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">tlshift</span> <span class="nv">m</span> <span class="nv">n</span> (<span class="nv">i</span> : &#39;I_m) := Ordinal (tlshift_subproof n i).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">trshift</span> <span class="nv">m</span> <span class="nv">n</span> (<span class="nv">i</span> : &#39;I_n) := Ordinal (trshift_subproof m i).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk60" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk60"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">tlshift_inj</span> <span class="nv">m</span> <span class="nv">n</span> : injective (@tlshift m n).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">injective (tlshift n)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk61" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk61"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">injective (tlshift n)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">move</span>=&gt; ? ? /(<span class="nb">f_equal</span> val) /addIn /val_inj.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk62" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk62"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">trshift_inj</span> <span class="nv">m</span> <span class="nv">n</span> : injective (@trshift m n).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">injective (trshift m (n:=n))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk63" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk63"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">injective (trshift m (n:=n))</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">move</span>=&gt; ? ? /(<span class="nb">f_equal</span> val) /= /val_inj.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk64" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk64"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">trshift_lift</span> <span class="nv">n</span> (<span class="nv">i</span> : &#39;I_ n) : trshift <span class="mi">1</span> i = lift ord_max i.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">trshift <span class="mi">1</span> i = lift ord_max i</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk65" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk65"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">trshift <span class="mi">1</span> i = lift ord_max i</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">apply</span>/val_eqP; <span class="nb">rewrite</span> /= /bump leqNgt ltn_ord.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk66" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk66"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">tsplit_subproof</span> <span class="nv">m</span> <span class="nv">n</span> (<span class="nv">i</span> : &#39;I_(m + n)) : i &gt;= n -&gt; i - n &lt; m.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_(m + n)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">n &lt;= i -&gt; i - n &lt; m</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk67" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk67"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_(m + n)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">n &lt;= i -&gt; i - n &lt; m</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">move</span>/subSn &lt;-; <span class="nb">rewrite</span> leq_subLR [n + m]addnC.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">tsplit</span> {<span class="nv">m</span> <span class="nv">n</span>} (<span class="nv">i</span> : &#39;I_(m + n)) : &#39;I_m + &#39;I_n :=
  <span class="kr">match</span> ltnP (i) n <span class="kr">with</span>
  | LtnNotGeq lt_i_n =&gt;  inr _ (Ordinal lt_i_n)
  | GeqNotLtn ge_i_n =&gt;  inl _ (Ordinal (tsplit_subproof ge_i_n))
  <span class="kr">end</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Variant</span> <span class="nf">tsplit_spec</span> <span class="nv">m</span> <span class="nv">n</span> (<span class="nv">i</span> : &#39;I_(m + n)) : &#39;I_m + &#39;I_n -&gt; bool -&gt; <span class="kt">Type</span> :=
  | TSplitLo (j : &#39;I_n) of i = j :&gt; nat : tsplit_spec i (inr _ j) true
  | TSplitHi (k : &#39;I_m) of i = k + n :&gt; nat : tsplit_spec i (inl _ k) false.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk68" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk68"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">tsplitP</span> <span class="nv">m</span> <span class="nv">n</span> (<span class="nv">i</span> : &#39;I_(m + n)) : tsplit_spec i (tsplit i) (i &lt; n).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_(m + n)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">tsplit_spec i (tsplit i) (i &lt; n)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk69" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk69"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_(m + n)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">tsplit_spec i (tsplit i) (i &lt; n)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk6a" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk6a"><span class="highlight"><span class="nb">set</span> lt_i_n := i &lt; n; <span class="nb">rewrite</span> /tsplit.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_(m + n)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">lt_i_n</span><span><span class="hyp-body-block"><span class="hyp-punct">:=</span><span class="hyp-body"><span class="highlight">i &lt; n</span></span></span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">bool</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">tsplit_spec i
  <span class="kr">match</span> ltnP i n <span class="kr">with</span>
  | LtnNotGeq lt_i_n =&gt;
      inr (Ordinal (n:=n) (m:=i) lt_i_n)
  | GeqNotLtn ge_i_n =&gt;
      inl
        (Ordinal (n:=m) (m:=i - n)
           (tsplit_subproof (m:=m) (n:=n) (i:=i)
              ge_i_n))
  <span class="kr">end</span> lt_i_n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">case</span>: {-}_ lt_i_n / ltnP; [<span class="nb">left</span> |<span class="nb">right</span>; <span class="nb">rewrite</span> subnK].</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">tunsplit</span> {<span class="nv">m</span> <span class="nv">n</span>} (<span class="nv">jk</span> : &#39;I_m + &#39;I_n) :=
  <span class="kr">match</span> jk <span class="kr">with</span> inl j =&gt; tlshift n j | inr k =&gt; trshift m k <span class="kr">end</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">

</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk6b" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk6b"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">ltn_tunsplit</span> <span class="nv">m</span> <span class="nv">n</span> (<span class="nv">jk</span> : &#39;I_m + &#39;I_n) : (n &lt;= tunsplit jk) = jk.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">jk</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(&#39;I_m + &#39;I_n)%type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(n &lt;= tunsplit jk) = jk</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk6c" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk6c"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">jk</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(&#39;I_m + &#39;I_n)%type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(n &lt;= tunsplit jk) = jk</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">case</span>: jk =&gt; [j|k]; <span class="nb">rewrite</span> /= <span class="nl">?ltn_ord</span> <span class="nl">?leq_addl</span> // leqNgt ltn_ord.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk6d" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk6d"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">tsplitK</span> {<span class="nv">m</span> <span class="nv">n</span>} : cancel (@tsplit m n) tunsplit.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cancel tsplit tunsplit</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk6e" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk6e"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cancel tsplit tunsplit</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">move</span>=&gt; i; <span class="nb">apply</span>: val_inj; <span class="nb">case</span>: tsplitP.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk6f" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk6f"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">tunsplitK</span> {<span class="nv">m</span> <span class="nv">n</span>} : cancel (@tunsplit m n) tsplit.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cancel tunsplit tsplit</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk70" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk70"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">cancel tunsplit tsplit</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk71" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk71"><span class="highlight"><span class="nb">move</span>=&gt; jk; <span class="nb">have</span>:= ltn_tunsplit jk; <span class="nb">rewrite</span> leqNgt.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">jk</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(&#39;I_m + &#39;I_n)%type</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~~ (tunsplit jk &lt; n) = jk -&gt; tsplit (tunsplit jk) = jk</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="kp">do</span> [<span class="nb">case</span>: tsplitP; <span class="nb">case</span>: jk =&gt; //= i j] =&gt; [|/addIn] =&gt; /ord_inj-&gt;.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="sd">(******************************************************************************)</span>
<span class="c">(*                                                                            *)</span>
<span class="c">(*   Extra theorems about fset                                                *)</span>
<span class="c">(*                                                                            *)</span>
<span class="sd">(******************************************************************************)</span>

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Open Scope</span> fset_scope.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">sint</span> <span class="nv">a</span> <span class="nv">b</span> : {fset nat} :=
   [fset @nat_of_ord _ i | i <span class="kr">in</span> &#39;I_b &amp; a &lt;= i].</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk72" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk72"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">mem_sint</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">i</span> : i \<span class="kr">in</span> sint a b = (a &lt;= i &lt; b).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(i \<span class="kr">in</span> sint a b) = (a &lt;= i &lt; b)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk73" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk73"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(i \<span class="kr">in</span> sint a b) = (a &lt;= i &lt; b)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk74" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk74"><span class="highlight"><span class="nb">apply</span>/imfsetP/idP =&gt; [[j /= aLj -&gt;]|/andP[aLi iLb]].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ordinal_choiceType b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">aLj</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">j \<span class="kr">in</span> [pred x | a &lt;= x]</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">a &lt;= j &lt; b</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk75" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">aLi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a &lt;= i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">iLb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i &lt; b</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk75"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists2</span> x : ordinal_choiceType b,
  in_mem x
    (mem_fin
       (subfinset_finpred (T:=ordinal_choiceType b)
          (mem_fin
             (fin_finpred
                (pT:=pred_finpredType
                       (ordinal_finType b)) &#39;I_b))
          (<span class="kr">fun</span> <span class="nv">i</span> : &#39;I_b =&gt; a &lt;= i))) &amp; i = x</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk76" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk76"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> ltn_ord andbT.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">aLi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a &lt;= i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">iLb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i &lt; b</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists2</span> x : ordinal_choiceType b,
  in_mem x
    (mem_fin
       (subfinset_finpred (T:=ordinal_choiceType b)
          (mem_fin
             (fin_finpred
                (pT:=pred_finpredType
                       (ordinal_finType b)) &#39;I_b))
          (<span class="kr">fun</span> <span class="nv">i</span> : &#39;I_b =&gt; a &lt;= i))) &amp; i = x</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="kr">exists</span> (<span class="nv">Ordinal</span> <span class="nv">iLb</span>).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk77" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk77"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">sint_sub</span> <span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span> : a &lt;= c -&gt;
   [fset i <span class="kr">in</span>  (sint a b) | c &lt;= i] = sint c b.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">a &lt;= c -&gt; [fset i <span class="kr">in</span> sint a b | c &lt;= i] = sint c b</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk78" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk78"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">a &lt;= c -&gt; [fset i <span class="kr">in</span> sint a b | c &lt;= i] = sint c b</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk79" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk79"><span class="highlight"><span class="nb">move</span>=&gt; aLc.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">aLc</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a &lt;= c</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">[fset i <span class="kr">in</span> sint a b | c &lt;= i] = sint c b</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk7a" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk7a"><span class="highlight"><span class="nb">apply</span>/fsetP =&gt; i.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">aLc</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a &lt;= c</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(i \<span class="kr">in</span> [fset i | i <span class="kr">in</span> sint a b &amp; c &lt;= i]) =
(i \<span class="kr">in</span> sint c b)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk7b" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk7b"><span class="highlight"><span class="nb">rewrite</span> mem_sint.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">aLc</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a &lt;= c</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(i \<span class="kr">in</span> [fset i | i <span class="kr">in</span> sint a b &amp; c &lt;= i]) =
(c &lt;= i &lt; b)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk7c" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk7c"><span class="highlight"><span class="nb">apply</span>/imfsetP/idP =&gt; [[j /=]|/andP[cLi iLb]].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">aLc</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a &lt;= c</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">j
  \<span class="kr">in</span> [pred x <span class="kr">in</span> [eta mem_seq (T:=nat_choiceType)
                        (sint a b)] |
        c &lt;= x] -&gt; i = j -&gt; c &lt;= i &lt; b</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk7d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">aLc</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a &lt;= c</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cLi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">c &lt;= i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">iLb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i &lt; b</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk7d"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists2</span> x : nat_choiceType,
  in_mem x
    (mem_fin
       (subfinset_finpred (T:=nat_choiceType)
          (mem_fin (fset_finpred (sint a b))) (leq c))) &amp;
  i = x</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk7e" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk7e"><span class="highlight"><span class="nb">rewrite</span> inE mem_sint =&gt; /andP[/andP[aLj jLb] cLj] -&gt;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">aLc</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a &lt;= c</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">aLj</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a &lt;= j</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">jLb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">j &lt; b</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cLj</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">c &lt;= j</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">c &lt;= j &lt; b</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk7f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">aLc</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a &lt;= c</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cLi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">c &lt;= i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">iLb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i &lt; b</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk7f"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists2</span> x : nat_choiceType,
  in_mem x
    (mem_fin
       (subfinset_finpred (T:=nat_choiceType)
          (mem_fin (fset_finpred (sint a b))) (leq c))) &amp;
  i = x</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk80" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk80"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> cLj.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, c</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">aLc</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a &lt;= c</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">cLi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">c &lt;= i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">iLb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i &lt; b</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists2</span> x : nat_choiceType,
  in_mem x
    (mem_fin
       (subfinset_finpred (T:=nat_choiceType)
          (mem_fin (fset_finpred (sint a b))) (leq c))) &amp;
  i = x</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="kr">exists</span> <span class="nv">i</span>; <span class="nb">rewrite</span> //= inE mem_sint cLi iLb (leq_trans aLc).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk81" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk81"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">sintSl</span> <span class="nv">a</span> <span class="nv">b</span> : sint a.+<span class="mi">1</span> b = sint a b `\ a.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">sint a.+<span class="mi">1</span> b = sint a b `\ a</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk82" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk82"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">sint a.+<span class="mi">1</span> b = sint a b `\ a</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk83" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk83"><span class="highlight"><span class="nb">apply</span>/fsetP =&gt; /= i; <span class="nb">rewrite</span> !inE !mem_sint.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(a &lt; i &lt; b) = [&amp;&amp; i != a, a &lt;= i &amp; i &lt; b]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="kp">do</span> <span class="mi">2</span> <span class="nb">case</span>: ltngtP.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk84" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk84"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">sintSr</span> <span class="nv">a</span> <span class="nv">b</span> : sint a b.+<span class="mi">1</span> `\ b = sint a b.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">sint a b.+<span class="mi">1</span> `\ b = sint a b</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk85" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk85"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">sint a b.+<span class="mi">1</span> `\ b = sint a b</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk86" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk86"><span class="highlight"><span class="nb">apply</span>/fsetP =&gt; /= i; <span class="nb">rewrite</span> !inE !mem_sint ltnS.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b, i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">[&amp;&amp; i != b, a &lt;= i &amp; i &lt;= b] = (a &lt;= i &lt; b)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="kp">do</span> <span class="mi">2</span> <span class="nb">case</span>: ltngtP.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk87" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk87"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">sint_split</span> <span class="nv">a</span> <span class="nv">b</span> : sint a b = sint <span class="mi">0</span> b `\` sint <span class="mi">0</span> a.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">sint a b = sint <span class="mi">0</span> b `\` sint <span class="mi">0</span> a</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk88" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk88"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">sint a b = sint <span class="mi">0</span> b `\` sint <span class="mi">0</span> a</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">apply</span>/fsetP =&gt; /= i; <span class="nb">rewrite</span> !inE !mem_sint /= -leqNgt.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk89" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk89"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">card_sint</span> <span class="nv">a</span> <span class="nv">b</span> : #|`sint a b| = (b - a).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|` sint a b| = b - a</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk8a" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk8a"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|` sint a b| = b - a</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk8b" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk8b"><span class="highlight"><span class="nb">elim</span>: b =&gt; [|b IH].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|` sint a <span class="mi">0</span>| = <span class="mi">0</span> - a</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk8c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|` sint a b| = b - a</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk8c"><hr></label><div class="goal-conclusion"><span class="highlight">#|` sint a b.+<span class="mi">1</span>| = b.+<span class="mi">1</span> - a</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk8d" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk8d"><span class="highlight"><span class="nb">apply</span>/eqP; <span class="nb">rewrite</span> cardfs_eq0; <span class="nb">apply</span>/eqP/fsetP=&gt; i.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(i \<span class="kr">in</span> sint a <span class="mi">0</span>) = (i \<span class="kr">in</span> fset0)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk8e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|` sint a b| = b - a</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk8e"><hr></label><div class="goal-conclusion"><span class="highlight">#|` sint a b.+<span class="mi">1</span>| = b.+<span class="mi">1</span> - a</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk8f" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk8f"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> mem_sint andbF inE.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|` sint a b| = b - a</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|` sint a b.+<span class="mi">1</span>| = b.+<span class="mi">1</span> - a</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk90" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk90"><span class="highlight"><span class="nb">have</span> [aLb|bLa] := leqP a b; <span class="nb">last first</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|` sint a b| = b - a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">bLa</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">b &lt; a</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|` sint a b.+<span class="mi">1</span>| = b.+<span class="mi">1</span> - a</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk91" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|` sint a b| = b - a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">aLb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a &lt;= b</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk91"><hr></label><div class="goal-conclusion"><span class="highlight">#|` sint a b.+<span class="mi">1</span>| = b.+<span class="mi">1</span> - a</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk92" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk92"><span class="highlight"><span class="nb">rewrite</span> (_ : _ - _ =  <span class="mi">0</span>); <span class="nb">last first</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|` sint a b| = b - a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">bLa</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">b &lt; a</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">b.+<span class="mi">1</span> - a = <span class="mi">0</span></span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk93" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|` sint a b| = b - a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">bLa</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">b &lt; a</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk93"><hr></label><div class="goal-conclusion"><span class="highlight">#|` sint a b.+<span class="mi">1</span>| = <span class="mi">0</span></span></div></blockquote><input class="alectryon-extra-goal-toggle" id="extra-v-chk94" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|` sint a b| = b - a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">aLb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a &lt;= b</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk94"><hr></label><div class="goal-conclusion"><span class="highlight">#|` sint a b.+<span class="mi">1</span>| = b.+<span class="mi">1</span> - a</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk95" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk95"><span class="highlight"><span class="bp">by</span> <span class="nb">apply</span>/eqP; <span class="nb">rewrite</span> subn_eq0.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|` sint a b| = b - a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">bLa</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">b &lt; a</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|` sint a b.+<span class="mi">1</span>| = <span class="mi">0</span></span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk96" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|` sint a b| = b - a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">aLb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a &lt;= b</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk96"><hr></label><div class="goal-conclusion"><span class="highlight">#|` sint a b.+<span class="mi">1</span>| = b.+<span class="mi">1</span> - a</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk97" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk97"><span class="highlight"><span class="nb">apply</span>/eqP; <span class="nb">rewrite</span> cardfs_eq0; <span class="nb">apply</span>/eqP/fsetP=&gt; i; <span class="nb">rewrite</span> mem_sint inE ltnS.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|` sint a b| = b - a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">bLa</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">b &lt; a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(a &lt;= i &lt;= b) = false</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk98" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|` sint a b| = b - a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">aLb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a &lt;= b</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk98"><hr></label><div class="goal-conclusion"><span class="highlight">#|` sint a b.+<span class="mi">1</span>| = b.+<span class="mi">1</span> - a</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk99" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk99"><span class="highlight"><span class="bp">by</span> <span class="nb">apply</span>/idP =&gt; /andP[H1 /(leq_trans H1)]; <span class="nb">rewrite</span> leqNgt bLa.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|` sint a b| = b - a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">aLb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a &lt;= b</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|` sint a b.+<span class="mi">1</span>| = b.+<span class="mi">1</span> - a</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk9a" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk9a"><span class="highlight"><span class="nb">rewrite</span> (cardfsD1 b) (_ : _ \<span class="kr">in</span> _); <span class="nb">last</span> <span class="bp">by</span> <span class="nb">rewrite</span> mem_sint aLb /=.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a, b</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|` sint a b| = b - a</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">aLb</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">a &lt;= b</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(true + #|` sint a b.+<span class="mi">1</span> `\ b|)%N = b.+<span class="mi">1</span> - a</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> sintSr IH subSn.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;`[ n ]&quot;</span> := (sint <span class="mi">0</span> n) (<span class="kn">format</span> <span class="s2">&quot;`[ n ]&quot;</span>).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk9b" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk9b"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">sint0_set0</span> : `[<span class="mi">0</span>] = fset0.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">`[<span class="mi">0</span>] = fset0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk9c" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk9c"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">`[<span class="mi">0</span>] = fset0</span></div></blockquote></div></div></small><span class="alectryon-wsp">  </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">apply</span>/fsetP=&gt; i; <span class="nb">rewrite</span> mem_sint inE; <span class="nb">case</span>: ltngtP.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">s2f</span> <span class="nv">n</span> (<span class="nv">s</span> : {<span class="nb">set</span> &#39;I_n}) := [fset nat_of_ord i | i <span class="kr">in</span> s].</span></span><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk9d" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk9d"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">mem_s2f</span> <span class="nv">n</span> (<span class="nv">s</span> : {<span class="nb">set</span> &#39;I_n}) (<span class="nv">i</span> : &#39;I_n) : (i : nat) \<span class="kr">in</span> s2f s = (i \<span class="kr">in</span> s).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">((i : nat) \<span class="kr">in</span> s2f (n:=n) s) = (i \<span class="kr">in</span> s)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk9e" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk9e"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">((i : nat) \<span class="kr">in</span> s2f (n:=n) s) = (i \<span class="kr">in</span> s)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk9f" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk9f"><span class="highlight"><span class="nb">apply</span>/imfsetP/idP =&gt; /= [[j jIs iEj]|iIs]; <span class="nb">last</span> <span class="bp">by</span> <span class="kr">exists</span> <span class="nv">i</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">jIs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">j \<span class="kr">in</span> s</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">iEj</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i = j</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">i \<span class="kr">in</span> s</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> (_ : i = j) //; <span class="nb">apply</span>: val_inj.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chka0" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chka0"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">s2f_set0</span> <span class="nv">n</span> : s2f (set0 : {<span class="nb">set</span> &#39;I_n}) = fset0.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">s2f (n:=n) (set0 : {<span class="nb">set</span> &#39;I_n}) = fset0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chka1" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chka1"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">s2f (n:=n) (set0 : {<span class="nb">set</span> &#39;I_n}) = fset0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chka2" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chka2"><span class="highlight"><span class="nb">apply</span>/fsetP =&gt; i; <span class="nb">rewrite</span> inE.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(i \<span class="kr">in</span> s2f (n:=n) set0) = false</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">apply</span>/idP =&gt; /imfsetP[j /=]; <span class="nb">rewrite</span> inE.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chka3" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chka3"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">s2f_setT</span> <span class="nv">n</span> : s2f (setT : {<span class="nb">set</span> &#39;I_n}) = sint <span class="mi">0</span> n.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">s2f (n:=n) ([<span class="nb">set</span>: ordinal_finType n] : {<span class="nb">set</span> &#39;I_n}) =
`[n]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chka4" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chka4"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">s2f (n:=n) ([<span class="nb">set</span>: ordinal_finType n] : {<span class="nb">set</span> &#39;I_n}) =
`[n]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chka5" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chka5"><span class="highlight"><span class="nb">apply</span>/fsetP =&gt; i; <span class="nb">rewrite</span> mem_sint /=.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(i \<span class="kr">in</span> s2f (n:=n) [<span class="nb">set</span>: &#39;I_n]) = (i &lt; n)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chka6" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chka6"><span class="highlight"><span class="nb">apply</span>/imfsetP/idP =&gt; /= [[j _ -&gt; //]| iLn].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">iLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i &lt; n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists2</span> x : &#39;I_n, x \<span class="kr">in</span> [<span class="nb">set</span>: &#39;I_n] &amp; i = x</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="kr">exists</span> (<span class="nv">Ordinal</span> <span class="nv">iLn</span>).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">

</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chka7" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chka7"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">s2fD</span> <span class="nv">n</span> (<span class="nv">s1</span> <span class="nv">s2</span> : {<span class="nb">set</span> &#39;I_n}) : s2f (s1 :\: s2)  = s2f s1 `\` s2f s2.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">s2f (n:=n) (s1 :\: s2) =
s2f (n:=n) s1 `\` s2f (n:=n) s2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chka8" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chka8"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">s2f (n:=n) (s1 :\: s2) =
s2f (n:=n) s1 `\` s2f (n:=n) s2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chka9" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chka9"><span class="highlight"><span class="nb">apply</span>/fsetP =&gt; j; <span class="nb">rewrite</span> !inE.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(j \<span class="kr">in</span> s2f (n:=n) (s1 :\: s2)) =
(j \notin s2f (n:=n) s2) &amp;&amp; (j \<span class="kr">in</span> s2f (n:=n) s1)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkaa" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkaa"><span class="highlight"><span class="nb">apply</span>/imfsetP/andP =&gt; /= [[k]|[jDi /imfsetP[/= k kIs jEk]]].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">k \<span class="kr">in</span> s1 :\: s2 -&gt;
j = k -&gt; j \notin s2f (n:=n) s2 /\ j \<span class="kr">in</span> s2f (n:=n) s1</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chkab" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">jDi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">j \notin s2f (n:=n) s2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kIs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k \<span class="kr">in</span> s1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">jEk</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">j = k</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chkab"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists2</span> x : &#39;I_n, x \<span class="kr">in</span> s1 :\: s2 &amp; j = x</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkac" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkac"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> !inE -!mem_s2f =&gt; /andP[kDi kIs] -&gt;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">jDi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">j \notin s2f (n:=n) s2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kIs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k \<span class="kr">in</span> s1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">jEk</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">j = k</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists2</span> x : &#39;I_n, x \<span class="kr">in</span> s1 :\: s2 &amp; j = x</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="kr">exists</span> <span class="nv">k</span> =&gt; //; <span class="nb">rewrite</span> !inE kIs -mem_s2f -jEk jDi.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkad" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkad"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">s2fU</span> <span class="nv">n</span> (<span class="nv">s1</span> <span class="nv">s2</span> : {<span class="nb">set</span> &#39;I_n}) : s2f (s1 :|: s2)  = s2f s1 `|` s2f s2.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">s2f (n:=n) (s1 :|: s2) =
s2f (n:=n) s1 `|` s2f (n:=n) s2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkae" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkae"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">s2f (n:=n) (s1 :|: s2) =
s2f (n:=n) s1 `|` s2f (n:=n) s2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkaf" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkaf"><span class="highlight"><span class="nb">apply</span>/fsetP =&gt; j; <span class="nb">rewrite</span> !inE.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(j \<span class="kr">in</span> s2f (n:=n) (s1 :|: s2)) =
(j \<span class="kr">in</span> s2f (n:=n) s1) || (j \<span class="kr">in</span> s2f (n:=n) s2)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkb0" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkb0"><span class="highlight"><span class="nb">apply</span>/imfsetP/orP =&gt; /= [[k]|[] /imfsetP[/= k]].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">k \<span class="kr">in</span> s1 :|: s2 -&gt;
j = k -&gt; j \<span class="kr">in</span> s2f (n:=n) s1 \/ j \<span class="kr">in</span> s2f (n:=n) s2</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chkb1" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chkb1"><hr></label><div class="goal-conclusion"><span class="highlight">k \<span class="kr">in</span> s1 -&gt;
j = k -&gt; <span class="kr">exists2</span> x : &#39;I_n, x \<span class="kr">in</span> s1 :|: s2 &amp; j = x</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="extra-v-chkb2" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chkb2"><hr></label><div class="goal-conclusion"><span class="highlight">k \<span class="kr">in</span> s2 -&gt;
j = k -&gt; <span class="kr">exists2</span> x : &#39;I_n, x \<span class="kr">in</span> s1 :|: s2 &amp; j = x</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkb3" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkb3"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">k \<span class="kr">in</span> s1 :|: s2 -&gt;
j = k -&gt; j \<span class="kr">in</span> s2f (n:=n) s1 \/ j \<span class="kr">in</span> s2f (n:=n) s2</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chkb4" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chkb4"><hr></label><div class="goal-conclusion"><span class="highlight">k \<span class="kr">in</span> s1 -&gt;
j = k -&gt; <span class="kr">exists2</span> x : &#39;I_n, x \<span class="kr">in</span> s1 :|: s2 &amp; j = x</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="extra-v-chkb5" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chkb5"><hr></label><div class="goal-conclusion"><span class="highlight">k \<span class="kr">in</span> s2 -&gt;
j = k -&gt; <span class="kr">exists2</span> x : &#39;I_n, x \<span class="kr">in</span> s1 :|: s2 &amp; j = x</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkb6" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkb6"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> !inE -!mem_s2f =&gt; /orP[] kIs -&gt;; [<span class="nb">left</span>|<span class="nb">right</span>].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">k \<span class="kr">in</span> s1 -&gt;
j = k -&gt; <span class="kr">exists2</span> x : &#39;I_n, x \<span class="kr">in</span> s1 :|: s2 &amp; j = x</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chkb7" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chkb7"><hr></label><div class="goal-conclusion"><span class="highlight">k \<span class="kr">in</span> s2 -&gt;
j = k -&gt; <span class="kr">exists2</span> x : &#39;I_n, x \<span class="kr">in</span> s1 :|: s2 &amp; j = x</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkb8" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkb8"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">k \<span class="kr">in</span> s1 -&gt;
j = k -&gt; <span class="kr">exists2</span> x : &#39;I_n, x \<span class="kr">in</span> s1 :|: s2 &amp; j = x</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chkb9" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chkb9"><hr></label><div class="goal-conclusion"><span class="highlight">k \<span class="kr">in</span> s2 -&gt;
j = k -&gt; <span class="kr">exists2</span> x : &#39;I_n, x \<span class="kr">in</span> s1 :|: s2 &amp; j = x</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkba" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkba"><span class="highlight"><span class="bp">by</span> <span class="nb">move</span> =&gt; kIs1 -&gt;; <span class="kr">exists</span> <span class="nv">k</span>; <span class="nb">rewrite</span> // inE kIs1.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">k \<span class="kr">in</span> s2 -&gt;
j = k -&gt; <span class="kr">exists2</span> x : &#39;I_n, x \<span class="kr">in</span> s1 :|: s2 &amp; j = x</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">move</span> =&gt; kIs2 -&gt;; <span class="kr">exists</span> <span class="nv">k</span>; <span class="nb">rewrite</span> // inE kIs2 orbT.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkbb" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkbb"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">s2fI</span> <span class="nv">n</span> (<span class="nv">s1</span> <span class="nv">s2</span> : {<span class="nb">set</span> &#39;I_n}) : s2f (s1 :&amp;: s2)  = s2f s1 `&amp;` s2f s2.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">s2f (n:=n) (s1 :&amp;: s2) =
s2f (n:=n) s1 `&amp;` s2f (n:=n) s2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkbc" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkbc"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">s2f (n:=n) (s1 :&amp;: s2) =
s2f (n:=n) s1 `&amp;` s2f (n:=n) s2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkbd" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkbd"><span class="highlight"><span class="nb">apply</span>/fsetP =&gt; j; <span class="nb">rewrite</span> !inE.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(j \<span class="kr">in</span> s2f (n:=n) (s1 :&amp;: s2)) =
(j \<span class="kr">in</span> s2f (n:=n) s1) &amp;&amp; (j \<span class="kr">in</span> s2f (n:=n) s2)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkbe" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkbe"><span class="highlight"><span class="nb">apply</span>/imfsetP/andP =&gt; /= [[k]|[jDi /imfsetP[/= k kIs jEk]]].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">k \<span class="kr">in</span> s1 :&amp;: s2 -&gt;
j = k -&gt; j \<span class="kr">in</span> s2f (n:=n) s1 /\ j \<span class="kr">in</span> s2f (n:=n) s2</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chkbf" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">jDi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">j \<span class="kr">in</span> s2f (n:=n) s1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kIs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k \<span class="kr">in</span> s2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">jEk</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">j = k</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chkbf"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists2</span> x : &#39;I_n, x \<span class="kr">in</span> s1 :&amp;: s2 &amp; j = x</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkc0" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkc0"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> !inE -!mem_s2f =&gt; /andP[kDi kIs] -&gt;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s1, s2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">jDi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">j \<span class="kr">in</span> s2f (n:=n) s1</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kIs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k \<span class="kr">in</span> s2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">jEk</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">j = k</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists2</span> x : &#39;I_n, x \<span class="kr">in</span> s1 :&amp;: s2 &amp; j = x</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="kr">exists</span> <span class="nv">k</span> =&gt; //; <span class="nb">rewrite</span> !inE kIs -mem_s2f -jEk jDi.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkc1" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkc1"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">s2f1</span> <span class="nv">n</span> (<span class="nv">i</span> : &#39;I_n) : s2f [<span class="nb">set</span> i] = [fset (nat_of_ord i)].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">s2f (n:=n) [<span class="nb">set</span> i] = [fset i]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkc2" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkc2"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">s2f (n:=n) [<span class="nb">set</span> i] = [fset i]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkc3" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkc3"><span class="highlight"><span class="nb">apply</span>/fsetP =&gt; j; <span class="nb">rewrite</span> !inE.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(j \<span class="kr">in</span> s2f (n:=n) [<span class="nb">set</span> i]) = (j == i)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkc4" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkc4"><span class="highlight"><span class="nb">apply</span>/imfsetP/eqP =&gt; /= [[k]|-&gt;]; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> inE =&gt; /eqP -&gt;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists2</span> x : &#39;I_n, x \<span class="kr">in</span> [<span class="nb">set</span> i] &amp; i = x</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="kr">exists</span> <span class="nv">i</span>; <span class="nb">rewrite</span> <span class="nl">?inE</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkc5" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkc5"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">s2f_pred</span> <span class="nv">n</span> (<span class="nv">s</span> : {<span class="nb">set</span> &#39;I_n}) (<span class="nv">P</span> : pred nat) : 
   s2f [<span class="nb">set</span> i <span class="kr">in</span> s | P i] = [fset i <span class="kr">in</span> (s2f s) | P i].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">pred nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">s2f (n:=n) [<span class="nb">set</span> i <span class="kr">in</span> s | P i] =
[fset i <span class="kr">in</span> s2f (n:=n) s | P i]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkc6" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkc6"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">pred nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">s2f (n:=n) [<span class="nb">set</span> i <span class="kr">in</span> s | P i] =
[fset i <span class="kr">in</span> s2f (n:=n) s | P i]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkc7" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkc7"><span class="highlight"><span class="nb">apply</span>/fsetP=&gt; i; <span class="nb">rewrite</span> !inE /=.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">pred nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(i \<span class="kr">in</span> s2f (n:=n) [<span class="nb">set</span> i <span class="kr">in</span> s | P i]) =
(i
   \<span class="kr">in</span> [eta mem_seq (T:=nat_choiceType) (s2f (n:=n) s)]) &amp;&amp;
P i</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkc8" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkc8"><span class="highlight"><span class="nb">apply</span>/imfsetP/andP =&gt; /= [[j]|].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">pred nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">j \<span class="kr">in</span> [<span class="nb">set</span> i <span class="kr">in</span> s | P i] -&gt;
i = j -&gt;
i \<span class="kr">in</span> [eta mem_seq (T:=nat_choiceType) (s2f (n:=n) s)] /\
P i</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chkc9" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">pred nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chkc9"><hr></label><div class="goal-conclusion"><span class="highlight">i \<span class="kr">in</span> [eta mem_seq (T:=nat_choiceType) (s2f (n:=n) s)] /\
P i -&gt;
<span class="kr">exists2</span> x : &#39;I_n, x \<span class="kr">in</span> [<span class="nb">set</span> i <span class="kr">in</span> s | P i] &amp; i = x</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkca" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkca"><span class="highlight"><span class="nb">rewrite</span> !inE =&gt; /andP[jIs jP] -&gt;; <span class="nb">split</span> =&gt; //.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">pred nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">jIs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">j \<span class="kr">in</span> s</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">jP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P j</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">j \<span class="kr">in</span> [eta mem_seq (T:=nat_choiceType) (s2f (n:=n) s)]</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chkcb" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">pred nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chkcb"><hr></label><div class="goal-conclusion"><span class="highlight">i \<span class="kr">in</span> [eta mem_seq (T:=nat_choiceType) (s2f (n:=n) s)] /\
P i -&gt;
<span class="kr">exists2</span> x : &#39;I_n, x \<span class="kr">in</span> [<span class="nb">set</span> i <span class="kr">in</span> s | P i] &amp; i = x</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkcc" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkcc"><span class="highlight"><span class="bp">by</span> <span class="nb">apply</span>/imfsetP; <span class="kr">exists</span> <span class="nv">j</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">pred nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">i \<span class="kr">in</span> [eta mem_seq (T:=nat_choiceType) (s2f (n:=n) s)] /\
P i -&gt;
<span class="kr">exists2</span> x : &#39;I_n, x \<span class="kr">in</span> [<span class="nb">set</span> i <span class="kr">in</span> s | P i] &amp; i = x</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkcd" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkcd"><span class="highlight"><span class="nb">move</span>=&gt; [/imfsetP[/= j jIs -&gt;] jP]; <span class="kr">exists</span> <span class="nv">j</span> =&gt; //.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">P</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">pred nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">jIs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">j \<span class="kr">in</span> s</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">jP</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">P j</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">j \<span class="kr">in</span> [<span class="nb">set</span> i <span class="kr">in</span> s | P i]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> inE jIs.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkce" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkce"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">s2fD1</span> <span class="nv">n</span> (<span class="nv">s</span> : {<span class="nb">set</span> &#39;I_n}) <span class="nv">i</span> : s2f (s :\ i) = s2f s `\ (nat_of_ord i).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ordinal_finType n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">s2f (n:=n) (s :\ i) = s2f (n:=n) s `\ i</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkcf" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkcf"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ordinal_finType n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">s2f (n:=n) (s :\ i) = s2f (n:=n) s `\ i</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> s2fD s2f1.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkd0" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkd0"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">card_s2f</span> <span class="nv">n</span> (<span class="nv">s</span> : {<span class="nb">set</span> &#39;I_n}) : #|` s2f s| = #|s|.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|` s2f (n:=n) s| = #|s|</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkd1" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkd1"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|` s2f (n:=n) s| = #|s|</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkd2" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkd2"><span class="highlight"><span class="nb">have</span> [m sLm] := ubnP #|s|; <span class="nb">elim</span>: m =&gt; // m IH s sLm <span class="kr">in</span> s sLm *.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">s</span> : {<span class="nb">set</span> &#39;I_n},
#|s| &lt; m -&gt; #|` s2f (n:=n) s| = #|s|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">sLm</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|s| &lt; m.+<span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|` s2f (n:=n) s| = #|s|</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"> </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkd3" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkd3"><span class="highlight"><span class="nb">case</span>: (set_0Vmem s) =&gt; [-&gt;|[i iIs]]; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> s2f_set0 cards0.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">s</span> : {<span class="nb">set</span> &#39;I_n},
#|s| &lt; m -&gt; #|` s2f (n:=n) s| = #|s|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">sLm</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|s| &lt; m.+<span class="mi">1</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ordinal_finType n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">iIs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i \<span class="kr">in</span> s</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|` s2f (n:=n) s| = #|s|</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkd4" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkd4"><span class="highlight"><span class="nb">rewrite</span> (cardsD1 i) iIs /= -IH //; <span class="nb">last first</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">s</span> : {<span class="nb">set</span> &#39;I_n},
#|s| &lt; m -&gt; #|` s2f (n:=n) s| = #|s|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">sLm</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|s| &lt; m.+<span class="mi">1</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ordinal_finType n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">iIs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i \<span class="kr">in</span> s</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|s :\ i| &lt; m</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chkd5" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">s</span> : {<span class="nb">set</span> &#39;I_n},
#|s| &lt; m -&gt; #|` s2f (n:=n) s| = #|s|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">sLm</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|s| &lt; m.+<span class="mi">1</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ordinal_finType n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">iIs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i \<span class="kr">in</span> s</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chkd5"><hr></label><div class="goal-conclusion"><span class="highlight">#|` s2f (n:=n) s| = (<span class="mi">1</span> + #|` s2f (n:=n) (s :\ i)|)%N</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkd6" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkd6"><span class="highlight"><span class="bp">by</span> <span class="nb">move</span>: sLm; <span class="nb">rewrite</span> (cardsD1 i) iIs.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">s</span> : {<span class="nb">set</span> &#39;I_n},
#|s| &lt; m -&gt; #|` s2f (n:=n) s| = #|s|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">sLm</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|s| &lt; m.+<span class="mi">1</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ordinal_finType n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">iIs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i \<span class="kr">in</span> s</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|` s2f (n:=n) s| = (<span class="mi">1</span> + #|` s2f (n:=n) (s :\ i)|)%N</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkd7" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkd7"><span class="highlight"><span class="nb">rewrite</span> [LHS](cardfsD1 (nat_of_ord i)) (_ : _ \<span class="kr">in</span> _); <span class="nb">last first</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">s</span> : {<span class="nb">set</span> &#39;I_n},
#|s| &lt; m -&gt; #|` s2f (n:=n) s| = #|s|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">sLm</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|s| &lt; m.+<span class="mi">1</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ordinal_finType n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">iIs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i \<span class="kr">in</span> s</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">i \<span class="kr">in</span> s2f (n:=n) s</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chkd8" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">s</span> : {<span class="nb">set</span> &#39;I_n},
#|s| &lt; m -&gt; #|` s2f (n:=n) s| = #|s|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">sLm</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|s| &lt; m.+<span class="mi">1</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ordinal_finType n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">iIs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i \<span class="kr">in</span> s</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chkd8"><hr></label><div class="goal-conclusion"><span class="highlight">(true + #|` s2f (n:=n) s `\ i|)%N =
(<span class="mi">1</span> + #|` s2f (n:=n) (s :\ i)|)%N</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkd9" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkd9"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> mem_s2f.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">s</span> : {<span class="nb">set</span> &#39;I_n},
#|s| &lt; m -&gt; #|` s2f (n:=n) s| = #|s|</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">sLm</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">#|s| &lt; m.+<span class="mi">1</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ordinal_finType n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">iIs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i \<span class="kr">in</span> s</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(true + #|` s2f (n:=n) s `\ i|)%N =
(<span class="mi">1</span> + #|` s2f (n:=n) (s :\ i)|)%N</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> s2fD1.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* initial section of an ordinal *)</span>
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">isO</span> <span class="nv">n</span> <span class="nv">t</span> := [<span class="nb">set</span> i | (i : &#39;I_n) &lt; t].</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkda" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkda"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">isOE</span> <span class="nv">n</span> <span class="nv">t</span> : t &lt;= n -&gt; s2f (isO n t) = sint <span class="mi">0</span> t.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">t &lt;= n -&gt; s2f (n:=n) (isO n t) = `[t]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkdb" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkdb"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">t &lt;= n -&gt; s2f (n:=n) (isO n t) = `[t]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkdc" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkdc"><span class="highlight"><span class="nb">move</span>=&gt; tLn.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">tLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">t &lt;= n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">s2f (n:=n) (isO n t) = `[t]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkdd" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkdd"><span class="highlight"><span class="nb">apply</span>/fsetP =&gt; i; <span class="nb">rewrite</span> mem_sint.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">tLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">t &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(i \<span class="kr">in</span> s2f (n:=n) (isO n t)) = (<span class="mi">0</span> &lt;= i &lt; t)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkde" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkde"><span class="highlight"><span class="nb">apply</span>/imfsetP/idP =&gt; /= [[j]|iLt]; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> inE =&gt; jLt -&gt;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">tLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">t &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">iLt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i &lt; t</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists2</span> x : &#39;I_n, x \<span class="kr">in</span> isO n t &amp; i = x</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkdf" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkdf"><span class="highlight"><span class="nb">have</span> iLn : i &lt; n <span class="bp">by</span> <span class="nb">apply</span>: leq_trans tLn.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">tLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">t &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">iLt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i &lt; t</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">iLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i &lt; n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists2</span> x : &#39;I_n, x \<span class="kr">in</span> isO n t &amp; i = x</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="kr">exists</span> (<span class="nv">Ordinal</span> <span class="nv">iLn</span>); <span class="nb">rewrite</span> // inE.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chke0" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chke0"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">mem_isO</span> <span class="nv">n</span> <span class="nv">t</span> <span class="nv">i</span> : (i \<span class="kr">in</span> isO n t) = (i &lt; t).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ordinal_finType n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(i \<span class="kr">in</span> isO n t) = (i &lt; t)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chke1" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chke1"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ordinal_finType n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(i \<span class="kr">in</span> isO n t) = (i &lt; t)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> inE.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chke2" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chke2"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">isOE_ge</span> <span class="nv">n</span> <span class="nv">t</span> : n &lt;= t -&gt; isO n t = setT.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">n &lt;= t -&gt; isO n t = [<span class="nb">set</span>: ordinal_finType n]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chke3" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chke3"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">n &lt;= t -&gt; isO n t = [<span class="nb">set</span>: ordinal_finType n]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">move</span>=&gt; nLt; <span class="nb">apply</span>/setP =&gt; √≠; <span class="nb">rewrite</span> !inE (leq_trans _ nLt).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chke4" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chke4"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">isOE_le</span> <span class="nv">n</span> <span class="nv">t</span> : t &lt; n.+<span class="mi">1</span> -&gt; isO n.+<span class="mi">1</span> t = [<span class="nb">set</span> inord i | i : &#39;I_t].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">t &lt; n.+<span class="mi">1</span> -&gt; isO n.+<span class="mi">1</span> t = [<span class="nb">set</span> inord i | i : &#39;I_t]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chke5" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chke5"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">t &lt; n.+<span class="mi">1</span> -&gt; isO n.+<span class="mi">1</span> t = [<span class="nb">set</span> inord i | i : &#39;I_t]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chke6" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chke6"><span class="highlight"><span class="nb">move</span>=&gt; tLn; <span class="nb">apply</span>/setP=&gt; i; <span class="nb">rewrite</span> !inE.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">tLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">t &lt; n.+<span class="mi">1</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ordinal_finType n.+<span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(i &lt; t) = (i \<span class="kr">in</span> [<span class="nb">set</span> inord i | i : &#39;I_t])</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chke7" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chke7"><span class="highlight"><span class="nb">apply</span>/idP/imsetP =&gt; [iLt| [j _ -&gt;]].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">tLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">t &lt; n.+<span class="mi">1</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ordinal_finType n.+<span class="mi">1</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">iLt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i &lt; t</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists2</span> x : ordinal_finType t,
  x \<span class="kr">in</span> &#39;I_t &amp; i = inord x</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chke8" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">tLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">t &lt; n.+<span class="mi">1</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ordinal_finType n.+<span class="mi">1</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ordinal_finType t</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chke8"><hr></label><div class="goal-conclusion"><span class="highlight">inord j &lt; t</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chke9" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chke9"><span class="highlight"><span class="bp">by</span> <span class="kr">exists</span> (<span class="nv">Ordinal</span> <span class="nv">iLt</span>); <span class="nb">rewrite</span> //=; <span class="nb">apply</span>/val_eqP; <span class="nb">rewrite</span> /= inordK.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">tLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">t &lt; n.+<span class="mi">1</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ordinal_finType n.+<span class="mi">1</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ordinal_finType t</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">inord j &lt; t</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> inordK // (leq_trans _ tLn) // ltnS // ltnW.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkea" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkea"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">card_isO</span> <span class="nv">n</span> <span class="nv">t</span> : #|isO n t| = minn n t.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|isO n t| = minn n t</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkeb" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkeb"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">#|isO n t| = minn n t</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkec" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkec"><span class="highlight"><span class="nb">apply</span>/sym_equal.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">minn n t = #|isO n t|</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chked" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chked"><span class="highlight"><span class="nb">case</span>: (leqP n t) =&gt; [nLt|tLn].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nLt</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt;= t</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">n = #|isO n t|</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chkee" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">tLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">t &lt; n</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chkee"><hr></label><div class="goal-conclusion"><span class="highlight">t = #|isO n t|</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkef" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkef"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> isOE_ge //= cardsT card_ord.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">tLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">t &lt; n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">t = #|isO n t|</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkf0" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkf0"><span class="highlight"><span class="nb">case</span>: n tLn =&gt; // n tLn.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">t, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">tLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">t &lt; n.+<span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">t = #|isO n.+<span class="mi">1</span> t|</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkf1" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkf1"><span class="highlight"><span class="nb">rewrite</span> isOE_le // card_imset // =&gt; [|i j /val_eqP/eqP /=].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">t, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">tLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">t &lt; n.+<span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">t = #|&#39;I_t|</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chkf2" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">t, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">tLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">t &lt; n.+<span class="mi">1</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ordinal_finType t</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chkf2"><hr></label><div class="goal-conclusion"><span class="highlight">inord i = inord j -&gt; i = j</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkf3" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkf3"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> card_ord.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">t, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">tLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">t &lt; n.+<span class="mi">1</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">ordinal_finType t</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">inord i = inord j -&gt; i = j</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> !inordK ?(leq_trans _ tLn) <span class="nl">?ltnS</span> <span class="mi">1</span><span class="nl">?ltnW</span> // =&gt; /eqP/val_eqP.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkf4" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkf4"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">s2fD_isO</span> <span class="nv">n</span> (<span class="nv">s</span> : {<span class="nb">set</span> &#39;I_n}) <span class="nv">t</span> : s2f (s :\: isO n t)  = s2f s `\` sint <span class="mi">0</span> t.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">s2f (n:=n) (s :\: isO n t) = s2f (n:=n) s `\` `[t]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkf5" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkf5"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">s2f (n:=n) (s :\: isO n t) = s2f (n:=n) s `\` `[t]</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkf6" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkf6"><span class="highlight"><span class="nb">apply</span>/fsetP =&gt; j; <span class="nb">rewrite</span> !inE.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(j \<span class="kr">in</span> s2f (n:=n) (s :\: isO n t)) =
(j \notin `[t]) &amp;&amp; (j \<span class="kr">in</span> s2f (n:=n) s)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkf7" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkf7"><span class="highlight"><span class="nb">apply</span>/imfsetP/andP =&gt; /= [[k]|[jDi /imfsetP[/= k kIs jEk]]].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">k \<span class="kr">in</span> s :\: isO n t -&gt;
j = k -&gt; j \notin `[t] /\ j \<span class="kr">in</span> s2f (n:=n) s</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chkf8" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">jDi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">j \notin `[t]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kIs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k \<span class="kr">in</span> s</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">jEk</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">j = k</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chkf8"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists2</span> x : &#39;I_n, x \<span class="kr">in</span> s :\: isO n t &amp; j = x</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkf9" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkf9"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> !inE -!mem_s2f mem_sint /= =&gt; /andP[kDi kIs] -&gt;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">jDi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">j \notin `[t]</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kIs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k \<span class="kr">in</span> s</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">jEk</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">j = k</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists2</span> x : &#39;I_n, x \<span class="kr">in</span> s :\: isO n t &amp; j = x</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkfa" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkfa"><span class="highlight"><span class="nb">move</span>: jDi; <span class="nb">rewrite</span> mem_sint /= -leqNgt =&gt; jDi.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">s</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{<span class="nb">set</span> &#39;I_n}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">t</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat_choiceType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kIs</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k \<span class="kr">in</span> s</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">jEk</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">j = k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">jDi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">t &lt;= j</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists2</span> x : &#39;I_n, x \<span class="kr">in</span> s :\: isO n t &amp; j = x</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="kr">exists</span> <span class="nv">k</span>; <span class="nb">rewrite</span> // !inE -leqNgt kIs -jEk jDi.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="sd">(******************************************************************************)</span>
<span class="c">(*                                                                            *)</span>
<span class="c">(*              Specific theorems for shanoi                                  *)</span>
<span class="c">(*                                                                            *)</span>
<span class="sd">(******************************************************************************)</span>

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Open Scope</span> nat_scope.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkfb" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkfb"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">codom_subC</span> (<span class="nv">A</span> : finType) (<span class="nv">B</span> : finType) (<span class="nv">f</span> : {ffun A -&gt; B}) 
          (<span class="nv">p1</span> <span class="nv">p2</span> : B) : 
  (codom f \subset [:: p1; p2]) = (codom f \subset [:: p2; p1]).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{ffun A -&gt; B}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p1, p2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(codom f \subset [:: p1; p2]) =
(codom f \subset [:: p2; p1])</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkfc" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkfc"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">A, B</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">finType</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">{ffun A -&gt; B}</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">p1, p2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">B</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(codom f \subset [:: p1; p2]) =
(codom f \subset [:: p2; p1])</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">apply</span>/subsetP/subsetP; <span class="nb">move</span> =&gt; sB i /sB; <span class="nb">rewrite</span> !inE orbC.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkfd" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkfd"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">inord_eq0</span> <span class="nv">n</span> <span class="nv">k</span> : k = <span class="mi">0</span> -&gt; inord k = ord0 :&gt; &#39;I_n.+<span class="mi">1</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">k = <span class="mi">0</span> -&gt; inord k = ord0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkfe" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkfe"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">k = <span class="mi">0</span> -&gt; inord k = ord0</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">move</span>=&gt; -&gt; /=; <span class="nb">apply</span>/val_eqP; <span class="nb">rewrite</span> /= inordK.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chkff" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chkff"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">mod3_0</span> <span class="nv">a</span> : (<span class="mi">3</span> * a) %% <span class="mi">3</span> = <span class="mi">0</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="mi">3</span> * a) %% <span class="mi">3</span> = <span class="mi">0</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk100" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk100"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="mi">3</span> * a) %% <span class="mi">3</span> = <span class="mi">0</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> modnMr.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk101" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk101"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">mod3_1</span> <span class="nv">a</span> : (<span class="mi">3</span> * a).+<span class="mi">1</span> %% <span class="mi">3</span> = <span class="mi">1</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="mi">3</span> * a).+<span class="mi">1</span> %% <span class="mi">3</span> = <span class="mi">1</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk102" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk102"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="mi">3</span> * a).+<span class="mi">1</span> %% <span class="mi">3</span> = <span class="mi">1</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> mulnC -addn1 modnMDl.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk103" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk103"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">mod3_2</span> <span class="nv">a</span> : (<span class="mi">3</span> * a).+<span class="mi">2</span> %% <span class="mi">3</span> = <span class="mi">2</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="mi">3</span> * a).+<span class="mi">2</span> %% <span class="mi">3</span> = <span class="mi">2</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk104" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk104"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="mi">3</span> * a).+<span class="mi">2</span> %% <span class="mi">3</span> = <span class="mi">2</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> mulnC -addn2 modnMDl.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">mod3E</span> := (mod3_0, mod3_1, mod3_2).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk105" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk105"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">div3_0</span> <span class="nv">a</span> : (<span class="mi">3</span> * a) %/ <span class="mi">3</span> = a.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="mi">3</span> * a) %/ <span class="mi">3</span> = a</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk106" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk106"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="mi">3</span> * a) %/ <span class="mi">3</span> = a</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> mulKn.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk107" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk107"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">div3_1</span> <span class="nv">a</span> : (<span class="mi">3</span> * a).+<span class="mi">1</span> %/ <span class="mi">3</span> = a.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="mi">3</span> * a).+<span class="mi">1</span> %/ <span class="mi">3</span> = a</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk108" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk108"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="mi">3</span> * a).+<span class="mi">1</span> %/ <span class="mi">3</span> = a</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> mulnC -addn1 divnMDl // divn_small // addn0.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk109" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk109"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">div3_2</span> <span class="nv">a</span> : (<span class="mi">3</span> * a).+<span class="mi">2</span> %/ <span class="mi">3</span> = a.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="mi">3</span> * a).+<span class="mi">2</span> %/ <span class="mi">3</span> = a</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk10a" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk10a"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">a</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="mi">3</span> * a).+<span class="mi">2</span> %/ <span class="mi">3</span> = a</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> mulnC -addn2 divnMDl // divn_small // addn0.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">div3E</span> := (div3_0, div3_1, div3_2).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk10b" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk10b"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">sum3E</span> <span class="nv">n</span> (<span class="nv">f</span> : nat -&gt; nat) : 
  \sum_(i &lt; <span class="mi">3</span> * n) f i =
  \sum_(i &lt; n) (f (<span class="mi">3</span> * i) + f (<span class="mi">3</span> * i).+<span class="mi">1</span> + f (<span class="mi">3</span> * i).+<span class="mi">2</span>).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">\sum_(i &lt; <span class="mi">3</span> * n) f i =
\sum_(i &lt; n) (f (<span class="mi">3</span> * i) + f (<span class="mi">3</span> * i).+<span class="mi">1</span> + f (<span class="mi">3</span> * i).+<span class="mi">2</span>)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk10c" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk10c"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">\sum_(i &lt; <span class="mi">3</span> * n) f i =
\sum_(i &lt; n) (f (<span class="mi">3</span> * i) + f (<span class="mi">3</span> * i).+<span class="mi">1</span> + f (<span class="mi">3</span> * i).+<span class="mi">2</span>)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk10d" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk10d"><span class="highlight"><span class="nb">elim</span>: n =&gt; [|n IH]; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> !big_ord0.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">\sum_(i &lt; <span class="mi">3</span> * n) f i =
\sum_(i &lt; n)
   (f (<span class="mi">3</span> * i) + f (<span class="mi">3</span> * i).+<span class="mi">1</span> + f (<span class="mi">3</span> * i).+<span class="mi">2</span>)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">\sum_(i &lt; <span class="mi">3</span> * n.+<span class="mi">1</span>) f i =
\sum_(i &lt; n.+<span class="mi">1</span>)
   (f (<span class="mi">3</span> * i) + f (<span class="mi">3</span> * i).+<span class="mi">1</span> + f (<span class="mi">3</span> * i).+<span class="mi">2</span>)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> mulnS !big_ord_recr /= IH !addnA.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk10e" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk10e"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">Ival_eq</span> <span class="nv">n</span> (<span class="nv">x</span> <span class="nv">y</span> : &#39;I_n) : (x == y) = (val x == val y).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(x == y) = (val x == val y)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk10f" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk10f"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">x, y</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(x == y) = (val x == val y)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">apply</span>/eqP/val_eqP.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk110" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk110"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">oddS</span> <span class="nv">n</span> : odd n.+<span class="mi">1</span> = ~~ odd n.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">odd n.+<span class="mi">1</span> = ~~ odd n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk111" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk111"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">odd n.+<span class="mi">1</span> = ~~ odd n</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> [].</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk112" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk112"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">even_halfMl</span> <span class="nv">k</span> <span class="nv">m</span> : 
  ~~ odd m -&gt; (k * m)./<span class="mi">2</span> = k * m./<span class="mi">2</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">k, m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~~ odd m -&gt; (k * m)./<span class="mi">2</span> = k * m./<span class="mi">2</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk113" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk113"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">k, m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~~ odd m -&gt; (k * m)./<span class="mi">2</span> = k * m./<span class="mi">2</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk114" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk114"><span class="highlight"><span class="nb">move</span>=&gt; mE.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">k, m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mE</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ odd m</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(k * m)./<span class="mi">2</span> = k * m./<span class="mi">2</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk115" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk115"><span class="highlight"><span class="nb">have</span> := odd_double_half m; <span class="nb">rewrite</span> (negPf mE) add0n =&gt; {<span class="mi">1</span>}&lt;-.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">k, m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mE</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ odd m</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(k * (m./<span class="mi">2</span>).*<span class="mi">2</span>)./<span class="mi">2</span> = k * m./<span class="mi">2</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> -doubleMr doubleK.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk116" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk116"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">even_halfMr</span> <span class="nv">k</span> <span class="nv">m</span> : 
  ~~ odd m -&gt; (m * k)./<span class="mi">2</span> = m./<span class="mi">2</span> * k.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">k, m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~~ odd m -&gt; (m * k)./<span class="mi">2</span> = m./<span class="mi">2</span> * k</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk117" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk117"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">k, m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~~ odd m -&gt; (m * k)./<span class="mi">2</span> = m./<span class="mi">2</span> * k</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk118" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk118"><span class="highlight"><span class="nb">move</span>=&gt; mE.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">k, m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mE</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ odd m</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(m * k)./<span class="mi">2</span> = m./<span class="mi">2</span> * k</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk119" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk119"><span class="highlight"><span class="nb">have</span> := odd_double_half m; <span class="nb">rewrite</span> (negPf mE) add0n =&gt; {<span class="mi">1</span>}&lt;-.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">k, m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mE</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ odd m</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">((m./<span class="mi">2</span>).*<span class="mi">2</span> * k)./<span class="mi">2</span> = m./<span class="mi">2</span> * k</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> -doubleMl doubleK.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk11a" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk11a"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">even_halfD</span> <span class="nv">m</span> <span class="nv">n</span> : 
  ~~ odd m -&gt; ~~ odd n -&gt; (m + n)./<span class="mi">2</span> = (m./<span class="mi">2</span> + n./<span class="mi">2</span>).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~~ odd m -&gt; ~~ odd n -&gt; (m + n)./<span class="mi">2</span> = m./<span class="mi">2</span> + n./<span class="mi">2</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk11b" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk11b"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~~ odd m -&gt; ~~ odd n -&gt; (m + n)./<span class="mi">2</span> = m./<span class="mi">2</span> + n./<span class="mi">2</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk11c" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk11c"><span class="highlight"><span class="nb">move</span>=&gt; mE nE.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mE</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ odd m</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nE</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ odd n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(m + n)./<span class="mi">2</span> = m./<span class="mi">2</span> + n./<span class="mi">2</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk11d" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk11d"><span class="highlight"><span class="nb">have</span> := odd_double_half m; <span class="nb">rewrite</span> (negPf mE) add0n =&gt; {<span class="mi">1</span>}&lt;-.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mE</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ odd m</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nE</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ odd n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">((m./<span class="mi">2</span>).*<span class="mi">2</span> + n)./<span class="mi">2</span> = m./<span class="mi">2</span> + n./<span class="mi">2</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk11e" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk11e"><span class="highlight"><span class="nb">have</span> := odd_double_half n; <span class="nb">rewrite</span> (negPf nE) add0n =&gt; {<span class="mi">1</span>}&lt;-.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mE</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ odd m</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nE</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ odd n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">((m./<span class="mi">2</span>).*<span class="mi">2</span> + (n./<span class="mi">2</span>).*<span class="mi">2</span>)./<span class="mi">2</span> = m./<span class="mi">2</span> + n./<span class="mi">2</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> -doubleD doubleK.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk11f" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk11f"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">even_halfB</span> <span class="nv">m</span> <span class="nv">n</span> : 
  ~~ odd m -&gt; ~~ odd n -&gt; (m - n)./<span class="mi">2</span> = m./<span class="mi">2</span> - n./<span class="mi">2</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~~ odd m -&gt; ~~ odd n -&gt; (m - n)./<span class="mi">2</span> = m./<span class="mi">2</span> - n./<span class="mi">2</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk120" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk120"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">~~ odd m -&gt; ~~ odd n -&gt; (m - n)./<span class="mi">2</span> = m./<span class="mi">2</span> - n./<span class="mi">2</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk121" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk121"><span class="highlight"><span class="nb">move</span>=&gt; mE nE.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mE</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ odd m</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nE</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ odd n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(m - n)./<span class="mi">2</span> = m./<span class="mi">2</span> - n./<span class="mi">2</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk122" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk122"><span class="highlight"><span class="nb">have</span> := odd_double_half m; <span class="nb">rewrite</span> (negPf mE) add0n =&gt; {<span class="mi">1</span>}&lt;-.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mE</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ odd m</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nE</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ odd n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">((m./<span class="mi">2</span>).*<span class="mi">2</span> - n)./<span class="mi">2</span> = m./<span class="mi">2</span> - n./<span class="mi">2</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk123" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk123"><span class="highlight"><span class="nb">have</span> := odd_double_half n; <span class="nb">rewrite</span> (negPf nE) add0n =&gt; {<span class="mi">1</span>}&lt;-.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mE</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ odd m</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nE</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">~~ odd n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">((m./<span class="mi">2</span>).*<span class="mi">2</span> - (n./<span class="mi">2</span>).*<span class="mi">2</span>)./<span class="mi">2</span> = m./<span class="mi">2</span> - n./<span class="mi">2</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> -doubleB doubleK.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk124" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk124"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">leq_pred2</span> <span class="nv">m</span> <span class="nv">n</span> : m &lt;= n -&gt; m.-<span class="mi">1</span> &lt;= n.-<span class="mi">1</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">m &lt;= n -&gt; m.-<span class="mi">1</span> &lt;= n.-<span class="mi">1</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk125" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk125"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">m &lt;= n -&gt; m.-<span class="mi">1</span> &lt;= n.-<span class="mi">1</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">case</span>: m; <span class="nb">case</span>: n =&gt; //=.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk126" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk126"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">subn_minr</span> : left_distributive subn minn.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">left_distributive subn minn</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk127" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk127"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">left_distributive subn minn</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk128" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk128"><span class="highlight"><span class="nb">move</span>=&gt; m n p; <span class="nb">rewrite</span> /minn; <span class="nb">case</span>: leqP =&gt; [nLm|mLn].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nLm</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt;= m</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">n - p = (<span class="kr">if</span> m - p &lt; n - p <span class="kr">then</span> m - p <span class="kr">else</span> n - p)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk129" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">m &lt; n</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk129"><hr></label><div class="goal-conclusion"><span class="highlight">m - p = (<span class="kr">if</span> m - p &lt; n - p <span class="kr">then</span> m - p <span class="kr">else</span> n - p)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk12a" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk12a"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> ltnNge leq_sub2r.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">m &lt; n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">m - p = (<span class="kr">if</span> m - p &lt; n - p <span class="kr">then</span> m - p <span class="kr">else</span> n - p)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk12b" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk12b"><span class="highlight"><span class="nb">have</span> [nLp|pLn] := leqP n p; <span class="nb">last</span> <span class="bp">by</span> <span class="nb">rewrite</span> ltn_sub2r.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">m &lt; n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nLp</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt;= p</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">m - p = (<span class="kr">if</span> m - p &lt; n - p <span class="kr">then</span> m - p <span class="kr">else</span> n - p)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk12c" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk12c"><span class="highlight"><span class="nb">apply</span>/eqP; <span class="nb">move</span>: (nLp); <span class="nb">rewrite</span> -subn_eq0 =&gt; /eqP-&gt;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">m &lt; n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nLp</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt;= p</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">m - p == (<span class="kr">if</span> m - p &lt; <span class="mi">0</span> <span class="kr">then</span> m - p <span class="kr">else</span> <span class="mi">0</span>)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> ltnNge //= subn_eq0 (leq_trans (ltnW mLn)).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk12d" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk12d"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">subn_maxr</span> : left_distributive subn maxn.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">left_distributive subn maxn</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk12e" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk12e"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">left_distributive subn maxn</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk12f" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk12f"><span class="highlight"><span class="nb">move</span>=&gt; m n p; <span class="nb">rewrite</span> /maxn; <span class="nb">case</span>: leqP =&gt; [nLm|mLn].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nLm</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt;= m</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">m - p = (<span class="kr">if</span> m - p &lt; n - p <span class="kr">then</span> n - p <span class="kr">else</span> m - p)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk130" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">m &lt; n</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk130"><hr></label><div class="goal-conclusion"><span class="highlight">n - p = (<span class="kr">if</span> m - p &lt; n - p <span class="kr">then</span> n - p <span class="kr">else</span> m - p)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk131" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk131"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> ltnNge leq_sub2r.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">m &lt; n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">n - p = (<span class="kr">if</span> m - p &lt; n - p <span class="kr">then</span> n - p <span class="kr">else</span> m - p)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk132" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk132"><span class="highlight"><span class="nb">have</span> [nLp|pLn] := leqP n p; <span class="nb">last</span> <span class="bp">by</span> <span class="nb">rewrite</span> ltn_sub2r.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">m &lt; n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nLp</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt;= p</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">n - p = (<span class="kr">if</span> m - p &lt; n - p <span class="kr">then</span> n - p <span class="kr">else</span> m - p)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk133" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk133"><span class="highlight"><span class="nb">apply</span>/eqP; <span class="nb">move</span>: (nLp); <span class="nb">rewrite</span> -subn_eq0 =&gt; /eqP-&gt;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">m &lt; n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">nLp</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">n &lt;= p</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="mi">0</span> == (<span class="kr">if</span> m - p &lt; <span class="mi">0</span> <span class="kr">then</span> <span class="mi">0</span> <span class="kr">else</span> m - p)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> ltnNge //= eq_sym subn_eq0 (leq_trans (ltnW mLn)).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk134" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk134"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">leq_minn2r</span> <span class="nv">m</span> <span class="nv">n</span> <span class="nv">p</span> : m &lt;= n -&gt; minn m p &lt;= minn n p.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">m &lt;= n -&gt; minn m p &lt;= minn n p</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk135" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk135"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">m &lt;= n -&gt; minn m p &lt;= minn n p</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk136" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk136"><span class="highlight"><span class="nb">move</span>=&gt; mLn; <span class="nb">rewrite</span> /minn.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">m &lt;= n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">if</span> m &lt; p <span class="kr">then</span> m <span class="kr">else</span> p) &lt;= (<span class="kr">if</span> n &lt; p <span class="kr">then</span> n <span class="kr">else</span> p)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk137" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk137"><span class="highlight"><span class="nb">case</span>: leqP =&gt; pLm; <span class="nb">case</span>: leqP =&gt; //.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">m &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">pLm</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt;= m</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">n &lt; p -&gt; p &lt;= n</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk138" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">m &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">pLm</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">m &lt; p</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk138"><hr></label><div class="goal-conclusion"><span class="highlight">p &lt;= n -&gt; m &lt;= p</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk139" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk139"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> ltnNge (leq_trans pLm).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">m &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">pLm</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">m &lt; p</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">p &lt;= n -&gt; m &lt;= p</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">move</span>=&gt; _; <span class="nb">rewrite</span> ltnW.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk13a" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk13a"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">leq_minn2l</span> <span class="nv">m</span> <span class="nv">n</span> <span class="nv">p</span> : m &lt;= n -&gt; minn p m &lt;= minn p n.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">m &lt;= n -&gt; minn p m &lt;= minn p n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk13b" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk13b"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">m &lt;= n -&gt; minn p m &lt;= minn p n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk13c" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk13c"><span class="highlight"><span class="nb">move</span>=&gt; mLn; <span class="nb">rewrite</span> /minn.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">m &lt;= n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">if</span> p &lt; m <span class="kr">then</span> p <span class="kr">else</span> m) &lt;= (<span class="kr">if</span> p &lt; n <span class="kr">then</span> p <span class="kr">else</span> n)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk13d" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk13d"><span class="highlight"><span class="nb">case</span>: leqP =&gt; pLm; <span class="nb">case</span>: leqP =&gt; //.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">m, n, p</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">m &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">pLm</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">p &lt; m</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">n &lt;= p -&gt; p &lt;= n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">move</span>=&gt; _; <span class="nb">rewrite</span> (leq_trans (ltnW pLm)).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="sd">(******************************************************************************)</span>
<span class="c">(* Definiion of discrete convex and concave version                           *)</span>
<span class="c">(*  it contains just what is needed for shanoi4                               *)</span>
<span class="sd">(******************************************************************************)</span>

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Section</span> <span class="nf">Convex</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">increasing</span> (<span class="nv">f</span> : nat -&gt; nat) := <span class="kr">forall</span> <span class="nv">n</span>, f n &lt;= f n.+<span class="mi">1</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">decreasing</span> (<span class="nv">f</span> : nat -&gt; nat) := <span class="kr">forall</span> <span class="nv">n</span>, f n.+<span class="mi">1</span> &lt;= f n.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk13e" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk13e"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">increasing_ext</span> <span class="nv">f1</span> <span class="nv">f2</span> : f1 =<span class="mi">1</span> f2 -&gt; increasing f1 -&gt; increasing f2.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f1, f2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f1 =<span class="mi">1</span> f2 -&gt; increasing f1 -&gt; increasing f2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk13f" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk13f"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f1, f2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f1 =<span class="mi">1</span> f2 -&gt; increasing f1 -&gt; increasing f2</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">move</span>=&gt; fE fI i; <span class="nb">rewrite</span> -!fE.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk140" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk140"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">increasingE</span> <span class="nv">f</span> <span class="nv">m</span> <span class="nv">n</span> : increasing f -&gt; m &lt;= n -&gt; f m &lt;= f n.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">increasing f -&gt; m &lt;= n -&gt; f m &lt;= f n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk141" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk141"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">increasing f -&gt; m &lt;= n -&gt; f m &lt;= f n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk142" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk142"><span class="highlight"><span class="nb">move</span>=&gt; fI mLn; <span class="nb">rewrite</span> -(subnK mLn).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">m &lt;= n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f m &lt;= f (n - m + m)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk143" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk143"><span class="highlight"><span class="nb">elim</span>: (_ - _) =&gt; //= d fL.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">m &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f m &lt;= f (d + m)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f m &lt;= f (d.+<span class="mi">1</span> + m)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">apply</span>: leq_trans (fI (d + m)).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk144" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk144"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">decreasingE</span> <span class="nv">f</span> <span class="nv">m</span> <span class="nv">n</span> : decreasing f -&gt; m &lt;= n -&gt; f n &lt;= f m.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">decreasing f -&gt; m &lt;= n -&gt; f n &lt;= f m</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk145" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk145"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">decreasing f -&gt; m &lt;= n -&gt; f n &lt;= f m</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk146" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk146"><span class="highlight"><span class="nb">move</span>=&gt; fI mLn; <span class="nb">rewrite</span> -(subnK mLn).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">decreasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">m &lt;= n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f (n - m + m) &lt;= f m</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk147" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk147"><span class="highlight"><span class="nb">elim</span>: (_ - _) =&gt; //= d fL.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">decreasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">m &lt;= n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">d</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fL</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f (d + m) &lt;= f m</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f (d.+<span class="mi">1</span> + m) &lt;= f m</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">apply</span>: leq_trans (fI _) fL.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">delta</span> (<span class="nv">f</span> : nat -&gt; nat) <span class="nv">n</span> := f n.+<span class="mi">1</span> - f n.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk148" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk148"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">delta_ext</span> <span class="nv">f1</span> <span class="nv">f2</span> : f1 =<span class="mi">1</span> f2 -&gt; delta f1 =<span class="mi">1</span> delta f2.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f1, f2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f1 =<span class="mi">1</span> f2 -&gt; delta f1 =<span class="mi">1</span> delta f2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk149" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk149"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f1, f2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f1 =<span class="mi">1</span> f2 -&gt; delta f1 =<span class="mi">1</span> delta f2</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">move</span>=&gt; fE i; <span class="nb">rewrite</span> /delta !fE.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">fnorm</span> (<span class="nv">f</span> : nat -&gt; nat) <span class="nv">n</span> := f n - f <span class="mi">0</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk14a" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk14a"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">increasing_fnorm</span> <span class="nv">f</span> : increasing f -&gt; increasing (fnorm f).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">increasing f -&gt; increasing (fnorm f)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk14b" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk14b"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">increasing f -&gt; increasing (fnorm f)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">move</span>=&gt; fI n; <span class="nb">rewrite</span> leq_sub2r.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk14c" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk14c"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">delta_fnorm</span> <span class="nv">f</span> <span class="nv">n</span> : increasing f -&gt; delta (fnorm f) n = delta f n.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">increasing f -&gt; delta (fnorm f) n = delta f n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk14d" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk14d"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">increasing f -&gt; delta (fnorm f) n = delta f n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">move</span>=&gt; fI; <span class="nb">rewrite</span> /delta /fnorm -subnDA addnC subnK // increasingE.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk14e" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk14e"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">sum_delta</span> <span class="nv">f</span> <span class="nv">n</span> : 
increasing f -&gt; fnorm f n = \sum_(i &lt; n) delta (fnorm f) i.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">increasing f -&gt;
fnorm f n = \sum_(i &lt; n) delta (fnorm f) i</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk14f" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk14f"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">increasing f -&gt;
fnorm f n = \sum_(i &lt; n) delta (fnorm f) i</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk150" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk150"><span class="highlight"><span class="nb">move</span>=&gt; iF.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">iF</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">fnorm f n = \sum_(i &lt; n) delta (fnorm f) i</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk151" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk151"><span class="highlight"><span class="nb">elim</span>: n =&gt; [|n IH]; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> [LHS]subnn big_ord0.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">iF</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">fnorm f n = \sum_(i &lt; n) delta (fnorm f) i</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">fnorm f n.+<span class="mi">1</span> = \sum_(i &lt; n.+<span class="mi">1</span>) delta (fnorm f) i</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> big_ord_recr /= -IH addnC subnK // increasing_fnorm.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* we restrict this to increasing function because of the behavior -*)</span>
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">convex</span> <span class="nv">f</span> :=
  increasing f /\ increasing (delta f).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* we restrict this to increasing function because of the behavior -*)</span>
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">concave</span> <span class="nv">f</span> :=
  increasing f /\ decreasing (delta f).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk152" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk152"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">concaveE</span> <span class="nv">f</span> : 
  increasing f -&gt; (<span class="kr">forall</span> <span class="nv">i</span>, f i + f i.+<span class="mi">2</span> &lt;= (f i.+<span class="mi">1</span>).*<span class="mi">2</span>) -&gt; concave f.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">increasing f -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : nat, f i + f i.+<span class="mi">2</span> &lt;= (f i.+<span class="mi">1</span>).*<span class="mi">2</span>) -&gt;
concave f</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk153" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk153"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">increasing f -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : nat, f i + f i.+<span class="mi">2</span> &lt;= (f i.+<span class="mi">1</span>).*<span class="mi">2</span>) -&gt;
concave f</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk154" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk154"><span class="highlight"><span class="nb">move</span>=&gt; fI fH; <span class="nb">split</span> =&gt; // i.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : nat, f i + f i.+<span class="mi">2</span> &lt;= (f i.+<span class="mi">1</span>).*<span class="mi">2</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">delta f i.+<span class="mi">1</span> &lt;= delta f i</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk155" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk155"><span class="highlight"><span class="nb">rewrite</span> /delta.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : nat, f i + f i.+<span class="mi">2</span> &lt;= (f i.+<span class="mi">1</span>).*<span class="mi">2</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f i.+<span class="mi">2</span> - f i.+<span class="mi">1</span> &lt;= f i.+<span class="mi">1</span> - f i</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk156" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk156"><span class="highlight"><span class="nb">rewrite</span> -(leq_add2r (f i.+<span class="mi">1</span> + f i)) addnA subnK // addnCA subnK //.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : nat, f i + f i.+<span class="mi">2</span> &lt;= (f i.+<span class="mi">1</span>).*<span class="mi">2</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f i.+<span class="mi">2</span> + f i &lt;= f i.+<span class="mi">1</span> + f i.+<span class="mi">1</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> addnn addnC.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk157" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk157"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">concaveEk</span> <span class="nv">f</span> <span class="nv">i</span> <span class="nv">k</span> : 
  concave f -&gt; k &lt;= i -&gt; f (i - k) + f (i + k) &lt;= (f i).*<span class="mi">2</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">concave f -&gt;
k &lt;= i -&gt; f (i - k) + f (i + k) &lt;= (f i).*<span class="mi">2</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk158" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk158"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">concave f -&gt;
k &lt;= i -&gt; f (i - k) + f (i + k) &lt;= (f i).*<span class="mi">2</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk159" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk159"><span class="highlight"><span class="nb">move</span>=&gt; [fI dfD].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dfD</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">decreasing (delta f)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">k &lt;= i -&gt; f (i - k) + f (i + k) &lt;= (f i).*<span class="mi">2</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk15a" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk15a"><span class="highlight"><span class="nb">elim</span>: k =&gt; /= [kLi|k IH kLi]; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> subn0 addn0 addnn.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dfD</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">decreasing (delta f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= i -&gt; f (i - k) + f (i + k) &lt;= (f i).*<span class="mi">2</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; i</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f (i - k.+<span class="mi">1</span>) + f (i + k.+<span class="mi">1</span>) &lt;= (f i).*<span class="mi">2</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk15b" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk15b"><span class="highlight"><span class="nb">have</span> H : i - k.+<span class="mi">1</span> &lt;= i + k.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dfD</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">decreasing (delta f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= i -&gt; f (i - k) + f (i + k) &lt;= (f i).*<span class="mi">2</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; i</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">i - k.+<span class="mi">1</span> &lt;= i + k</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk15c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dfD</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">decreasing (delta f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= i -&gt; f (i - k) + f (i + k) &lt;= (f i).*<span class="mi">2</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i - k.+<span class="mi">1</span> &lt;= i + k</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk15c"><hr></label><div class="goal-conclusion"><span class="highlight">f (i - k.+<span class="mi">1</span>) + f (i + k.+<span class="mi">1</span>) &lt;= (f i).*<span class="mi">2</span></span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk15d" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk15d"><span class="highlight"><span class="bp">by</span> <span class="nb">apply</span>: leq_trans (leq_subr _ _) (leq_addr _ _).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dfD</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">decreasing (delta f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= i -&gt; f (i - k) + f (i + k) &lt;= (f i).*<span class="mi">2</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i - k.+<span class="mi">1</span> &lt;= i + k</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f (i - k.+<span class="mi">1</span>) + f (i + k.+<span class="mi">1</span>) &lt;= (f i).*<span class="mi">2</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk15e" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk15e"><span class="highlight"><span class="nb">have</span> fk1Lfk : f (i - k.+<span class="mi">1</span>) &lt;= f (i - k).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dfD</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">decreasing (delta f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= i -&gt; f (i - k) + f (i + k) &lt;= (f i).*<span class="mi">2</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i - k.+<span class="mi">1</span> &lt;= i + k</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f (i - k.+<span class="mi">1</span>) &lt;= f (i - k)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk15f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dfD</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">decreasing (delta f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= i -&gt; f (i - k) + f (i + k) &lt;= (f i).*<span class="mi">2</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i - k.+<span class="mi">1</span> &lt;= i + k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fk1Lfk</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f (i - k.+<span class="mi">1</span>) &lt;= f (i - k)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk15f"><hr></label><div class="goal-conclusion"><span class="highlight">f (i - k.+<span class="mi">1</span>) + f (i + k.+<span class="mi">1</span>) &lt;= (f i).*<span class="mi">2</span></span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk160" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk160"><span class="highlight"><span class="bp">by</span> <span class="nb">apply</span>/(increasingE fI)/leq_sub2l.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dfD</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">decreasing (delta f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= i -&gt; f (i - k) + f (i + k) &lt;= (f i).*<span class="mi">2</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i - k.+<span class="mi">1</span> &lt;= i + k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fk1Lfk</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f (i - k.+<span class="mi">1</span>) &lt;= f (i - k)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f (i - k.+<span class="mi">1</span>) + f (i + k.+<span class="mi">1</span>) &lt;= (f i).*<span class="mi">2</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk161" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk161"><span class="highlight"><span class="nb">have</span> := leq_add (decreasingE dfD H) (IH (ltnW kLi)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dfD</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">decreasing (delta f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= i -&gt; f (i - k) + f (i + k) &lt;= (f i).*<span class="mi">2</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i - k.+<span class="mi">1</span> &lt;= i + k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fk1Lfk</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f (i - k.+<span class="mi">1</span>) &lt;= f (i - k)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">delta f (i + k) + (f (i - k) + f (i + k)) &lt;=
delta f (i - k.+<span class="mi">1</span>) + (f i).*<span class="mi">2</span> -&gt;
f (i - k.+<span class="mi">1</span>) + f (i + k.+<span class="mi">1</span>) &lt;= (f i).*<span class="mi">2</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk162" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk162"><span class="highlight"><span class="nb">rewrite</span> /delta [f (i - k) + _]addnC addnA subnK <span class="nl">?fU</span> // addnC.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dfD</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">decreasing (delta f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= i -&gt; f (i - k) + f (i + k) &lt;= (f i).*<span class="mi">2</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i - k.+<span class="mi">1</span> &lt;= i + k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fk1Lfk</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f (i - k.+<span class="mi">1</span>) &lt;= f (i - k)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f (i - k) + f (i + k).+<span class="mi">1</span> &lt;=
f (i - k.+<span class="mi">1</span>).+<span class="mi">1</span> - f (i - k.+<span class="mi">1</span>) + (f i).*<span class="mi">2</span> -&gt;
f (i - k.+<span class="mi">1</span>) + f (i + k.+<span class="mi">1</span>) &lt;= (f i).*<span class="mi">2</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk163" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk163"><span class="highlight"><span class="nb">rewrite</span> -subSn // subSS addnBAC // leq_subRL.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dfD</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">decreasing (delta f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= i -&gt; f (i - k) + f (i + k) &lt;= (f i).*<span class="mi">2</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i - k.+<span class="mi">1</span> &lt;= i + k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fk1Lfk</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f (i - k.+<span class="mi">1</span>) &lt;= f (i - k)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f (i - k.+<span class="mi">1</span>) + (f (i - k) + f (i + k).+<span class="mi">1</span>) &lt;=
f (i - k) + (f i).*<span class="mi">2</span> -&gt;
f (i - k.+<span class="mi">1</span>) + f (i + k.+<span class="mi">1</span>) &lt;= (f i).*<span class="mi">2</span></span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk164" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dfD</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">decreasing (delta f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= i -&gt; f (i - k) + f (i + k) &lt;= (f i).*<span class="mi">2</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i - k.+<span class="mi">1</span> &lt;= i + k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fk1Lfk</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f (i - k.+<span class="mi">1</span>) &lt;= f (i - k)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk164"><hr></label><div class="goal-conclusion"><span class="highlight">f (i - k.+<span class="mi">1</span>) &lt;= f (i - k) + (f i).*<span class="mi">2</span></span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk165" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk165"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> addnCA leq_add2l addnS.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dfD</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">decreasing (delta f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= i -&gt; f (i - k) + f (i + k) &lt;= (f i).*<span class="mi">2</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i - k.+<span class="mi">1</span> &lt;= i + k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fk1Lfk</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f (i - k.+<span class="mi">1</span>) &lt;= f (i - k)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f (i - k.+<span class="mi">1</span>) &lt;= f (i - k) + (f i).*<span class="mi">2</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">apply</span>: leq_trans fk1Lfk (leq_addr _ _).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk166" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk166"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">concaveEk1</span> (<span class="nv">f</span> : nat -&gt; nat) (<span class="nv">i</span> <span class="nv">k1</span> <span class="nv">k2</span> : nat) :
  concave f -&gt; f (i + k1 + k2) + f i &lt;= f (i + k2) + f (i + k1).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, k1, k2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">concave f -&gt;
f (i + k1 + k2) + f i &lt;= f (i + k2) + f (i + k1)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk167" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk167"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, k1, k2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">concave f -&gt;
f (i + k1 + k2) + f i &lt;= f (i + k2) + f (i + k1)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk168" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk168"><span class="highlight"><span class="nb">move</span>=&gt; fC; <span class="nb">have</span> [fI dfD] := fC.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, k1, k2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fC</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">concave f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dfD</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">decreasing (delta f)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f (i + k1 + k2) + f i &lt;= f (i + k2) + f (i + k1)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk169" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk169"><span class="highlight"><span class="nb">elim</span>: k2 k1 i =&gt; [k1 i|k2 IHH k1 i]; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> !addn0 addnC.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fC</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">concave f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dfD</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">decreasing (delta f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k1</span> <span class="nv">i</span> : nat, f (i + k1 + k2) + f i &lt;= f (i + k2) + f (i + k1)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k1, i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f (i + k1 + k2.+<span class="mi">1</span>) + f i &lt;= f (i + k2.+<span class="mi">1</span>) + f (i + k1)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk16a" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk16a"><span class="highlight"><span class="nb">rewrite</span> !addnS -(subnK (fI _)) -[X <span class="kr">in</span> _ &lt;= X + _](subnK (fI _)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fC</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">concave f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dfD</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">decreasing (delta f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k1</span> <span class="nv">i</span> : nat, f (i + k1 + k2) + f i &lt;= f (i + k2) + f (i + k1)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k1, i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f (i + k1 + k2).+<span class="mi">1</span> - f (i + k1 + k2) + f (i + k1 + k2) +
f i &lt;=
f (i + k2).+<span class="mi">1</span> - f (i + k2) + f (i + k2) + f (i + k1)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk16b" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk16b"><span class="highlight"><span class="nb">rewrite</span> -addnA -[X <span class="kr">in</span> _ &lt;= X]addnA leq_add //.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fC</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">concave f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dfD</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">decreasing (delta f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IHH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">k1</span> <span class="nv">i</span> : nat, f (i + k1 + k2) + f i &lt;= f (i + k2) + f (i + k1)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k1, i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f (i + k1 + k2).+<span class="mi">1</span> - f (i + k1 + k2) &lt;=
f (i + k2).+<span class="mi">1</span> - f (i + k2)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">apply</span>: (decreasingE dfD); <span class="nb">rewrite</span> addnAC leq_addr.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk16c" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk16c"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">convexE</span> <span class="nv">f</span> : 
  increasing f -&gt; (<span class="kr">forall</span> <span class="nv">i</span>, (f i.+<span class="mi">1</span>).*<span class="mi">2</span> &lt;= f i + f i.+<span class="mi">2</span>) -&gt; convex f.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">increasing f -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : nat, (f i.+<span class="mi">1</span>).*<span class="mi">2</span> &lt;= f i + f i.+<span class="mi">2</span>) -&gt;
convex f</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk16d" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk16d"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">increasing f -&gt;
(<span class="kr">forall</span> <span class="nv">i</span> : nat, (f i.+<span class="mi">1</span>).*<span class="mi">2</span> &lt;= f i + f i.+<span class="mi">2</span>) -&gt;
convex f</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk16e" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk16e"><span class="highlight"><span class="nb">move</span>=&gt; fI fH; <span class="nb">split</span> =&gt; // i.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : nat, (f i.+<span class="mi">1</span>).*<span class="mi">2</span> &lt;= f i + f i.+<span class="mi">2</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">delta f i &lt;= delta f i.+<span class="mi">1</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk16f" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk16f"><span class="highlight"><span class="nb">rewrite</span> /delta.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : nat, (f i.+<span class="mi">1</span>).*<span class="mi">2</span> &lt;= f i + f i.+<span class="mi">2</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f i.+<span class="mi">1</span> - f i &lt;= f i.+<span class="mi">2</span> - f i.+<span class="mi">1</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk170" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk170"><span class="highlight"><span class="nb">rewrite</span> -(leq_add2r (f i.+<span class="mi">1</span> + f i)) [_ + f i]addnC addnA subnK //.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : nat, (f i.+<span class="mi">1</span>).*<span class="mi">2</span> &lt;= f i + f i.+<span class="mi">2</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f i.+<span class="mi">1</span> + f i.+<span class="mi">1</span> &lt;= f i.+<span class="mi">2</span> - f i.+<span class="mi">1</span> + (f i + f i.+<span class="mi">1</span>)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> addnn [f i + _]addnC addnA subnK // addnC.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk171" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk171"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">convexEk</span> <span class="nv">f</span> <span class="nv">i</span> <span class="nv">k</span> : 
  convex f -&gt; k &lt;= i -&gt; (f i).*<span class="mi">2</span> &lt;= f (i - k) + f (i + k).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">convex f -&gt;
k &lt;= i -&gt; (f i).*<span class="mi">2</span> &lt;= f (i - k) + f (i + k)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk172" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk172"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">convex f -&gt;
k &lt;= i -&gt; (f i).*<span class="mi">2</span> &lt;= f (i - k) + f (i + k)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk173" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk173"><span class="highlight"><span class="nb">move</span>=&gt; [fI dfI].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dfI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing (delta f)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">k &lt;= i -&gt; (f i).*<span class="mi">2</span> &lt;= f (i - k) + f (i + k)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk174" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk174"><span class="highlight"><span class="nb">elim</span>: k =&gt; /= [kLi|k IH kLi]; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> subn0 addn0 addnn.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dfI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing (delta f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= i -&gt; (f i).*<span class="mi">2</span> &lt;= f (i - k) + f (i + k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; i</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(f i).*<span class="mi">2</span> &lt;= f (i - k.+<span class="mi">1</span>) + f (i + k.+<span class="mi">1</span>)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk175" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk175"><span class="highlight"><span class="nb">have</span> H : i - k.+<span class="mi">1</span> &lt;= i + k.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dfI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing (delta f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= i -&gt; (f i).*<span class="mi">2</span> &lt;= f (i - k) + f (i + k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; i</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">i - k.+<span class="mi">1</span> &lt;= i + k</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk176" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dfI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing (delta f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= i -&gt; (f i).*<span class="mi">2</span> &lt;= f (i - k) + f (i + k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i - k.+<span class="mi">1</span> &lt;= i + k</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk176"><hr></label><div class="goal-conclusion"><span class="highlight">(f i).*<span class="mi">2</span> &lt;= f (i - k.+<span class="mi">1</span>) + f (i + k.+<span class="mi">1</span>)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk177" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk177"><span class="highlight"><span class="bp">by</span> <span class="nb">apply</span>: leq_trans (leq_subr _ _) (leq_addr _ _).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dfI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing (delta f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= i -&gt; (f i).*<span class="mi">2</span> &lt;= f (i - k) + f (i + k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i - k.+<span class="mi">1</span> &lt;= i + k</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(f i).*<span class="mi">2</span> &lt;= f (i - k.+<span class="mi">1</span>) + f (i + k.+<span class="mi">1</span>)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk178" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk178"><span class="highlight"><span class="nb">have</span> fk1Lfk : f (i - k.+<span class="mi">1</span>) &lt;= f (i - k).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dfI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing (delta f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= i -&gt; (f i).*<span class="mi">2</span> &lt;= f (i - k) + f (i + k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i - k.+<span class="mi">1</span> &lt;= i + k</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f (i - k.+<span class="mi">1</span>) &lt;= f (i - k)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk179" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dfI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing (delta f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= i -&gt; (f i).*<span class="mi">2</span> &lt;= f (i - k) + f (i + k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i - k.+<span class="mi">1</span> &lt;= i + k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fk1Lfk</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f (i - k.+<span class="mi">1</span>) &lt;= f (i - k)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk179"><hr></label><div class="goal-conclusion"><span class="highlight">(f i).*<span class="mi">2</span> &lt;= f (i - k.+<span class="mi">1</span>) + f (i + k.+<span class="mi">1</span>)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk17a" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk17a"><span class="highlight"><span class="bp">by</span> <span class="nb">apply</span>/(increasingE fI)/leq_sub2l.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dfI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing (delta f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= i -&gt; (f i).*<span class="mi">2</span> &lt;= f (i - k) + f (i + k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i - k.+<span class="mi">1</span> &lt;= i + k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fk1Lfk</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f (i - k.+<span class="mi">1</span>) &lt;= f (i - k)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(f i).*<span class="mi">2</span> &lt;= f (i - k.+<span class="mi">1</span>) + f (i + k.+<span class="mi">1</span>)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk17b" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk17b"><span class="highlight"><span class="nb">have</span> := leq_add (increasingE dfI H) (IH (ltnW kLi)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dfI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing (delta f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= i -&gt; (f i).*<span class="mi">2</span> &lt;= f (i - k) + f (i + k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i - k.+<span class="mi">1</span> &lt;= i + k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fk1Lfk</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f (i - k.+<span class="mi">1</span>) &lt;= f (i - k)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">delta f (i - k.+<span class="mi">1</span>) + (f i).*<span class="mi">2</span> &lt;=
delta f (i + k) + (f (i - k) + f (i + k)) -&gt;
(f i).*<span class="mi">2</span> &lt;= f (i - k.+<span class="mi">1</span>) + f (i + k.+<span class="mi">1</span>)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk17c" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk17c"><span class="highlight"><span class="nb">rewrite</span> /delta [f (i - k) + _]addnC addnA subnK <span class="nl">?fU</span> // addnC.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dfI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing (delta f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= i -&gt; (f i).*<span class="mi">2</span> &lt;= f (i - k) + f (i + k)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i - k.+<span class="mi">1</span> &lt;= i + k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fk1Lfk</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f (i - k.+<span class="mi">1</span>) &lt;= f (i - k)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(f i).*<span class="mi">2</span> + (f (i - k.+<span class="mi">1</span>).+<span class="mi">1</span> - f (i - k.+<span class="mi">1</span>)) &lt;=
f (i + k).+<span class="mi">1</span> + f (i - k) -&gt;
(f i).*<span class="mi">2</span> &lt;= f (i - k.+<span class="mi">1</span>) + f (i + k.+<span class="mi">1</span>)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> -subSn // subSS addnS addnBA // leq_subLR addnA leq_add2r.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* Ad-hoc bigmin operator *)</span>

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Fixpoint</span> <span class="nf">bigmin</span> <span class="nv">f</span> <span class="nv">n</span> := 
 <span class="kr">if</span> n <span class="kr">is</span> n1.+<span class="mi">1</span> <span class="kr">then</span> minn (f n) (bigmin f n1)
 <span class="kr">else</span> f <span class="mi">0</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;\min_ ( i &lt;= n ) F&quot;</span> := (bigmin (<span class="kr">fun</span> <span class="nv">i</span> =&gt; F) n)
 (<span class="kn">at level</span> <span class="mi">41</span>, F <span class="kn">at level</span> <span class="mi">41</span>, i, n <span class="kn">at level</span> <span class="mi">50</span>,
  <span class="kn">format</span> <span class="s2">&quot;\min_ ( i  &lt;=  n )  F&quot;</span>).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk17d" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk17d"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">bigmin_constD</span>  <span class="nv">f</span> <span class="nv">n</span> <span class="nv">k</span> :
 \min_(i &lt;= n) (f i + k) =  (\min_(i &lt;= n) f i) + k.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">\min_(i &lt;= n) (f i + k) = \min_(i &lt;= n) f i + k</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk17e" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk17e"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">\min_(i &lt;= n) (f i + k) = \min_(i &lt;= n) f i + k</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">elim</span>: n =&gt; //=  n -&gt;; <span class="nb">rewrite</span> addn_minl.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk17f" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk17f"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">bigmin_constB</span>  <span class="nv">f</span> <span class="nv">n</span> <span class="nv">k</span> :
 \min_(i &lt;= n) (f i - k) =  (\min_(i &lt;= n) f i) - k.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">\min_(i &lt;= n) (f i - k) = \min_(i &lt;= n) f i - k</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk180" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk180"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">\min_(i &lt;= n) (f i - k) = \min_(i &lt;= n) f i - k</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">elim</span>: n =&gt; //=  n -&gt;; <span class="nb">rewrite</span> subn_minr.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk181" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk181"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">eq_bigmin</span> <span class="nv">f</span> <span class="nv">n</span> : {i0 : &#39;I_n.+<span class="mi">1</span> | \min_(i &lt;= n) f i = f i0}.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">{i0 : &#39;I_n.+<span class="mi">1</span> | \min_(i &lt;= n) f i = f i0}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk182" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk182"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">{i0 : &#39;I_n.+<span class="mi">1</span> | \min_(i &lt;= n) f i = f i0}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk183" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk183"><span class="highlight"><span class="nb">elim</span>: n =&gt; /= [|n [i -&gt;]]; <span class="kp">first</span> <span class="bp">by</span> <span class="kr">exists</span> <span class="nv">ord0</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n.+<span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">{i0 : &#39;I_n.+<span class="mi">2</span> | minn (f n.+<span class="mi">1</span>) (f i) = f i0}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk184" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk184"><span class="highlight"><span class="nb">rewrite</span> /minn; <span class="nb">case</span>: leqP =&gt; H.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n.+<span class="mi">1</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt;= f n.+<span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">{i0 : &#39;I_n.+<span class="mi">2</span> | f i = f i0}</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk185" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n.+<span class="mi">1</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f n.+<span class="mi">1</span> &lt; f i</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk185"><hr></label><div class="goal-conclusion"><span class="highlight">{i0 : &#39;I_n.+<span class="mi">2</span> | f n.+<span class="mi">1</span> = f i0}</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk186" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk186"><span class="highlight"><span class="bp">by</span> <span class="kr">exists</span> (<span class="nv">inord</span> <span class="nv">i</span>); <span class="nb">rewrite</span> inordK // (leq_trans (ltn_ord i)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n.+<span class="mi">1</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f n.+<span class="mi">1</span> &lt; f i</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">{i0 : &#39;I_n.+<span class="mi">2</span> | f n.+<span class="mi">1</span> = f i0}</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="kr">exists</span> <span class="nv">ord_max</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk187" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk187"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">bigmin_leqP</span> <span class="nv">f</span> <span class="nv">n</span> <span class="nv">m</span> :
  reflect (<span class="kr">forall</span> <span class="nv">i</span>, i &lt;= n -&gt; m &lt;= f i) 
          (m &lt;= \min_(i &lt;= n) f i).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">reflect (<span class="kr">forall</span> <span class="nv">i</span> : nat, i &lt;= n -&gt; m &lt;= f i)
  (m &lt;= \min_(i &lt;= n) f i)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk188" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk188"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">reflect (<span class="kr">forall</span> <span class="nv">i</span> : nat, i &lt;= n -&gt; m &lt;= f i)
  (m &lt;= \min_(i &lt;= n) f i)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk189" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk189"><span class="highlight"><span class="nb">elim</span>: n =&gt; /= [|n IH].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">reflect (<span class="kr">forall</span> <span class="nv">i</span> : nat, i &lt;= <span class="mi">0</span> -&gt; m &lt;= f i)
  (m &lt;= f <span class="mi">0</span>)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk18a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">reflect (<span class="kr">forall</span> <span class="nv">i</span> : nat, i &lt;= n -&gt; m &lt;= f i)
  (m &lt;= \min_(i &lt;= n) f i)</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk18a"><hr></label><div class="goal-conclusion"><span class="highlight">reflect (<span class="kr">forall</span> <span class="nv">i</span> : nat, i &lt;= n.+<span class="mi">1</span> -&gt; m &lt;= f i)
  (m &lt;= minn (f n.+<span class="mi">1</span>) (\min_(i &lt;= n) f i))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk18b" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk18b"><span class="highlight"><span class="bp">by</span> <span class="nb">apply</span>: (iffP idP) =&gt; [mLf0 [|i] //|-&gt;].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">reflect (<span class="kr">forall</span> <span class="nv">i</span> : nat, i &lt;= n -&gt; m &lt;= f i)
  (m &lt;= \min_(i &lt;= n) f i)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">reflect (<span class="kr">forall</span> <span class="nv">i</span> : nat, i &lt;= n.+<span class="mi">1</span> -&gt; m &lt;= f i)
  (m &lt;= minn (f n.+<span class="mi">1</span>) (\min_(i &lt;= n) f i))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk18c" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk18c"><span class="highlight"><span class="nb">apply</span>: (iffP idP) =&gt; [|H].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">reflect (<span class="kr">forall</span> <span class="nv">i</span> : nat, i &lt;= n -&gt; m &lt;= f i)
  (m &lt;= \min_(i &lt;= n) f i)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">m &lt;= minn (f n.+<span class="mi">1</span>) (\min_(i &lt;= n) f i) -&gt;
<span class="kr">forall</span> <span class="nv">i</span> : nat, i &lt;= n.+<span class="mi">1</span> -&gt; m &lt;= f i</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk18d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">reflect (<span class="kr">forall</span> <span class="nv">i</span> : nat, i &lt;= n -&gt; m &lt;= f i)
  (m &lt;= \min_(i &lt;= n) f i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : nat, i &lt;= n.+<span class="mi">1</span> -&gt; m &lt;= f i</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk18d"><hr></label><div class="goal-conclusion"><span class="highlight">m &lt;= minn (f n.+<span class="mi">1</span>) (\min_(i &lt;= n) f i)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk18e" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk18e"><span class="highlight"><span class="nb">rewrite</span> leq_min =&gt; /andP[mLf mLmin] i.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">reflect (<span class="kr">forall</span> <span class="nv">i</span> : nat, i &lt;= n -&gt; m &lt;= f i)
  (m &lt;= \min_(i &lt;= n) f i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mLf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">m &lt;= f n.+<span class="mi">1</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mLmin</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">m &lt;= \min_(i &lt;= n) f i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">i &lt;= n.+<span class="mi">1</span> -&gt; m &lt;= f i</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk18f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">reflect (<span class="kr">forall</span> <span class="nv">i</span> : nat, i &lt;= n -&gt; m &lt;= f i)
  (m &lt;= \min_(i &lt;= n) f i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : nat, i &lt;= n.+<span class="mi">1</span> -&gt; m &lt;= f i</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk18f"><hr></label><div class="goal-conclusion"><span class="highlight">m &lt;= minn (f n.+<span class="mi">1</span>) (\min_(i &lt;= n) f i)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk190" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk190"><span class="highlight"><span class="nb">case</span>: ltngtP =&gt; // [iLn _|-&gt; _ //].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">reflect (<span class="kr">forall</span> <span class="nv">i</span> : nat, i &lt;= n -&gt; m &lt;= f i)
  (m &lt;= \min_(i &lt;= n) f i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mLf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">m &lt;= f n.+<span class="mi">1</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">mLmin</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">m &lt;= \min_(i &lt;= n) f i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">iLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i &lt; n.+<span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">m &lt;= f i</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk191" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">reflect (<span class="kr">forall</span> <span class="nv">i</span> : nat, i &lt;= n -&gt; m &lt;= f i)
  (m &lt;= \min_(i &lt;= n) f i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : nat, i &lt;= n.+<span class="mi">1</span> -&gt; m &lt;= f i</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk191"><hr></label><div class="goal-conclusion"><span class="highlight">m &lt;= minn (f n.+<span class="mi">1</span>) (\min_(i &lt;= n) f i)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk192" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk192"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> ltnS <span class="kr">in</span> iLn; <span class="nb">move</span>: i iLn; <span class="nb">apply</span>/IH.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">reflect (<span class="kr">forall</span> <span class="nv">i</span> : nat, i &lt;= n -&gt; m &lt;= f i)
  (m &lt;= \min_(i &lt;= n) f i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : nat, i &lt;= n.+<span class="mi">1</span> -&gt; m &lt;= f i</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">m &lt;= minn (f n.+<span class="mi">1</span>) (\min_(i &lt;= n) f i)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk193" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk193"><span class="highlight"><span class="nb">rewrite</span> leq_min H //=.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">reflect (<span class="kr">forall</span> <span class="nv">i</span> : nat, i &lt;= n -&gt; m &lt;= f i)
  (m &lt;= \min_(i &lt;= n) f i)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : nat, i &lt;= n.+<span class="mi">1</span> -&gt; m &lt;= f i</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">m &lt;= \min_(i &lt;= n) f i</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">apply</span>/IH =&gt; i iLn; <span class="nb">rewrite</span> H // (leq_trans iLn).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk194" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk194"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">bigmin_inf</span> <span class="nv">f</span> <span class="nv">n</span> <span class="nv">i0</span> <span class="nv">m</span> :
  i0 &lt;= n -&gt; f i0 &lt;= m -&gt; \min_(i &lt;= n) f i &lt;= m.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, i0, m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">i0 &lt;= n -&gt; f i0 &lt;= m -&gt; \min_(i &lt;= n) f i &lt;= m</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk195" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk195"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, i0, m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">i0 &lt;= n -&gt; f i0 &lt;= m -&gt; \min_(i &lt;= n) f i &lt;= m</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk196" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk196"><span class="highlight"><span class="nb">move</span>=&gt; i0Ln fi0Lm; <span class="nb">apply</span>: leq_trans fi0Lm.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, i0, m</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i0Ln</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i0 &lt;= n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">\min_(i &lt;= n) f i &lt;= f i0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk197" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk197"><span class="highlight"><span class="nb">elim</span>: n i0Ln =&gt; /= [|n IH]; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">case</span>: i0.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i0, m, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i0 &lt;= n -&gt; \min_(i &lt;= n) f i &lt;= f i0</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">i0 &lt;= n.+<span class="mi">1</span> -&gt;
minn (f n.+<span class="mi">1</span>) (\min_(i &lt;= n) f i) &lt;= f i0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">case</span>: ltngtP =&gt; // [i0Ln _| -&gt; _]; <span class="nb">rewrite</span> geq_min <span class="nl">?leqnn</span> <span class="nl">?IH</span> <span class="nl">?orbT</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk198" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk198"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">bigmin_fnorm</span> <span class="nv">f</span> <span class="nv">n</span> : \min_(i &lt;= n) fnorm f i = fnorm (bigmin f) n.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">\min_(i &lt;= n) fnorm f i = fnorm (bigmin f) n</span></div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk199" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk199"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">\min_(i &lt;= n) fnorm f i = fnorm (bigmin f) n</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">elim</span>: n =&gt; //= n -&gt;; <span class="nb">rewrite</span> -subn_minr.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk19a" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk19a"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">bigmin_ext</span> <span class="nv">f1</span> <span class="nv">f2</span> <span class="nv">n</span> : 
  (<span class="kr">forall</span> <span class="nv">i</span>, i &lt;= n -&gt; f1 i = f2 i) -&gt; \min_(i &lt;= n) f1 i = \min_(i &lt;= n) f2 i.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f1, f2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">forall</span> <span class="nv">i</span> : nat, i &lt;= n -&gt; f1 i = f2 i) -&gt;
\min_(i &lt;= n) f1 i = \min_(i &lt;= n) f2 i</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk19b" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk19b"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f1, f2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">forall</span> <span class="nv">i</span> : nat, i &lt;= n -&gt; f1 i = f2 i) -&gt;
\min_(i &lt;= n) f1 i = \min_(i &lt;= n) f2 i</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk19c" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk19c"><span class="highlight"><span class="nb">elim</span>: n =&gt; /= [-&gt;//|n IH H].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f1, f2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">(<span class="kr">forall</span> <span class="nv">i</span> : nat, i &lt;= n -&gt; f1 i = f2 i) -&gt;
\min_(i &lt;= n) f1 i = \min_(i &lt;= n) f2 i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">H</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> : nat, i &lt;= n.+<span class="mi">1</span> -&gt; f1 i = f2 i</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">minn (f1 n.+<span class="mi">1</span>) (\min_(i &lt;= n) f1 i) =
minn (f2 n.+<span class="mi">1</span>) (\min_(i &lt;= n) f2 i)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> H // IH // =&gt; i iH; <span class="nb">rewrite</span> H // (leq_trans iH).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk19d" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk19d"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">bigminMr</span>  <span class="nv">f</span> <span class="nv">n</span> <span class="nv">k</span> :
 \min_(i &lt;= n) (f i * k) =  (\min_(i &lt;= n) f i) * k.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">\min_(i &lt;= n) f i * k = (\min_(i &lt;= n) f i) * k</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk19e" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk19e"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">\min_(i &lt;= n) f i * k = (\min_(i &lt;= n) f i) * k</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">elim</span>: n =&gt; //= n -&gt;; <span class="nb">rewrite</span>  minnMl.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* Convolution *)</span>

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">conv</span> (<span class="nv">f</span> <span class="nv">g</span> : nat -&gt; nat) <span class="nv">n</span> :=
  \min_(i &lt;= n) (f i + g (n - i)).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk19f" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk19f"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">conv0</span> <span class="nv">f</span> <span class="nv">g</span> : conv f g <span class="mi">0</span> = f <span class="mi">0</span> + g <span class="mi">0</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">conv f g <span class="mi">0</span> = f <span class="mi">0</span> + g <span class="mi">0</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1a0" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1a0"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">conv f g <span class="mi">0</span> = f <span class="mi">0</span> + g <span class="mi">0</span></span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> [].</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1a1" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1a1"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">conv1</span> <span class="nv">f</span> <span class="nv">g</span> : 
  conv f g <span class="mi">1</span> = minn (f <span class="mi">1</span> + g <span class="mi">0</span>) (f <span class="mi">0</span> + g <span class="mi">1</span>).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">conv f g <span class="mi">1</span> = minn (f <span class="mi">1</span> + g <span class="mi">0</span>) (f <span class="mi">0</span> + g <span class="mi">1</span>)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1a2" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1a2"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">conv f g <span class="mi">1</span> = minn (f <span class="mi">1</span> + g <span class="mi">0</span>) (f <span class="mi">0</span> + g <span class="mi">1</span>)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> [].</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1a3" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1a3"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">conv_fnorm</span> <span class="nv">f</span> <span class="nv">g</span> : 
  increasing f -&gt; increasing g -&gt; 
  conv (fnorm f) (fnorm g) =<span class="mi">1</span> fnorm (conv f g).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">increasing f -&gt;
increasing g -&gt;
conv (fnorm f) (fnorm g) =<span class="mi">1</span> fnorm (conv f g)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1a4" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1a4"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">increasing f -&gt;
increasing g -&gt;
conv (fnorm f) (fnorm g) =<span class="mi">1</span> fnorm (conv f g)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1a5" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1a5"><span class="highlight"><span class="nb">move</span>=&gt; fI gI i.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">conv (fnorm f) (fnorm g) i = fnorm (conv f g) i</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1a6" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1a6"><span class="highlight"><span class="nb">rewrite</span> /fnorm /conv /= -bigmin_constB subnn.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">\min_(i0 &lt;= i) (f i0 - f <span class="mi">0</span> + (g (i - i0) - g <span class="mi">0</span>)) =
\min_(i0 &lt;= i) (f i0 + g (i - i0) - (f <span class="mi">0</span> + g <span class="mi">0</span>))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1a7" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1a7"><span class="highlight"><span class="nb">apply</span>: bigmin_ext =&gt; j.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">j &lt;= i -&gt;
f j - f <span class="mi">0</span> + (g (i - j) - g <span class="mi">0</span>) =
f j + g (i - j) - (f <span class="mi">0</span> + g <span class="mi">0</span>)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> addnBA <span class="nl">?increasingE</span> // addnBAC <span class="nl">?increasingE</span> // subnDA.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1a8" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1a8"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">conv_ext</span> <span class="nv">f1</span> <span class="nv">g1</span> <span class="nv">f2</span> <span class="nv">g2</span> : f1 =<span class="mi">1</span> f2 -&gt; g1 =<span class="mi">1</span> g2 -&gt; conv f1 g1 =<span class="mi">1</span> conv f2 g2.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f1, g1, f2, g2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f1 =<span class="mi">1</span> f2 -&gt; g1 =<span class="mi">1</span> g2 -&gt; conv f1 g1 =<span class="mi">1</span> conv f2 g2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1a9" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1a9"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f1, g1, f2, g2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f1 =<span class="mi">1</span> f2 -&gt; g1 =<span class="mi">1</span> g2 -&gt; conv f1 g1 =<span class="mi">1</span> conv f2 g2</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">move</span>=&gt; fE gE i; <span class="nb">apply</span>: bigmin_ext =&gt; j; <span class="nb">rewrite</span> fE gE.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1aa" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1aa"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">convC</span> <span class="nv">f</span> <span class="nv">g</span> : conv f g =<span class="mi">1</span> conv g f.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">conv f g =<span class="mi">1</span> conv g f</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1ab" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1ab"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">conv f g =<span class="mi">1</span> conv g f</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1ac" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1ac"><span class="highlight"><span class="nb">move</span>=&gt; n; <span class="nb">apply</span>/eqP; <span class="nb">rewrite</span> /conv eqn_leq; <span class="nb">apply</span>/andP; <span class="nb">split</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">\min_(i &lt;= n) (f i + g (n - i)) &lt;=
\min_(i &lt;= n) (g i + f (n - i))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk1ad" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk1ad"><hr></label><div class="goal-conclusion"><span class="highlight">\min_(i &lt;= n) (g i + f (n - i)) &lt;=
\min_(i &lt;= n) (f i + g (n - i))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1ae" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1ae"><span class="highlight"><span class="nb">apply</span>/bigmin_leqP =&gt; i iLn.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">iLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i &lt;= n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">\min_(i &lt;= n) (f i + g (n - i)) &lt;= g i + f (n - i)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk1af" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk1af"><hr></label><div class="goal-conclusion"><span class="highlight">\min_(i &lt;= n) (g i + f (n - i)) &lt;=
\min_(i &lt;= n) (f i + g (n - i))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1b0" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1b0"><span class="highlight"><span class="nb">rewrite</span> -{<span class="mi">1</span>}(subKn iLn) addnC.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">iLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i &lt;= n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">\min_(i &lt;= n) (f i + g (n - i)) &lt;=
f (n - i) + g (n - (n - i))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk1b1" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk1b1"><hr></label><div class="goal-conclusion"><span class="highlight">\min_(i &lt;= n) (g i + f (n - i)) &lt;=
\min_(i &lt;= n) (f i + g (n - i))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1b2" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1b2"><span class="highlight"><span class="bp">by</span> <span class="nb">apply</span>: bigmin_inf (leq_subr _ _) (leqnn _).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">\min_(i &lt;= n) (g i + f (n - i)) &lt;=
\min_(i &lt;= n) (f i + g (n - i))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1b3" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1b3"><span class="highlight"><span class="nb">apply</span>/bigmin_leqP =&gt; i iLn.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">iLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i &lt;= n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">\min_(i &lt;= n) (g i + f (n - i)) &lt;= f i + g (n - i)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1b4" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1b4"><span class="highlight"><span class="nb">rewrite</span> -{<span class="mi">1</span>}(subKn iLn) addnC.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">iLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i &lt;= n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">\min_(i &lt;= n) (g i + f (n - i)) &lt;=
g (n - i) + f (n - (n - i))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">apply</span>: bigmin_inf (leq_subr _ _) (leqnn _).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1b5" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1b5"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">increasing_conv</span> <span class="nv">f</span> <span class="nv">g</span> : 
  increasing f -&gt; increasing g -&gt; increasing (conv f g).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">increasing f -&gt; increasing g -&gt; increasing (conv f g)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1b6" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1b6"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">increasing f -&gt; increasing g -&gt; increasing (conv f g)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1b7" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1b7"><span class="highlight"><span class="nb">move</span>=&gt; fI gI i.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">conv f g i &lt;= conv f g i.+<span class="mi">1</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1b8" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1b8"><span class="highlight"><span class="nb">apply</span>/bigmin_leqP =&gt; j.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">j &lt;= i.+<span class="mi">1</span> -&gt; conv f g i &lt;= f j + g (i.+<span class="mi">1</span> - j)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1b9" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1b9"><span class="highlight"><span class="nb">case</span>: ltngtP =&gt; // [jLi | -&gt;] _.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">jLi</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">j &lt; i.+<span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">conv f g i &lt;= f j + g (i.+<span class="mi">1</span> - j)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk1ba" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk1ba"><hr></label><div class="goal-conclusion"><span class="highlight">conv f g i &lt;= f i.+<span class="mi">1</span> + g (i.+<span class="mi">1</span> - i.+<span class="mi">1</span>)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1bb" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1bb"><span class="highlight"><span class="bp">by</span> <span class="nb">apply</span>: bigmin_inf (_ : j &lt;= i) _; <span class="nb">rewrite</span> // leq_add2l subSn.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">conv f g i &lt;= f i.+<span class="mi">1</span> + g (i.+<span class="mi">1</span> - i.+<span class="mi">1</span>)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1bc" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1bc"><span class="highlight"><span class="nb">rewrite</span> subnn.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">conv f g i &lt;= f i.+<span class="mi">1</span> + g <span class="mi">0</span></span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">apply</span>: bigmin_inf (leqnn i) _; <span class="nb">rewrite</span> subnn leq_add2r.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* merging increasing functions *)</span>

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Fixpoint</span> <span class="nf">fmerge_aux</span> (<span class="nv">f</span> <span class="nv">g</span> : nat -&gt; nat) <span class="nv">i</span> <span class="nv">j</span> <span class="nv">n</span> := 
 <span class="kr">if</span> n <span class="kr">is</span> n1.+<span class="mi">1</span> <span class="kr">then</span>
   <span class="kr">if</span> f i &lt; g j <span class="kr">then</span> fmerge_aux f g i.+<span class="mi">1</span> j n1 
   <span class="kr">else</span> fmerge_aux f g i j.+<span class="mi">1</span> n1
 <span class="kr">else</span> minn (f i) (g j).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">fmerge</span> <span class="nv">f</span> <span class="nv">g</span> <span class="nv">n</span> := fmerge_aux f g <span class="mi">0</span> <span class="mi">0</span> n.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1bd" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1bd"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">fmerge_aux_ext</span> <span class="nv">f1</span> <span class="nv">f2</span> <span class="nv">g1</span> <span class="nv">g2</span> <span class="nv">i</span> <span class="nv">j</span> : f1 =<span class="mi">1</span> f2 -&gt; g1 =<span class="mi">1</span> g2 -&gt; 
  fmerge_aux f1 g1 i j =<span class="mi">1</span> fmerge_aux f2 g2 i j.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f1, f2, g1, g2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f1 =<span class="mi">1</span> f2 -&gt;
g1 =<span class="mi">1</span> g2 -&gt;
fmerge_aux f1 g1 i j =<span class="mi">1</span> fmerge_aux f2 g2 i j</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1be" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1be"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f1, f2, g1, g2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f1 =<span class="mi">1</span> f2 -&gt;
g1 =<span class="mi">1</span> g2 -&gt;
fmerge_aux f1 g1 i j =<span class="mi">1</span> fmerge_aux f2 g2 i j</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1bf" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1bf"><span class="highlight"><span class="nb">move</span>=&gt; fE gE n; <span class="nb">elim</span>: n i j =&gt; /= [i1 j1|n IH i j]; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> fE gE.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f1, f2, g1, g2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fE</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f1 =<span class="mi">1</span> f2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gE</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g1 =<span class="mi">1</span> g2</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> : nat,
fmerge_aux f1 g1 i j n = fmerge_aux f2 g2 i j n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">if</span> f1 i &lt; g1 j
 <span class="kr">then</span> fmerge_aux f1 g1 i.+<span class="mi">1</span> j n
 <span class="kr">else</span> fmerge_aux f1 g1 i j.+<span class="mi">1</span> n) =
(<span class="kr">if</span> f2 i &lt; g2 j
 <span class="kr">then</span> fmerge_aux f2 g2 i.+<span class="mi">1</span> j n
 <span class="kr">else</span> fmerge_aux f2 g2 i j.+<span class="mi">1</span> n)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> !(fE, gE, IH).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1c0" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1c0"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">fmerge_ext</span> <span class="nv">f1</span> <span class="nv">f2</span> <span class="nv">g1</span> <span class="nv">g2</span> : f1 =<span class="mi">1</span> f2 -&gt; g1 =<span class="mi">1</span> g2 -&gt; 
  fmerge f1 g1 =<span class="mi">1</span> fmerge f2 g2.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f1, f2, g1, g2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f1 =<span class="mi">1</span> f2 -&gt; g1 =<span class="mi">1</span> g2 -&gt; fmerge f1 g1 =<span class="mi">1</span> fmerge f2 g2</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1c1" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1c1"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f1, f2, g1, g2</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f1 =<span class="mi">1</span> f2 -&gt; g1 =<span class="mi">1</span> g2 -&gt; fmerge f1 g1 =<span class="mi">1</span> fmerge f2 g2</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">move</span>=&gt; fE gE n; <span class="nb">apply</span>: fmerge_aux_ext.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1c2" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1c2"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">fmerge_aux_correct</span> <span class="nv">f</span> <span class="nv">g</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">n</span> :
  increasing f -&gt; increasing g -&gt; 
  (<span class="kr">forall</span> <span class="nv">k</span>, k &lt;= n -&gt;  
     minn (f (i + k)) (g (j + (n - k))) &lt;=  
     fmerge_aux f g i j n).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">increasing f -&gt;
increasing g -&gt;
<span class="kr">forall</span> <span class="nv">k</span> : nat,
k &lt;= n -&gt;
minn (f (i + k)) (g (j + (n - k))) &lt;=
fmerge_aux f g i j n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1c3" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1c3"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">increasing f -&gt;
increasing g -&gt;
<span class="kr">forall</span> <span class="nv">k</span> : nat,
k &lt;= n -&gt;
minn (f (i + k)) (g (j + (n - k))) &lt;=
fmerge_aux f g i j n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1c4" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1c4"><span class="highlight"><span class="nb">move</span>=&gt; fI gI.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">k</span> : nat,
k &lt;= n -&gt;
minn (f (i + k)) (g (j + (n - k))) &lt;=
fmerge_aux f g i j n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1c5" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1c5"><span class="highlight"><span class="nb">elim</span>: n i j =&gt; /= [i j [|] // _|n IH i j k kLn].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">minn (f (i + <span class="mi">0</span>)) (g (j + (<span class="mi">0</span> - <span class="mi">0</span>))) &lt;= minn (f i) (g j)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk1c6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n -&gt;
minn (f (i + k)) (g (j + (n - k))) &lt;=
fmerge_aux f g i j n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n.+<span class="mi">1</span></span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk1c6"><hr></label><div class="goal-conclusion"><span class="highlight">minn (f (i + k)) (g (j + (n.+<span class="mi">1</span> - k))) &lt;=
(<span class="kr">if</span> f i &lt; g j
 <span class="kr">then</span> fmerge_aux f g i.+<span class="mi">1</span> j n
 <span class="kr">else</span> fmerge_aux f g i j.+<span class="mi">1</span> n)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1c7" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1c7"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> !addn0.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n -&gt;
minn (f (i + k)) (g (j + (n - k))) &lt;=
fmerge_aux f g i j n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n.+<span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">minn (f (i + k)) (g (j + (n.+<span class="mi">1</span> - k))) &lt;=
(<span class="kr">if</span> f i &lt; g j
 <span class="kr">then</span> fmerge_aux f g i.+<span class="mi">1</span> j n
 <span class="kr">else</span> fmerge_aux f g i j.+<span class="mi">1</span> n)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1c8" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1c8"><span class="highlight"><span class="nb">case</span>: leqP =&gt; [gLf|fLg].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n -&gt;
minn (f (i + k)) (g (j + (n - k))) &lt;=
fmerge_aux f g i j n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n.+<span class="mi">1</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gLf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g j &lt;= f i</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">minn (f (i + k)) (g (j + (n.+<span class="mi">1</span> - k))) &lt;=
fmerge_aux f g i j.+<span class="mi">1</span> n</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk1c9" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n -&gt;
minn (f (i + k)) (g (j + (n - k))) &lt;=
fmerge_aux f g i j n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n.+<span class="mi">1</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk1c9"><hr></label><div class="goal-conclusion"><span class="highlight">minn (f (i + k)) (g (j + (n.+<span class="mi">1</span> - k))) &lt;=
fmerge_aux f g i.+<span class="mi">1</span> j n</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1ca" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1ca"><span class="highlight"><span class="nb">move</span>: kLn; <span class="nb">rewrite</span> leq_eqVlt =&gt; /orP[/eqP-&gt;|kLn].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n -&gt;
minn (f (i + k)) (g (j + (n - k))) &lt;=
fmerge_aux f g i j n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gLf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g j &lt;= f i</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">minn (f (i + n.+<span class="mi">1</span>)) (g (j + (n.+<span class="mi">1</span> - n.+<span class="mi">1</span>))) &lt;=
fmerge_aux f g i j.+<span class="mi">1</span> n</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk1cb" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n -&gt;
minn (f (i + k)) (g (j + (n - k))) &lt;=
fmerge_aux f g i j n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gLf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g j &lt;= f i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n.+<span class="mi">1</span></span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk1cb"><hr></label><div class="goal-conclusion"><span class="highlight">minn (f (i + k)) (g (j + (n.+<span class="mi">1</span> - k))) &lt;=
fmerge_aux f g i j.+<span class="mi">1</span> n</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="extra-v-chk1cc" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n -&gt;
minn (f (i + k)) (g (j + (n - k))) &lt;=
fmerge_aux f g i j n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n.+<span class="mi">1</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk1cc"><hr></label><div class="goal-conclusion"><span class="highlight">minn (f (i + k)) (g (j + (n.+<span class="mi">1</span> - k))) &lt;=
fmerge_aux f g i.+<span class="mi">1</span> j n</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1cd" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1cd"><span class="highlight"><span class="nb">rewrite</span> subnn addn0 (minn_idPr _); <span class="nb">last first</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n -&gt;
minn (f (i + k)) (g (j + (n - k))) &lt;=
fmerge_aux f g i j n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gLf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g j &lt;= f i</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">g j &lt;= f (i + n.+<span class="mi">1</span>)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk1ce" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n -&gt;
minn (f (i + k)) (g (j + (n - k))) &lt;=
fmerge_aux f g i j n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gLf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g j &lt;= f i</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk1ce"><hr></label><div class="goal-conclusion"><span class="highlight">g j &lt;= fmerge_aux f g i j.+<span class="mi">1</span> n</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="extra-v-chk1cf" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n -&gt;
minn (f (i + k)) (g (j + (n - k))) &lt;=
fmerge_aux f g i j n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gLf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g j &lt;= f i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n.+<span class="mi">1</span></span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk1cf"><hr></label><div class="goal-conclusion"><span class="highlight">minn (f (i + k)) (g (j + (n.+<span class="mi">1</span> - k))) &lt;=
fmerge_aux f g i j.+<span class="mi">1</span> n</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="extra-v-chk1d0" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n -&gt;
minn (f (i + k)) (g (j + (n - k))) &lt;=
fmerge_aux f g i j n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n.+<span class="mi">1</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk1d0"><hr></label><div class="goal-conclusion"><span class="highlight">minn (f (i + k)) (g (j + (n.+<span class="mi">1</span> - k))) &lt;=
fmerge_aux f g i.+<span class="mi">1</span> j n</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">      </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1d1" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1d1"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> (leq_trans gLf) // increasingE // leq_addr.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n -&gt;
minn (f (i + k)) (g (j + (n - k))) &lt;=
fmerge_aux f g i j n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gLf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g j &lt;= f i</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">g j &lt;= fmerge_aux f g i j.+<span class="mi">1</span> n</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk1d2" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n -&gt;
minn (f (i + k)) (g (j + (n - k))) &lt;=
fmerge_aux f g i j n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gLf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g j &lt;= f i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n.+<span class="mi">1</span></span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk1d2"><hr></label><div class="goal-conclusion"><span class="highlight">minn (f (i + k)) (g (j + (n.+<span class="mi">1</span> - k))) &lt;=
fmerge_aux f g i j.+<span class="mi">1</span> n</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="extra-v-chk1d3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n -&gt;
minn (f (i + k)) (g (j + (n - k))) &lt;=
fmerge_aux f g i j n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n.+<span class="mi">1</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk1d3"><hr></label><div class="goal-conclusion"><span class="highlight">minn (f (i + k)) (g (j + (n.+<span class="mi">1</span> - k))) &lt;=
fmerge_aux f g i.+<span class="mi">1</span> j n</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1d4" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1d4"><span class="highlight"><span class="nb">apply</span>: leq_trans (IH _ _ _ (leqnn _)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n -&gt;
minn (f (i + k)) (g (j + (n - k))) &lt;=
fmerge_aux f g i j n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gLf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g j &lt;= f i</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">g j &lt;= minn (f (i + n)) (g (j.+<span class="mi">1</span> + (n - n)))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk1d5" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n -&gt;
minn (f (i + k)) (g (j + (n - k))) &lt;=
fmerge_aux f g i j n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gLf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g j &lt;= f i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n.+<span class="mi">1</span></span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk1d5"><hr></label><div class="goal-conclusion"><span class="highlight">minn (f (i + k)) (g (j + (n.+<span class="mi">1</span> - k))) &lt;=
fmerge_aux f g i j.+<span class="mi">1</span> n</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="extra-v-chk1d6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n -&gt;
minn (f (i + k)) (g (j + (n - k))) &lt;=
fmerge_aux f g i j n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n.+<span class="mi">1</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk1d6"><hr></label><div class="goal-conclusion"><span class="highlight">minn (f (i + k)) (g (j + (n.+<span class="mi">1</span> - k))) &lt;=
fmerge_aux f g i.+<span class="mi">1</span> j n</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1d7" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1d7"><span class="highlight"><span class="nb">rewrite</span> subnn addn0 leq_min increasingE // andbT (leq_trans gLf) //.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n -&gt;
minn (f (i + k)) (g (j + (n - k))) &lt;=
fmerge_aux f g i j n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gLf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g j &lt;= f i</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f i &lt;= f (i + n)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk1d8" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n -&gt;
minn (f (i + k)) (g (j + (n - k))) &lt;=
fmerge_aux f g i j n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gLf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g j &lt;= f i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n.+<span class="mi">1</span></span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk1d8"><hr></label><div class="goal-conclusion"><span class="highlight">minn (f (i + k)) (g (j + (n.+<span class="mi">1</span> - k))) &lt;=
fmerge_aux f g i j.+<span class="mi">1</span> n</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="extra-v-chk1d9" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n -&gt;
minn (f (i + k)) (g (j + (n - k))) &lt;=
fmerge_aux f g i j n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n.+<span class="mi">1</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk1d9"><hr></label><div class="goal-conclusion"><span class="highlight">minn (f (i + k)) (g (j + (n.+<span class="mi">1</span> - k))) &lt;=
fmerge_aux f g i.+<span class="mi">1</span> j n</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1da" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1da"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> increasingE // leq_addr.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n -&gt;
minn (f (i + k)) (g (j + (n - k))) &lt;=
fmerge_aux f g i j n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gLf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g j &lt;= f i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n.+<span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">minn (f (i + k)) (g (j + (n.+<span class="mi">1</span> - k))) &lt;=
fmerge_aux f g i j.+<span class="mi">1</span> n</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk1db" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n -&gt;
minn (f (i + k)) (g (j + (n - k))) &lt;=
fmerge_aux f g i j n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n.+<span class="mi">1</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk1db"><hr></label><div class="goal-conclusion"><span class="highlight">minn (f (i + k)) (g (j + (n.+<span class="mi">1</span> - k))) &lt;=
fmerge_aux f g i.+<span class="mi">1</span> j n</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1dc" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1dc"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> subSn // -addSnnS IH.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n -&gt;
minn (f (i + k)) (g (j + (n - k))) &lt;=
fmerge_aux f g i j n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n.+<span class="mi">1</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">minn (f (i + k)) (g (j + (n.+<span class="mi">1</span> - k))) &lt;=
fmerge_aux f g i.+<span class="mi">1</span> j n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1dd" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1dd"><span class="highlight"><span class="nb">case</span>: k kLn =&gt; [_ | k kLn].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n -&gt;
minn (f (i + k)) (g (j + (n - k))) &lt;=
fmerge_aux f g i j n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">minn (f (i + <span class="mi">0</span>)) (g (j + (n.+<span class="mi">1</span> - <span class="mi">0</span>))) &lt;=
fmerge_aux f g i.+<span class="mi">1</span> j n</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk1de" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n -&gt;
minn (f (i + k)) (g (j + (n - k))) &lt;=
fmerge_aux f g i j n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n.+<span class="mi">1</span></span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk1de"><hr></label><div class="goal-conclusion"><span class="highlight">minn (f (i + k.+<span class="mi">1</span>)) (g (j + (n.+<span class="mi">1</span> - k.+<span class="mi">1</span>))) &lt;=
fmerge_aux f g i.+<span class="mi">1</span> j n</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1df" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1df"><span class="highlight"><span class="nb">rewrite</span> addn0 subn0 (minn_idPl _); <span class="nb">last first</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n -&gt;
minn (f (i + k)) (g (j + (n - k))) &lt;=
fmerge_aux f g i j n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f i &lt;= g (j + n.+<span class="mi">1</span>)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk1e0" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n -&gt;
minn (f (i + k)) (g (j + (n - k))) &lt;=
fmerge_aux f g i j n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk1e0"><hr></label><div class="goal-conclusion"><span class="highlight">f i &lt;= fmerge_aux f g i.+<span class="mi">1</span> j n</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="extra-v-chk1e1" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n -&gt;
minn (f (i + k)) (g (j + (n - k))) &lt;=
fmerge_aux f g i j n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n.+<span class="mi">1</span></span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk1e1"><hr></label><div class="goal-conclusion"><span class="highlight">minn (f (i + k.+<span class="mi">1</span>)) (g (j + (n.+<span class="mi">1</span> - k.+<span class="mi">1</span>))) &lt;=
fmerge_aux f g i.+<span class="mi">1</span> j n</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1e2" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1e2"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> (leq_trans (ltnW fLg)) // increasingE // leq_addr.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n -&gt;
minn (f (i + k)) (g (j + (n - k))) &lt;=
fmerge_aux f g i j n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f i &lt;= fmerge_aux f g i.+<span class="mi">1</span> j n</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk1e3" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n -&gt;
minn (f (i + k)) (g (j + (n - k))) &lt;=
fmerge_aux f g i j n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n.+<span class="mi">1</span></span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk1e3"><hr></label><div class="goal-conclusion"><span class="highlight">minn (f (i + k.+<span class="mi">1</span>)) (g (j + (n.+<span class="mi">1</span> - k.+<span class="mi">1</span>))) &lt;=
fmerge_aux f g i.+<span class="mi">1</span> j n</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1e4" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1e4"><span class="highlight"><span class="nb">apply</span>: leq_trans (IH i.+<span class="mi">1</span> j <span class="mi">0</span> isT).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n -&gt;
minn (f (i + k)) (g (j + (n - k))) &lt;=
fmerge_aux f g i j n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f i &lt;= minn (f (i.+<span class="mi">1</span> + <span class="mi">0</span>)) (g (j + (n - <span class="mi">0</span>)))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk1e5" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n -&gt;
minn (f (i + k)) (g (j + (n - k))) &lt;=
fmerge_aux f g i j n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n.+<span class="mi">1</span></span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk1e5"><hr></label><div class="goal-conclusion"><span class="highlight">minn (f (i + k.+<span class="mi">1</span>)) (g (j + (n.+<span class="mi">1</span> - k.+<span class="mi">1</span>))) &lt;=
fmerge_aux f g i.+<span class="mi">1</span> j n</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1e6" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1e6"><span class="highlight"><span class="nb">rewrite</span> addn0 leq_min increasingE //= (leq_trans (ltnW fLg)) //.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n -&gt;
minn (f (i + k)) (g (j + (n - k))) &lt;=
fmerge_aux f g i j n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">g j &lt;= g (j + (n - <span class="mi">0</span>))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk1e7" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n -&gt;
minn (f (i + k)) (g (j + (n - k))) &lt;=
fmerge_aux f g i j n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n.+<span class="mi">1</span></span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk1e7"><hr></label><div class="goal-conclusion"><span class="highlight">minn (f (i + k.+<span class="mi">1</span>)) (g (j + (n.+<span class="mi">1</span> - k.+<span class="mi">1</span>))) &lt;=
fmerge_aux f g i.+<span class="mi">1</span> j n</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1e8" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1e8"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> increasingE // leq_addr.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n -&gt;
minn (f (i + k)) (g (j + (n - k))) &lt;=
fmerge_aux f g i j n</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n.+<span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">minn (f (i + k.+<span class="mi">1</span>)) (g (j + (n.+<span class="mi">1</span> - k.+<span class="mi">1</span>))) &lt;=
fmerge_aux f g i.+<span class="mi">1</span> j n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> subSS -addSnnS IH.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1e9" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1e9"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">fmerge_aux_exist</span> <span class="nv">f</span> <span class="nv">g</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">n</span> :
  <span class="kr">exists2</span> k, k &lt;= n &amp; fmerge_aux f g i j n = minn (f (i + k)) (g (j + (n - k))).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists2</span> k : nat,
  k &lt;= n &amp;
  fmerge_aux f g i j n =
  minn (f (i + k)) (g (j + (n - k)))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1ea" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1ea"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists2</span> k : nat,
  k &lt;= n &amp;
  fmerge_aux f g i j n =
  minn (f (i + k)) (g (j + (n - k)))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1eb" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1eb"><span class="highlight"><span class="nb">elim</span>: n i j =&gt; /= [i j | n IH i j]; <span class="kp">first</span> <span class="bp">by</span> <span class="kr">exists</span> <span class="mi">0</span>; <span class="nb">rewrite</span> //= !addn0.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> : nat,
<span class="kr">exists2</span> k : nat,
  k &lt;= n &amp;
  fmerge_aux f g i j n =
  minn (f (i + k)) (g (j + (n - k)))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists2</span> k : nat,
  k &lt;= n.+<span class="mi">1</span> &amp;
  (<span class="kr">if</span> f i &lt; g j
   <span class="kr">then</span> fmerge_aux f g i.+<span class="mi">1</span> j n
   <span class="kr">else</span> fmerge_aux f g i j.+<span class="mi">1</span> n) =
  minn (f (i + k)) (g (j + (n.+<span class="mi">1</span> - k)))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1ec" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1ec"><span class="highlight"><span class="nb">case</span>: (leqP (g j) (f i)) =&gt; [gLf|fLg]; <span class="nb">last first</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> : nat,
<span class="kr">exists2</span> k : nat,
  k &lt;= n &amp;
  fmerge_aux f g i j n =
  minn (f (i + k)) (g (j + (n - k)))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists2</span> k : nat,
  k &lt;= n.+<span class="mi">1</span> &amp;
  fmerge_aux f g i.+<span class="mi">1</span> j n =
  minn (f (i + k)) (g (j + (n.+<span class="mi">1</span> - k)))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk1ed" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> : nat,
<span class="kr">exists2</span> k : nat,
  k &lt;= n &amp;
  fmerge_aux f g i j n =
  minn (f (i + k)) (g (j + (n - k)))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gLf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g j &lt;= f i</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk1ed"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists2</span> k : nat,
  k &lt;= n.+<span class="mi">1</span> &amp;
  fmerge_aux f g i j.+<span class="mi">1</span> n =
  minn (f (i + k)) (g (j + (n.+<span class="mi">1</span> - k)))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1ee" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1ee"><span class="highlight"><span class="bp">by</span> <span class="nb">case</span>: (IH i.+<span class="mi">1</span> j) =&gt; k kLn -&gt;; <span class="kr">exists</span> <span class="nv">k</span>.+<span class="mi">1</span>; <span class="nb">rewrite</span> // addnS subSS.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> : nat,
<span class="kr">exists2</span> k : nat,
  k &lt;= n &amp;
  fmerge_aux f g i j n =
  minn (f (i + k)) (g (j + (n - k)))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gLf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g j &lt;= f i</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists2</span> k : nat,
  k &lt;= n.+<span class="mi">1</span> &amp;
  fmerge_aux f g i j.+<span class="mi">1</span> n =
  minn (f (i + k)) (g (j + (n.+<span class="mi">1</span> - k)))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1ef" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1ef"><span class="highlight"><span class="nb">case</span>: (IH i j.+<span class="mi">1</span>) =&gt; [] [|k] kLn -&gt;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> : nat,
<span class="kr">exists2</span> k : nat,
  k &lt;= n &amp;
  fmerge_aux f g i j n =
  minn (f (i + k)) (g (j + (n - k)))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gLf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g j &lt;= f i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="mi">0</span> &lt;= n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists2</span> k : nat,
  k &lt;= n.+<span class="mi">1</span> &amp;
  minn (f (i + <span class="mi">0</span>)) (g (j.+<span class="mi">1</span> + (n - <span class="mi">0</span>))) =
  minn (f (i + k)) (g (j + (n.+<span class="mi">1</span> - k)))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk1f0" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> : nat,
<span class="kr">exists2</span> k : nat,
  k &lt;= n &amp;
  fmerge_aux f g i j n =
  minn (f (i + k)) (g (j + (n - k)))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gLf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g j &lt;= f i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk1f0"><hr></label><div class="goal-conclusion"><span class="highlight">ex2 (<span class="kr">fun</span> <span class="nv">k</span> : nat =&gt; k &lt;= n.+<span class="mi">1</span>)
  (<span class="kr">fun</span> <span class="nv">k0</span> : nat =&gt;
   minn (f (i + k.+<span class="mi">1</span>)) (g (j.+<span class="mi">1</span> + (n - k.+<span class="mi">1</span>))) =
   minn (f (i + k0)) (g (j + (n.+<span class="mi">1</span> - k0))))</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1f1" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1f1"><span class="highlight"><span class="bp">by</span> <span class="kr">exists</span> <span class="mi">0</span>; <span class="nb">rewrite</span> // addn0 !subn0 addnS.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> : nat,
<span class="kr">exists2</span> k : nat,
  k &lt;= n &amp;
  fmerge_aux f g i j n =
  minn (f (i + k)) (g (j + (n - k)))</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gLf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g j &lt;= f i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">ex2 (<span class="kr">fun</span> <span class="nv">k</span> : nat =&gt; k &lt;= n.+<span class="mi">1</span>)
  (<span class="kr">fun</span> <span class="nv">k0</span> : nat =&gt;
   minn (f (i + k.+<span class="mi">1</span>)) (g (j.+<span class="mi">1</span> + (n - k.+<span class="mi">1</span>))) =
   minn (f (i + k0)) (g (j + (n.+<span class="mi">1</span> - k0))))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="kr">exists</span> <span class="nv">k</span>.+<span class="mi">1</span>; <span class="nb">rewrite</span> ?(leq_trans kLn) // addSnnS -subSn.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1f2" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1f2"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">fmergeE</span> (<span class="nv">f</span> <span class="nv">g</span> : nat -&gt; nat) <span class="nv">n</span> : 
 increasing f -&gt; increasing g -&gt;
 fmerge f g n = \max_(i &lt; n.+<span class="mi">1</span>) minn (f i) (g (n - i)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">increasing f -&gt;
increasing g -&gt;
fmerge f g n = \max_(i &lt; n.+<span class="mi">1</span>) minn (f i) (g (n - i))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1f3" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1f3"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">increasing f -&gt;
increasing g -&gt;
fmerge f g n = \max_(i &lt; n.+<span class="mi">1</span>) minn (f i) (g (n - i))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1f4" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1f4"><span class="highlight"><span class="nb">move</span>=&gt; fI gI.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">fmerge f g n = \max_(i &lt; n.+<span class="mi">1</span>) minn (f i) (g (n - i))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1f5" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1f5"><span class="highlight"><span class="nb">apply</span>/eqP; <span class="nb">rewrite</span> /fmerge eqn_leq; <span class="nb">apply</span>/andP; <span class="nb">split</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">fmerge_aux f g <span class="mi">0</span> <span class="mi">0</span> n &lt;=
\max_(i &lt; n.+<span class="mi">1</span>) minn (f i) (g (n - i))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk1f6" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk1f6"><hr></label><div class="goal-conclusion"><span class="highlight">\max_(i &lt; n.+<span class="mi">1</span>) minn (f i) (g (n - i)) &lt;=
fmerge_aux f g <span class="mi">0</span> <span class="mi">0</span> n</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1f7" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1f7"><span class="highlight"><span class="nb">case</span>: (@fmerge_aux_exist f g <span class="mi">0</span> <span class="mi">0</span> n) =&gt; // i1 i1Ln -&gt;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i1</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i1Ln</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">i1 &lt;= n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">minn (f (<span class="mi">0</span> + i1)) (g (<span class="mi">0</span> + (n - i1))) &lt;=
\max_(i &lt; n.+<span class="mi">1</span>) minn (f i) (g (n - i))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk1f8" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk1f8"><hr></label><div class="goal-conclusion"><span class="highlight">\max_(i &lt; n.+<span class="mi">1</span>) minn (f i) (g (n - i)) &lt;=
fmerge_aux f g <span class="mi">0</span> <span class="mi">0</span> n</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1f9" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1f9"><span class="highlight"><span class="bp">by</span> <span class="nb">apply</span>: (@leq_bigmax_cond _ _ _ (Ordinal (i1Ln : i1 &lt; n.+<span class="mi">1</span>))).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">\max_(i &lt; n.+<span class="mi">1</span>) minn (f i) (g (n - i)) &lt;=
fmerge_aux f g <span class="mi">0</span> <span class="mi">0</span> n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1fa" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1fa"><span class="highlight"><span class="nb">apply</span>/bigmax_leqP =&gt; /= i _.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n.+<span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">minn (f i) (g (n - i)) &lt;= fmerge_aux f g <span class="mi">0</span> <span class="mi">0</span> n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">apply</span>: fmerge_aux_correct; <span class="nb">rewrite</span> -<span class="mi">1</span><span class="nl">?ltnS</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1fb" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1fb"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">increasing_fmerge</span> <span class="nv">f</span> <span class="nv">g</span> : 
  increasing f -&gt; increasing g -&gt; increasing (fmerge f g).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">increasing f -&gt;
increasing g -&gt; increasing (fmerge f g)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1fc" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1fc"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">increasing f -&gt;
increasing g -&gt; increasing (fmerge f g)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1fd" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1fd"><span class="highlight"><span class="nb">move</span>=&gt; fI gI n; <span class="nb">rewrite</span> !fmergeE //.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">\max_(i &lt; n.+<span class="mi">1</span>) minn (f i) (g (n - i)) &lt;=
\max_(i &lt; n.+<span class="mi">2</span>) minn (f i) (g (n.+<span class="mi">1</span> - i))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1fe" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1fe"><span class="highlight"><span class="nb">apply</span>/bigmax_leqP =&gt; /= i _.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n.+<span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">minn (f i) (g (n - i)) &lt;=
\max_(i &lt; n.+<span class="mi">2</span>) minn (f i) (g (n.+<span class="mi">1</span> - i))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk1ff" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk1ff"><span class="highlight"><span class="nb">apply</span>: leq_trans (leq_bigmax_cond _ (isT : xpredT (inord i : &#39;I_n.+<span class="mi">2</span>))).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n.+<span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">minn (f i) (g (n - i)) &lt;=
minn (f (inord i)) (g (n.+<span class="mi">1</span> - inord i))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk200" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk200"><span class="highlight"><span class="nb">rewrite</span> inordK ?(leq_trans (ltn_ord _)) //.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n.+<span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">minn (f i) (g (n - i)) &lt;= minn (f i) (g (n.+<span class="mi">1</span> - i))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk201" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk201"><span class="highlight"><span class="nb">rewrite</span> leq_min geq_minl /= (leq_trans (geq_minr _ _)) //.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n.+<span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">g (n - i) &lt;= g (n.+<span class="mi">1</span> - i)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk202" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk202"><span class="highlight"><span class="nb">apply</span>: increasingE gI _.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n.+<span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">n - i &lt;= n.+<span class="mi">1</span> - i</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> leq_sub2r.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk203" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk203"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">fmerge0</span> <span class="nv">f</span> <span class="nv">g</span> : fmerge f g <span class="mi">0</span> = minn (f <span class="mi">0</span>) (g <span class="mi">0</span>).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">fmerge f g <span class="mi">0</span> = minn (f <span class="mi">0</span>) (g <span class="mi">0</span>)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk204" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk204"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">fmerge f g <span class="mi">0</span> = minn (f <span class="mi">0</span>) (g <span class="mi">0</span>)</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> [].</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Fixpoint</span> <span class="nf">sum_fmerge_aux</span> (<span class="nv">f</span> <span class="nv">g</span> : nat -&gt; nat) <span class="nv">i</span> <span class="nv">j</span> <span class="nv">n</span> := 
 <span class="kr">if</span> n <span class="kr">is</span> n1.+<span class="mi">1</span> <span class="kr">then</span>
   <span class="kr">if</span> f i &lt; g j <span class="kr">then</span> f i + sum_fmerge_aux f g i.+<span class="mi">1</span> j n1 
   <span class="kr">else</span> g j + sum_fmerge_aux f g i j.+<span class="mi">1</span> n1
 <span class="kr">else</span> minn (f i) (g j).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Definition</span> <span class="nf">sum_fmerge</span> <span class="nv">f</span> <span class="nv">g</span> <span class="nv">n</span> := sum_fmerge_aux f g <span class="mi">0</span> <span class="mi">0</span> n.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk205" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk205"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">sum_fmerge_aux_correct</span> <span class="nv">f</span> <span class="nv">g</span> <span class="nv">n</span> <span class="nv">i</span> <span class="nv">j</span> : 
  sum_fmerge_aux f g i j n = \sum_(k &lt; n.+<span class="mi">1</span>) fmerge_aux f g i j k.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">sum_fmerge_aux f g i j n =
\sum_(k &lt; n.+<span class="mi">1</span>) fmerge_aux f g i j k</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk206" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk206"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">sum_fmerge_aux f g i j n =
\sum_(k &lt; n.+<span class="mi">1</span>) fmerge_aux f g i j k</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk207" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk207"><span class="highlight"><span class="nb">elim</span>: n i j =&gt; //= [i j|n IH i j]; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> big_ord_recr big_ord0.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> : nat,
sum_fmerge_aux f g i j n =
\sum_(k &lt; n.+<span class="mi">1</span>) fmerge_aux f g i j k</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">if</span> f i &lt; g j
 <span class="kr">then</span> f i + sum_fmerge_aux f g i.+<span class="mi">1</span> j n
 <span class="kr">else</span> g j + sum_fmerge_aux f g i j.+<span class="mi">1</span> n) =
\sum_(k &lt; n.+<span class="mi">2</span>) fmerge_aux f g i j k</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> big_ord_recl /= /minn; <span class="nb">case</span>: leqP; <span class="nb">rewrite</span> IH.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk208" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk208"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">sum_fmerge_correct</span> <span class="nv">f</span> <span class="nv">g</span> <span class="nv">n</span> : 
  sum_fmerge f g n = \sum_(k &lt; n.+<span class="mi">1</span>) fmerge f g k.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">sum_fmerge f g n = \sum_(k &lt; n.+<span class="mi">1</span>) fmerge f g k</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk209" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk209"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">sum_fmerge f g n = \sum_(k &lt; n.+<span class="mi">1</span>) fmerge f g k</span></div></blockquote></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">apply</span>: sum_fmerge_aux_correct.</span></span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk20a" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk20a"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">sum_fmerge_aux_conv_correct</span> <span class="nv">f</span> <span class="nv">g</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">n</span> :
  increasing f -&gt; increasing g -&gt; 
  (<span class="kr">forall</span> <span class="nv">k</span>, k &lt;= n.+<span class="mi">1</span> -&gt; 
    sum_fmerge_aux f g i j n &lt;= 
    \sum_(l &lt; k) f (i + l) + \sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">increasing f -&gt;
increasing g -&gt;
<span class="kr">forall</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) + \sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk20b" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk20b"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">increasing f -&gt;
increasing g -&gt;
<span class="kr">forall</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) + \sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk20c" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk20c"><span class="highlight"><span class="nb">move</span>=&gt; fI gI.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">forall</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) + \sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk20d" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk20d"><span class="highlight"><span class="nb">elim</span>: n i j =&gt; /= [i j [_|[_|]]//|n IH i j k kLn].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">minn (f i) (g j) &lt;=
\sum_(l &lt; <span class="mi">0</span>) f (i + l) + \sum_(l &lt; <span class="mi">1</span> - <span class="mi">0</span>) g (j + l)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk20e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk20e"><hr></label><div class="goal-conclusion"><span class="highlight">minn (f i) (g j) &lt;=
\sum_(l &lt; <span class="mi">1</span>) f (i + l) + \sum_(l &lt; <span class="mi">1</span> - <span class="mi">1</span>) g (j + l)</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="extra-v-chk20f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n.+<span class="mi">2</span></span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk20f"><hr></label><div class="goal-conclusion"><span class="highlight">(<span class="kr">if</span> f i &lt; g j
 <span class="kr">then</span> f i + sum_fmerge_aux f g i.+<span class="mi">1</span> j n
 <span class="kr">else</span> g j + sum_fmerge_aux f g i j.+<span class="mi">1</span> n) &lt;=
\sum_(l &lt; k) f (i + l) + \sum_(l &lt; n.+<span class="mi">2</span> - k) g (j + l)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk210" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk210"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">minn (f i) (g j) &lt;=
\sum_(l &lt; <span class="mi">0</span>) f (i + l) + \sum_(l &lt; <span class="mi">1</span> - <span class="mi">0</span>) g (j + l)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk211" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk211"><hr></label><div class="goal-conclusion"><span class="highlight">minn (f i) (g j) &lt;=
\sum_(l &lt; <span class="mi">1</span>) f (i + l) + \sum_(l &lt; <span class="mi">1</span> - <span class="mi">1</span>) g (j + l)</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="extra-v-chk212" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n.+<span class="mi">2</span></span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk212"><hr></label><div class="goal-conclusion"><span class="highlight">(<span class="kr">if</span> f i &lt; g j
 <span class="kr">then</span> f i + sum_fmerge_aux f g i.+<span class="mi">1</span> j n
 <span class="kr">else</span> g j + sum_fmerge_aux f g i j.+<span class="mi">1</span> n) &lt;=
\sum_(l &lt; k) f (i + l) + \sum_(l &lt; n.+<span class="mi">2</span> - k) g (j + l)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk213" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk213"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> big_ord_recr !big_ord0 /= !addn0 !add0n geq_minr.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">minn (f i) (g j) &lt;=
\sum_(l &lt; <span class="mi">1</span>) f (i + l) + \sum_(l &lt; <span class="mi">1</span> - <span class="mi">1</span>) g (j + l)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk214" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n.+<span class="mi">2</span></span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk214"><hr></label><div class="goal-conclusion"><span class="highlight">(<span class="kr">if</span> f i &lt; g j
 <span class="kr">then</span> f i + sum_fmerge_aux f g i.+<span class="mi">1</span> j n
 <span class="kr">else</span> g j + sum_fmerge_aux f g i j.+<span class="mi">1</span> n) &lt;=
\sum_(l &lt; k) f (i + l) + \sum_(l &lt; n.+<span class="mi">2</span> - k) g (j + l)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk215" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk215"><span class="highlight">-</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">minn (f i) (g j) &lt;=
\sum_(l &lt; <span class="mi">1</span>) f (i + l) + \sum_(l &lt; <span class="mi">1</span> - <span class="mi">1</span>) g (j + l)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk216" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n.+<span class="mi">2</span></span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk216"><hr></label><div class="goal-conclusion"><span class="highlight">(<span class="kr">if</span> f i &lt; g j
 <span class="kr">then</span> f i + sum_fmerge_aux f g i.+<span class="mi">1</span> j n
 <span class="kr">else</span> g j + sum_fmerge_aux f g i j.+<span class="mi">1</span> n) &lt;=
\sum_(l &lt; k) f (i + l) + \sum_(l &lt; n.+<span class="mi">2</span> - k) g (j + l)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk217" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk217"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> big_ord_recr !big_ord0 /= !addn0 !add0n geq_minl.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n.+<span class="mi">2</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">(<span class="kr">if</span> f i &lt; g j
 <span class="kr">then</span> f i + sum_fmerge_aux f g i.+<span class="mi">1</span> j n
 <span class="kr">else</span> g j + sum_fmerge_aux f g i j.+<span class="mi">1</span> n) &lt;=
\sum_(l &lt; k) f (i + l) + \sum_(l &lt; n.+<span class="mi">2</span> - k) g (j + l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk218" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk218"><span class="highlight"><span class="nb">case</span>: leqP =&gt; [gLf|fLg].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n.+<span class="mi">2</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gLf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g j &lt;= f i</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">g j + sum_fmerge_aux f g i j.+<span class="mi">1</span> n &lt;=
\sum_(l &lt; k) f (i + l) + \sum_(l &lt; n.+<span class="mi">2</span> - k) g (j + l)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk219" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n.+<span class="mi">2</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk219"><hr></label><div class="goal-conclusion"><span class="highlight">f i + sum_fmerge_aux f g i.+<span class="mi">1</span> j n &lt;=
\sum_(l &lt; k) f (i + l) + \sum_(l &lt; n.+<span class="mi">2</span> - k) g (j + l)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk21a" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk21a"><span class="highlight"><span class="nb">move</span>: kLn; <span class="nb">case</span>: ltngtP =&gt; // [kLn _ |-&gt; _]; <span class="nb">last first</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gLf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g j &lt;= f i</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">g j + sum_fmerge_aux f g i j.+<span class="mi">1</span> n &lt;=
\sum_(l &lt; n.+<span class="mi">2</span>) f (i + l) +
\sum_(l &lt; n.+<span class="mi">2</span> - n.+<span class="mi">2</span>) g (j + l)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk21b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gLf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g j &lt;= f i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n.+<span class="mi">2</span></span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk21b"><hr></label><div class="goal-conclusion"><span class="highlight">g j + sum_fmerge_aux f g i j.+<span class="mi">1</span> n &lt;=
\sum_(l &lt; k) f (i + l) + \sum_(l &lt; n.+<span class="mi">2</span> - k) g (j + l)</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="extra-v-chk21c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n.+<span class="mi">2</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk21c"><hr></label><div class="goal-conclusion"><span class="highlight">f i + sum_fmerge_aux f g i.+<span class="mi">1</span> j n &lt;=
\sum_(l &lt; k) f (i + l) + \sum_(l &lt; n.+<span class="mi">2</span> - k) g (j + l)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk21d" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk21d"><span class="highlight"><span class="nb">rewrite</span> subnn big_ord0 addn0 big_ord_recl addn0 /=.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gLf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g j &lt;= f i</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">g j + sum_fmerge_aux f g i j.+<span class="mi">1</span> n &lt;=
f i + \sum_(i0 &lt; n.+<span class="mi">1</span>) f (i + bump <span class="mi">0</span> i0)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk21e" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gLf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g j &lt;= f i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n.+<span class="mi">2</span></span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk21e"><hr></label><div class="goal-conclusion"><span class="highlight">g j + sum_fmerge_aux f g i j.+<span class="mi">1</span> n &lt;=
\sum_(l &lt; k) f (i + l) + \sum_(l &lt; n.+<span class="mi">2</span> - k) g (j + l)</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="extra-v-chk21f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n.+<span class="mi">2</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk21f"><hr></label><div class="goal-conclusion"><span class="highlight">f i + sum_fmerge_aux f g i.+<span class="mi">1</span> j n &lt;=
\sum_(l &lt; k) f (i + l) + \sum_(l &lt; n.+<span class="mi">2</span> - k) g (j + l)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk220" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk220"><span class="highlight"><span class="nb">apply</span>: leq_add =&gt; //.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gLf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g j &lt;= f i</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">sum_fmerge_aux f g i j.+<span class="mi">1</span> n &lt;=
\sum_(i0 &lt; n.+<span class="mi">1</span>) f (i + bump <span class="mi">0</span> i0)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk221" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gLf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g j &lt;= f i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n.+<span class="mi">2</span></span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk221"><hr></label><div class="goal-conclusion"><span class="highlight">g j + sum_fmerge_aux f g i j.+<span class="mi">1</span> n &lt;=
\sum_(l &lt; k) f (i + l) + \sum_(l &lt; n.+<span class="mi">2</span> - k) g (j + l)</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="extra-v-chk222" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n.+<span class="mi">2</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk222"><hr></label><div class="goal-conclusion"><span class="highlight">f i + sum_fmerge_aux f g i.+<span class="mi">1</span> j n &lt;=
\sum_(l &lt; k) f (i + l) + \sum_(l &lt; n.+<span class="mi">2</span> - k) g (j + l)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk223" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk223"><span class="highlight"><span class="nb">rewrite</span> /bump /=.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gLf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g j &lt;= f i</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">sum_fmerge_aux f g i j.+<span class="mi">1</span> n &lt;=
\sum_(i0 &lt; n.+<span class="mi">1</span>) f (i + (<span class="mi">1</span> + i0))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk224" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gLf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g j &lt;= f i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n.+<span class="mi">2</span></span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk224"><hr></label><div class="goal-conclusion"><span class="highlight">g j + sum_fmerge_aux f g i j.+<span class="mi">1</span> n &lt;=
\sum_(l &lt; k) f (i + l) + \sum_(l &lt; n.+<span class="mi">2</span> - k) g (j + l)</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="extra-v-chk225" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n.+<span class="mi">2</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk225"><hr></label><div class="goal-conclusion"><span class="highlight">f i + sum_fmerge_aux f g i.+<span class="mi">1</span> j n &lt;=
\sum_(l &lt; k) f (i + l) + \sum_(l &lt; n.+<span class="mi">2</span> - k) g (j + l)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk226" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk226"><span class="highlight"><span class="nb">apply</span>: leq_trans (IH _ _ _ (leqnn _)) _.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gLf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g j &lt;= f i</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">\sum_(l &lt; n.+<span class="mi">1</span>) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - n.+<span class="mi">1</span>) g (j.+<span class="mi">1</span> + l) &lt;=
\sum_(i0 &lt; n.+<span class="mi">1</span>) f (i + (<span class="mi">1</span> + i0))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk227" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gLf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g j &lt;= f i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n.+<span class="mi">2</span></span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk227"><hr></label><div class="goal-conclusion"><span class="highlight">g j + sum_fmerge_aux f g i j.+<span class="mi">1</span> n &lt;=
\sum_(l &lt; k) f (i + l) + \sum_(l &lt; n.+<span class="mi">2</span> - k) g (j + l)</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="extra-v-chk228" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n.+<span class="mi">2</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk228"><hr></label><div class="goal-conclusion"><span class="highlight">f i + sum_fmerge_aux f g i.+<span class="mi">1</span> j n &lt;=
\sum_(l &lt; k) f (i + l) + \sum_(l &lt; n.+<span class="mi">2</span> - k) g (j + l)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk229" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk229"><span class="highlight"><span class="nb">rewrite</span> subnn big_ord0 addn0 leq_sum // =&gt; l _.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gLf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g j &lt;= f i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n.+<span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f (i + l) &lt;= f (i + (<span class="mi">1</span> + l))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk22a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gLf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g j &lt;= f i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n.+<span class="mi">2</span></span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk22a"><hr></label><div class="goal-conclusion"><span class="highlight">g j + sum_fmerge_aux f g i j.+<span class="mi">1</span> n &lt;=
\sum_(l &lt; k) f (i + l) + \sum_(l &lt; n.+<span class="mi">2</span> - k) g (j + l)</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="extra-v-chk22b" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n.+<span class="mi">2</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk22b"><hr></label><div class="goal-conclusion"><span class="highlight">f i + sum_fmerge_aux f g i.+<span class="mi">1</span> j n &lt;=
\sum_(l &lt; k) f (i + l) + \sum_(l &lt; n.+<span class="mi">2</span> - k) g (j + l)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk22c" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk22c"><span class="highlight"><span class="bp">by</span> <span class="nb">apply</span>: increasingE; <span class="nb">rewrite</span> // addnCA leq_addl.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gLf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g j &lt;= f i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n.+<span class="mi">2</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">g j + sum_fmerge_aux f g i j.+<span class="mi">1</span> n &lt;=
\sum_(l &lt; k) f (i + l) + \sum_(l &lt; n.+<span class="mi">2</span> - k) g (j + l)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk22d" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n.+<span class="mi">2</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk22d"><hr></label><div class="goal-conclusion"><span class="highlight">f i + sum_fmerge_aux f g i.+<span class="mi">1</span> j n &lt;=
\sum_(l &lt; k) f (i + l) + \sum_(l &lt; n.+<span class="mi">2</span> - k) g (j + l)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk22e" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk22e"><span class="highlight"><span class="nb">rewrite</span> subSn // big_ord_recl addn0 addnCA leq_add2l.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gLf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g j &lt;= f i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n.+<span class="mi">2</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">sum_fmerge_aux f g i j.+<span class="mi">1</span> n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(i &lt; n.+<span class="mi">1</span> - k) g (j + lift ord0 i)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk22f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n.+<span class="mi">2</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk22f"><hr></label><div class="goal-conclusion"><span class="highlight">f i + sum_fmerge_aux f g i.+<span class="mi">1</span> j n &lt;=
\sum_(l &lt; k) f (i + l) + \sum_(l &lt; n.+<span class="mi">2</span> - k) g (j + l)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk230" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk230"><span class="highlight"><span class="nb">apply</span>: leq_trans (IH _ _ _ (kLn : k &lt;= n.+<span class="mi">1</span>)) _.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gLf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g j &lt;= f i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n.+<span class="mi">2</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j.+<span class="mi">1</span> + l) &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(i &lt; n.+<span class="mi">1</span> - k) g (j + lift ord0 i)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk231" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n.+<span class="mi">2</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk231"><hr></label><div class="goal-conclusion"><span class="highlight">f i + sum_fmerge_aux f g i.+<span class="mi">1</span> j n &lt;=
\sum_(l &lt; k) f (i + l) + \sum_(l &lt; n.+<span class="mi">2</span> - k) g (j + l)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk232" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk232"><span class="highlight"><span class="nb">rewrite</span> leq_add2l leq_sum // =&gt; l _.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gLf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g j &lt;= f i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n.+<span class="mi">2</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_(n.+<span class="mi">1</span> - k)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">g (j.+<span class="mi">1</span> + l) &lt;= g (j + lift ord0 l)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk233" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n.+<span class="mi">2</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk233"><hr></label><div class="goal-conclusion"><span class="highlight">f i + sum_fmerge_aux f g i.+<span class="mi">1</span> j n &lt;=
\sum_(l &lt; k) f (i + l) + \sum_(l &lt; n.+<span class="mi">2</span> - k) g (j + l)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk234" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk234"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> increasingE //= /bump addnCA add1n.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n.+<span class="mi">2</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f i + sum_fmerge_aux f g i.+<span class="mi">1</span> j n &lt;=
\sum_(l &lt; k) f (i + l) + \sum_(l &lt; n.+<span class="mi">2</span> - k) g (j + l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk235" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk235"><span class="highlight"><span class="nb">move</span>: kLn; <span class="nb">case</span>: ltngtP =&gt; // [kLn _ |-&gt; _]; <span class="nb">last first</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f i + sum_fmerge_aux f g i.+<span class="mi">1</span> j n &lt;=
\sum_(l &lt; n.+<span class="mi">2</span>) f (i + l) +
\sum_(l &lt; n.+<span class="mi">2</span> - n.+<span class="mi">2</span>) g (j + l)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk236" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n.+<span class="mi">2</span></span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk236"><hr></label><div class="goal-conclusion"><span class="highlight">f i + sum_fmerge_aux f g i.+<span class="mi">1</span> j n &lt;=
\sum_(l &lt; k) f (i + l) + \sum_(l &lt; n.+<span class="mi">2</span> - k) g (j + l)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk237" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk237"><span class="highlight"><span class="nb">rewrite</span> subnn big_ord0 addn0 big_ord_recl addn0 /= leq_add2l /bump /=.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">sum_fmerge_aux f g i.+<span class="mi">1</span> j n &lt;=
\sum_(i0 &lt; n.+<span class="mi">1</span>) f (i + (<span class="mi">1</span> + i0))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk238" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n.+<span class="mi">2</span></span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk238"><hr></label><div class="goal-conclusion"><span class="highlight">f i + sum_fmerge_aux f g i.+<span class="mi">1</span> j n &lt;=
\sum_(l &lt; k) f (i + l) + \sum_(l &lt; n.+<span class="mi">2</span> - k) g (j + l)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk239" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk239"><span class="highlight"><span class="nb">apply</span>: leq_trans (IH _ _ _ (leqnn _)) _.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">\sum_(l &lt; n.+<span class="mi">1</span>) f (i.+<span class="mi">1</span> + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - n.+<span class="mi">1</span>) g (j + l) &lt;=
\sum_(i0 &lt; n.+<span class="mi">1</span>) f (i + (<span class="mi">1</span> + i0))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk23a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n.+<span class="mi">2</span></span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk23a"><hr></label><div class="goal-conclusion"><span class="highlight">f i + sum_fmerge_aux f g i.+<span class="mi">1</span> j n &lt;=
\sum_(l &lt; k) f (i + l) + \sum_(l &lt; n.+<span class="mi">2</span> - k) g (j + l)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk23b" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk23b"><span class="highlight"><span class="nb">rewrite</span> subnn big_ord0 addn0 leq_sum // =&gt; l _.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_n.+<span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f (i.+<span class="mi">1</span> + l) &lt;= f (i + (<span class="mi">1</span> + l))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk23c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n.+<span class="mi">2</span></span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk23c"><hr></label><div class="goal-conclusion"><span class="highlight">f i + sum_fmerge_aux f g i.+<span class="mi">1</span> j n &lt;=
\sum_(l &lt; k) f (i + l) + \sum_(l &lt; n.+<span class="mi">2</span> - k) g (j + l)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk23d" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk23d"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> increasingE // addnCA add1n.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt; n.+<span class="mi">2</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f i + sum_fmerge_aux f g i.+<span class="mi">1</span> j n &lt;=
\sum_(l &lt; k) f (i + l) + \sum_(l &lt; n.+<span class="mi">2</span> - k) g (j + l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk23e" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk23e"><span class="highlight"><span class="nb">case</span>: k kLn =&gt; [_|k kLn]; <span class="nb">last first</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k.+<span class="mi">1</span> &lt; n.+<span class="mi">2</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f i + sum_fmerge_aux f g i.+<span class="mi">1</span> j n &lt;=
\sum_(l &lt; k.+<span class="mi">1</span>) f (i + l) +
\sum_(l &lt; n.+<span class="mi">2</span> - k.+<span class="mi">1</span>) g (j + l)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk23f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk23f"><hr></label><div class="goal-conclusion"><span class="highlight">f i + sum_fmerge_aux f g i.+<span class="mi">1</span> j n &lt;=
\sum_(l &lt; <span class="mi">0</span>) f (i + l) + \sum_(l &lt; n.+<span class="mi">2</span> - <span class="mi">0</span>) g (j + l)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk240" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk240"><span class="highlight"><span class="nb">rewrite</span> subSS.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k.+<span class="mi">1</span> &lt; n.+<span class="mi">2</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f i + sum_fmerge_aux f g i.+<span class="mi">1</span> j n &lt;=
\sum_(l &lt; k.+<span class="mi">1</span>) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk241" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk241"><hr></label><div class="goal-conclusion"><span class="highlight">f i + sum_fmerge_aux f g i.+<span class="mi">1</span> j n &lt;=
\sum_(l &lt; <span class="mi">0</span>) f (i + l) + \sum_(l &lt; n.+<span class="mi">2</span> - <span class="mi">0</span>) g (j + l)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk242" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk242"><span class="highlight"><span class="nb">apply</span>: leq_trans (leq_add  (leqnn _) (IH i.+<span class="mi">1</span> j k _)) _ .</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k.+<span class="mi">1</span> &lt; n.+<span class="mi">2</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">k &lt;= n.+<span class="mi">1</span></span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk243" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k.+<span class="mi">1</span> &lt; n.+<span class="mi">2</span></span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk243"><hr></label><div class="goal-conclusion"><span class="highlight">f i +
(\sum_(l &lt; k) f (i.+<span class="mi">1</span> + l) +
 \sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)) &lt;=
\sum_(l &lt; k.+<span class="mi">1</span>) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="extra-v-chk244" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk244"><hr></label><div class="goal-conclusion"><span class="highlight">f i + sum_fmerge_aux f g i.+<span class="mi">1</span> j n &lt;=
\sum_(l &lt; <span class="mi">0</span>) f (i + l) + \sum_(l &lt; n.+<span class="mi">2</span> - <span class="mi">0</span>) g (j + l)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk245" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk245"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> -ltnS ltnW.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k.+<span class="mi">1</span> &lt; n.+<span class="mi">2</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f i +
(\sum_(l &lt; k) f (i.+<span class="mi">1</span> + l) +
 \sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)) &lt;=
\sum_(l &lt; k.+<span class="mi">1</span>) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk246" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk246"><hr></label><div class="goal-conclusion"><span class="highlight">f i + sum_fmerge_aux f g i.+<span class="mi">1</span> j n &lt;=
\sum_(l &lt; <span class="mi">0</span>) f (i + l) + \sum_(l &lt; n.+<span class="mi">2</span> - <span class="mi">0</span>) g (j + l)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk247" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk247"><span class="highlight"><span class="nb">rewrite</span> addnA leq_add2r big_ord_recl addn0 leq_add2l leq_sum // =&gt; l _.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k.+<span class="mi">1</span> &lt; n.+<span class="mi">2</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">l</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">&#39;I_k</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f (i.+<span class="mi">1</span> + l) &lt;= f (i + lift ord0 l)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk248" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk248"><hr></label><div class="goal-conclusion"><span class="highlight">f i + sum_fmerge_aux f g i.+<span class="mi">1</span> j n &lt;=
\sum_(l &lt; <span class="mi">0</span>) f (i + l) + \sum_(l &lt; n.+<span class="mi">2</span> - <span class="mi">0</span>) g (j + l)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk249" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk249"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> addnCA.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f i + sum_fmerge_aux f g i.+<span class="mi">1</span> j n &lt;=
\sum_(l &lt; <span class="mi">0</span>) f (i + l) + \sum_(l &lt; n.+<span class="mi">2</span> - <span class="mi">0</span>) g (j + l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk24a" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk24a"><span class="highlight"><span class="nb">rewrite</span> big_ord0 add0n subn0.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f i + sum_fmerge_aux f g i.+<span class="mi">1</span> j n &lt;=
\sum_(l &lt; n.+<span class="mi">2</span>) g (j + l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk24b" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk24b"><span class="highlight"><span class="nb">apply</span>: leq_trans (leq_add  (leqnn _) (IH i.+<span class="mi">1</span> j <span class="mi">0</span> isT)) _ .</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f i +
(\sum_(l &lt; <span class="mi">0</span>) f (i.+<span class="mi">1</span> + l) +
 \sum_(l &lt; n.+<span class="mi">1</span> - <span class="mi">0</span>) g (j + l)) &lt;=
\sum_(l &lt; n.+<span class="mi">2</span>) g (j + l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk24c" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk24c"><span class="highlight"><span class="nb">rewrite</span> big_ord0 add0n subn0 [X <span class="kr">in</span> _ &lt;= X]big_ord_recr addnC leq_add //.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f i &lt;= g (j + ord_max)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk24d" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk24d"><span class="highlight"><span class="nb">apply</span>: leq_trans (ltnW fLg) _.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">k</span> : nat,
k &lt;= n.+<span class="mi">1</span> -&gt;
sum_fmerge_aux f g i j n &lt;=
\sum_(l &lt; k) f (i + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">g j &lt;= g (j + ord_max)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">rewrite</span> increasingE // leq_addr.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk24e" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk24e"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">leq_sum_fmerge_conv</span> <span class="nv">f</span> <span class="nv">g</span> <span class="nv">k</span> <span class="nv">n</span> :
  increasing f -&gt; increasing g -&gt; k &lt;= n -&gt; 
  \sum_(i &lt; n) fmerge f g i &lt;= \sum_(i &lt; k) f i + \sum_(i &lt; n - k) g i.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">increasing f -&gt;
increasing g -&gt;
k &lt;= n -&gt;
\sum_(i &lt; n) fmerge f g i &lt;=
\sum_(i &lt; k) f i + \sum_(i &lt; n - k) g i</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk24f" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk24f"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">increasing f -&gt;
increasing g -&gt;
k &lt;= n -&gt;
\sum_(i &lt; n) fmerge f g i &lt;=
\sum_(i &lt; k) f i + \sum_(i &lt; n - k) g i</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk250" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk250"><span class="highlight"><span class="nb">move</span>=&gt; fI gI; <span class="nb">case</span>: n =&gt; [|n kLn].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">k &lt;= <span class="mi">0</span> -&gt;
\sum_(i &lt; <span class="mi">0</span>) fmerge f g i &lt;=
\sum_(i &lt; k) f i + \sum_(i &lt; <span class="mi">0</span> - k) g i</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk251" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n.+<span class="mi">1</span></span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk251"><hr></label><div class="goal-conclusion"><span class="highlight">\sum_(i &lt; n.+<span class="mi">1</span>) fmerge f g i &lt;=
\sum_(i &lt; k) f i + \sum_(i &lt; n.+<span class="mi">1</span> - k) g i</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk252" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk252"><span class="highlight"><span class="bp">by</span> <span class="nb">case</span>: k; <span class="nb">rewrite</span> // !big_ord0.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n.+<span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">\sum_(i &lt; n.+<span class="mi">1</span>) fmerge f g i &lt;=
\sum_(i &lt; k) f i + \sum_(i &lt; n.+<span class="mi">1</span> - k) g i</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk253" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk253"><span class="highlight"><span class="nb">rewrite</span> -sum_fmerge_correct.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n.+<span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">sum_fmerge f g n &lt;=
\sum_(i &lt; k) f i + \sum_(i &lt; n.+<span class="mi">1</span> - k) g i</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">exact</span>: (sum_fmerge_aux_conv_correct <span class="mi">0</span> <span class="mi">0</span> fI gI kLn).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk254" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk254"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">sum_fmerge_aux_exist</span> <span class="nv">f</span> <span class="nv">g</span> <span class="nv">i</span> <span class="nv">j</span> <span class="nv">n</span> :
  <span class="kr">exists2</span> k, k &lt;= n.+<span class="mi">1</span> &amp; 
  sum_fmerge_aux f g i j n =     
  \sum_(l &lt; k) f (i + l) + \sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists2</span> k : nat,
  k &lt;= n.+<span class="mi">1</span> &amp;
  sum_fmerge_aux f g i j n =
  \sum_(l &lt; k) f (i + l) +
  \sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk255" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk255"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j, n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists2</span> k : nat,
  k &lt;= n.+<span class="mi">1</span> &amp;
  sum_fmerge_aux f g i j n =
  \sum_(l &lt; k) f (i + l) +
  \sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk256" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk256"><span class="highlight"><span class="nb">elim</span>: n i j =&gt; /= [i j | n IH i j].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists2</span> k : nat,
  k &lt;= <span class="mi">1</span> &amp;
  minn (f i) (g j) =
  \sum_(l &lt; k) f (i + l) + \sum_(l &lt; <span class="mi">1</span> - k) g (j + l)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk257" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> : nat,
<span class="kr">exists2</span> k : nat,
  k &lt;= n.+<span class="mi">1</span> &amp;
  sum_fmerge_aux f g i j n =
  \sum_(l &lt; k) f (i + l) +
  \sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk257"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists2</span> k : nat,
  k &lt;= n.+<span class="mi">2</span> &amp;
  (<span class="kr">if</span> f i &lt; g j
   <span class="kr">then</span> f i + sum_fmerge_aux f g i.+<span class="mi">1</span> j n
   <span class="kr">else</span> g j + sum_fmerge_aux f g i j.+<span class="mi">1</span> n) =
  \sum_(l &lt; k) f (i + l) +
  \sum_(l &lt; n.+<span class="mi">2</span> - k) g (j + l)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk258" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk258"><span class="highlight"><span class="nb">rewrite</span> /minn; <span class="nb">case</span>: leqP =&gt; [gLf|fLg].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gLf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g j &lt;= f i</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists2</span> k : nat,
  k &lt;= <span class="mi">1</span> &amp;
  g j =
  \sum_(l &lt; k) f (i + l) + \sum_(l &lt; <span class="mi">1</span> - k) g (j + l)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk259" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk259"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists2</span> k : nat,
  k &lt;= <span class="mi">1</span> &amp;
  f i =
  \sum_(l &lt; k) f (i + l) + \sum_(l &lt; <span class="mi">1</span> - k) g (j + l)</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="extra-v-chk25a" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> : nat,
<span class="kr">exists2</span> k : nat,
  k &lt;= n.+<span class="mi">1</span> &amp;
  sum_fmerge_aux f g i j n =
  \sum_(l &lt; k) f (i + l) +
  \sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk25a"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists2</span> k : nat,
  k &lt;= n.+<span class="mi">2</span> &amp;
  (<span class="kr">if</span> f i &lt; g j
   <span class="kr">then</span> f i + sum_fmerge_aux f g i.+<span class="mi">1</span> j n
   <span class="kr">else</span> g j + sum_fmerge_aux f g i j.+<span class="mi">1</span> n) =
  \sum_(l &lt; k) f (i + l) +
  \sum_(l &lt; n.+<span class="mi">2</span> - k) g (j + l)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk25b" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk25b"><span class="highlight"><span class="bp">by</span> <span class="kr">exists</span> <span class="mi">0</span>; <span class="nb">rewrite</span> // big_ord_recl !big_ord0 !(add0n, addn0).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists2</span> k : nat,
  k &lt;= <span class="mi">1</span> &amp;
  f i =
  \sum_(l &lt; k) f (i + l) + \sum_(l &lt; <span class="mi">1</span> - k) g (j + l)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk25c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> : nat,
<span class="kr">exists2</span> k : nat,
  k &lt;= n.+<span class="mi">1</span> &amp;
  sum_fmerge_aux f g i j n =
  \sum_(l &lt; k) f (i + l) +
  \sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk25c"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists2</span> k : nat,
  k &lt;= n.+<span class="mi">2</span> &amp;
  (<span class="kr">if</span> f i &lt; g j
   <span class="kr">then</span> f i + sum_fmerge_aux f g i.+<span class="mi">1</span> j n
   <span class="kr">else</span> g j + sum_fmerge_aux f g i j.+<span class="mi">1</span> n) =
  \sum_(l &lt; k) f (i + l) +
  \sum_(l &lt; n.+<span class="mi">2</span> - k) g (j + l)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk25d" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk25d"><span class="highlight"><span class="bp">by</span> <span class="kr">exists</span> <span class="mi">1</span>; <span class="nb">rewrite</span> // subnn big_ord_recl !big_ord0 !(add0n, addn0).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> : nat,
<span class="kr">exists2</span> k : nat,
  k &lt;= n.+<span class="mi">1</span> &amp;
  sum_fmerge_aux f g i j n =
  \sum_(l &lt; k) f (i + l) +
  \sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists2</span> k : nat,
  k &lt;= n.+<span class="mi">2</span> &amp;
  (<span class="kr">if</span> f i &lt; g j
   <span class="kr">then</span> f i + sum_fmerge_aux f g i.+<span class="mi">1</span> j n
   <span class="kr">else</span> g j + sum_fmerge_aux f g i j.+<span class="mi">1</span> n) =
  \sum_(l &lt; k) f (i + l) +
  \sum_(l &lt; n.+<span class="mi">2</span> - k) g (j + l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk25e" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk25e"><span class="highlight"><span class="nb">case</span>: (leqP (g j) (f i)) =&gt; [gLf|fLg].</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> : nat,
<span class="kr">exists2</span> k : nat,
  k &lt;= n.+<span class="mi">1</span> &amp;
  sum_fmerge_aux f g i j n =
  \sum_(l &lt; k) f (i + l) +
  \sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gLf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g j &lt;= f i</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists2</span> k : nat,
  k &lt;= n.+<span class="mi">2</span> &amp;
  g j + sum_fmerge_aux f g i j.+<span class="mi">1</span> n =
  \sum_(l &lt; k) f (i + l) +
  \sum_(l &lt; n.+<span class="mi">2</span> - k) g (j + l)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk25f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> : nat,
<span class="kr">exists2</span> k : nat,
  k &lt;= n.+<span class="mi">1</span> &amp;
  sum_fmerge_aux f g i j n =
  \sum_(l &lt; k) f (i + l) +
  \sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk25f"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists2</span> k : nat,
  k &lt;= n.+<span class="mi">2</span> &amp;
  f i + sum_fmerge_aux f g i.+<span class="mi">1</span> j n =
  \sum_(l &lt; k) f (i + l) +
  \sum_(l &lt; n.+<span class="mi">2</span> - k) g (j + l)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk260" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk260"><span class="highlight"><span class="nb">case</span>: (IH i j.+<span class="mi">1</span>) =&gt; k kLn -&gt;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> : nat,
<span class="kr">exists2</span> k : nat,
  k &lt;= n.+<span class="mi">1</span> &amp;
  sum_fmerge_aux f g i j n =
  \sum_(l &lt; k) f (i + l) +
  \sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gLf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g j &lt;= f i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n.+<span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">ex2 (<span class="kr">fun</span> <span class="nv">k</span> : nat =&gt; k &lt;= n.+<span class="mi">2</span>)
  (<span class="kr">fun</span> <span class="nv">k0</span> : nat =&gt;
   g j +
   (\sum_(l &lt; k) f (i + l) +
    \sum_(l &lt; n.+<span class="mi">1</span> - k) g (j.+<span class="mi">1</span> + l)) =
   \sum_(l &lt; k0) f (i + l) +
   \sum_(l &lt; n.+<span class="mi">2</span> - k0) g (j + l))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk261" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> : nat,
<span class="kr">exists2</span> k : nat,
  k &lt;= n.+<span class="mi">1</span> &amp;
  sum_fmerge_aux f g i j n =
  \sum_(l &lt; k) f (i + l) +
  \sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk261"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists2</span> k : nat,
  k &lt;= n.+<span class="mi">2</span> &amp;
  f i + sum_fmerge_aux f g i.+<span class="mi">1</span> j n =
  \sum_(l &lt; k) f (i + l) +
  \sum_(l &lt; n.+<span class="mi">2</span> - k) g (j + l)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk262" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk262"><span class="highlight"><span class="kr">exists</span> <span class="nv">k</span>; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">apply</span>: leq_trans kLn _.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> : nat,
<span class="kr">exists2</span> k : nat,
  k &lt;= n.+<span class="mi">1</span> &amp;
  sum_fmerge_aux f g i j n =
  \sum_(l &lt; k) f (i + l) +
  \sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gLf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g j &lt;= f i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n.+<span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">g j +
(\sum_(l &lt; k) f (i + l) +
 \sum_(l &lt; n.+<span class="mi">1</span> - k) g (j.+<span class="mi">1</span> + l)) =
\sum_(l &lt; k) f (i + l) + \sum_(l &lt; n.+<span class="mi">2</span> - k) g (j + l)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk263" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> : nat,
<span class="kr">exists2</span> k : nat,
  k &lt;= n.+<span class="mi">1</span> &amp;
  sum_fmerge_aux f g i j n =
  \sum_(l &lt; k) f (i + l) +
  \sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk263"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists2</span> k : nat,
  k &lt;= n.+<span class="mi">2</span> &amp;
  f i + sum_fmerge_aux f g i.+<span class="mi">1</span> j n =
  \sum_(l &lt; k) f (i + l) +
  \sum_(l &lt; n.+<span class="mi">2</span> - k) g (j + l)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk264" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk264"><span class="highlight"><span class="nb">rewrite</span> (subSn kLn) big_ord_recl addn0 addnCA.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> : nat,
<span class="kr">exists2</span> k : nat,
  k &lt;= n.+<span class="mi">1</span> &amp;
  sum_fmerge_aux f g i j n =
  \sum_(l &lt; k) f (i + l) +
  \sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gLf</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">g j &lt;= f i</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n.+<span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">\sum_(l &lt; k) f (i + l) +
(g j + \sum_(l &lt; n.+<span class="mi">1</span> - k) g (j.+<span class="mi">1</span> + l)) =
\sum_(l &lt; k) f (i + l) +
(g j + \sum_(i &lt; n.+<span class="mi">1</span> - k) g (j + lift ord0 i))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk265" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> : nat,
<span class="kr">exists2</span> k : nat,
  k &lt;= n.+<span class="mi">1</span> &amp;
  sum_fmerge_aux f g i j n =
  \sum_(l &lt; k) f (i + l) +
  \sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk265"><hr></label><div class="goal-conclusion"><span class="highlight"><span class="kr">exists2</span> k : nat,
  k &lt;= n.+<span class="mi">2</span> &amp;
  f i + sum_fmerge_aux f g i.+<span class="mi">1</span> j n =
  \sum_(l &lt; k) f (i + l) +
  \sum_(l &lt; n.+<span class="mi">2</span> - k) g (j + l)</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk266" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk266"><span class="highlight"><span class="bp">by</span> <span class="nb">congr</span> (_ + (_ + _)); <span class="nb">apply</span>: eq_bigr =&gt; l _; <span class="nb">rewrite</span> addnCA.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> : nat,
<span class="kr">exists2</span> k : nat,
  k &lt;= n.+<span class="mi">1</span> &amp;
  sum_fmerge_aux f g i j n =
  \sum_(l &lt; k) f (i + l) +
  \sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists2</span> k : nat,
  k &lt;= n.+<span class="mi">2</span> &amp;
  f i + sum_fmerge_aux f g i.+<span class="mi">1</span> j n =
  \sum_(l &lt; k) f (i + l) +
  \sum_(l &lt; n.+<span class="mi">2</span> - k) g (j + l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk267" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk267"><span class="highlight"><span class="nb">case</span>: (IH i.+<span class="mi">1</span> j) =&gt; k kLn -&gt;; <span class="kr">exists</span> <span class="nv">k</span>.+<span class="mi">1</span>; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">apply</span>: leq_trans kLn _.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> : nat,
<span class="kr">exists2</span> k : nat,
  k &lt;= n.+<span class="mi">1</span> &amp;
  sum_fmerge_aux f g i j n =
  \sum_(l &lt; k) f (i + l) +
  \sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n.+<span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f i +
(\sum_(l &lt; k) f (i.+<span class="mi">1</span> + l) +
 \sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)) =
\sum_(l &lt; k.+<span class="mi">1</span>) f (i + l) +
\sum_(l &lt; n.+<span class="mi">2</span> - k.+<span class="mi">1</span>) g (j + l)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk268" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk268"><span class="highlight"><span class="nb">rewrite</span> big_ord_recl addn0 subSS -addnA.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">IH</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight"><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> : nat,
<span class="kr">exists2</span> k : nat,
  k &lt;= n.+<span class="mi">1</span> &amp;
  sum_fmerge_aux f g i j n =
  \sum_(l &lt; k) f (i + l) +
  \sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">i, j</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fLg</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">f i &lt; g j</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n.+<span class="mi">1</span></span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">f i +
(\sum_(l &lt; k) f (i.+<span class="mi">1</span> + l) +
 \sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l)) =
f i +
(\sum_(i0 &lt; k) f (i + lift ord0 i0) +
 \sum_(l &lt; n.+<span class="mi">1</span> - k) g (j + l))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">congr</span> (_ + (_ + _)); <span class="nb">apply</span>: eq_bigr =&gt; l _; <span class="nb">rewrite</span> addnCA.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk269" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk269"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">sum_fmerge_exist</span> <span class="nv">f</span> <span class="nv">g</span> <span class="nv">n</span> :
  <span class="kr">exists2</span> k, k &lt;= n &amp; 
  \sum_(i &lt; n) fmerge f g i = \sum_(i &lt; k) f i + \sum_(i &lt; n - k) g i.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists2</span> k : nat,
  k &lt;= n &amp;
  \sum_(i &lt; n) fmerge f g i =
  \sum_(i &lt; k) f i + \sum_(i &lt; n - k) g i</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk26a" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk26a"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists2</span> k : nat,
  k &lt;= n &amp;
  \sum_(i &lt; n) fmerge f g i =
  \sum_(i &lt; k) f i + \sum_(i &lt; n - k) g i</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk26b" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk26b"><span class="highlight"><span class="nb">case</span>: n =&gt; [|n]; <span class="kp">first</span> <span class="bp">by</span> <span class="kr">exists</span> <span class="mi">0</span>; <span class="nb">rewrite</span> // !big_ord0.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists2</span> k : nat,
  k &lt;= n.+<span class="mi">1</span> &amp;
  \sum_(i &lt; n.+<span class="mi">1</span>) fmerge f g i =
  \sum_(i &lt; k) f i + \sum_(i &lt; n.+<span class="mi">1</span> - k) g i</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk26c" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk26c"><span class="highlight"><span class="nb">case</span>: (sum_fmerge_aux_exist f g <span class="mi">0</span> <span class="mi">0</span> n) =&gt; k kLn sE.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n.+<span class="mi">1</span></span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">sE</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">sum_fmerge_aux f g <span class="mi">0</span> <span class="mi">0</span> n =
\sum_(l &lt; k) f (<span class="mi">0</span> + l) +
\sum_(l &lt; n.+<span class="mi">1</span> - k) g (<span class="mi">0</span> + l)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight"><span class="kr">exists2</span> k : nat,
  k &lt;= n.+<span class="mi">1</span> &amp;
  \sum_(i &lt; n.+<span class="mi">1</span>) fmerge f g i =
  \sum_(i &lt; k) f i + \sum_(i &lt; n.+<span class="mi">1</span> - k) g i</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="kr">exists</span> <span class="nv">k</span>; <span class="nb">rewrite</span> // -sum_fmerge_correct [LHS]sE.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk26d" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk26d"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">sum_fmerge_conv</span> <span class="nv">f</span> <span class="nv">g</span> <span class="nv">n</span> : 
  increasing f -&gt; increasing g -&gt;
  \sum_(i &lt; n) (fmerge f g) i  =
     conv (<span class="kr">fun</span> <span class="nv">n</span> =&gt; \sum_(i &lt; n) f i) (<span class="kr">fun</span> <span class="nv">n</span> =&gt; \sum_(i &lt; n) g i) n.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">increasing f -&gt;
increasing g -&gt;
\sum_(i &lt; n) fmerge f g i =
conv (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt; \sum_(i &lt; n) f i)
  (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt; \sum_(i &lt; n) g i) n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk26e" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk26e"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">increasing f -&gt;
increasing g -&gt;
\sum_(i &lt; n) fmerge f g i =
conv (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt; \sum_(i &lt; n) f i)
  (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt; \sum_(i &lt; n) g i) n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk26f" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk26f"><span class="highlight"><span class="nb">move</span>=&gt; fI gI.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">\sum_(i &lt; n) fmerge f g i =
conv (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt; \sum_(i &lt; n) f i)
  (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt; \sum_(i &lt; n) g i) n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk270" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk270"><span class="highlight"><span class="nb">apply</span>/eqP; <span class="nb">rewrite</span> eqn_leq; <span class="nb">apply</span>/andP; <span class="nb">split</span>; <span class="nb">last first</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">conv (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt; \sum_(i &lt; n) f i)
  (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt; \sum_(i &lt; n) g i) n &lt;=
\sum_(i &lt; n) fmerge f g i</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk271" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk271"><hr></label><div class="goal-conclusion"><span class="highlight">\sum_(i &lt; n) fmerge f g i &lt;=
conv (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt; \sum_(i &lt; n) f i)
  (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt; \sum_(i &lt; n) g i) n</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk272" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk272"><span class="highlight"><span class="nb">case</span>: (sum_fmerge_exist f g n) =&gt; k kLn -&gt;.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">conv (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt; \sum_(i &lt; n) f i)
  (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt; \sum_(i &lt; n) g i) n &lt;=
\sum_(i &lt; k) f i + \sum_(i &lt; n - k) g i</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk273" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk273"><hr></label><div class="goal-conclusion"><span class="highlight">\sum_(i &lt; n) fmerge f g i &lt;=
conv (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt; \sum_(i &lt; n) f i)
  (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt; \sum_(i &lt; n) g i) n</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk274" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk274"><span class="highlight"><span class="bp">by</span> <span class="nb">apply</span>: (bigmin_inf _ (leqnn _)).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">\sum_(i &lt; n) fmerge f g i &lt;=
conv (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt; \sum_(i &lt; n) f i)
  (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt; \sum_(i &lt; n) g i) n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk275" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk275"><span class="highlight"><span class="nb">apply</span>/bigmin_leqP =&gt; k kLn.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">kLn</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">k &lt;= n</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">\sum_(i &lt; n) fmerge f g i &lt;=
\sum_(i &lt; k) f i + \sum_(i &lt; n - k) g i</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">apply</span>: leq_sum_fmerge_conv.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
<span class="c">(* This is 3.2 *)</span>
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk276" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk276"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">delta_conv</span> <span class="nv">f</span> <span class="nv">g</span> : 
  convex f -&gt; convex g -&gt; delta (conv f g) =<span class="mi">1</span> fmerge (delta f) (delta g).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">convex f -&gt;
convex g -&gt;
delta (conv f g) =<span class="mi">1</span> fmerge (delta f) (delta g)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk277" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk277"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">convex f -&gt;
convex g -&gt;
delta (conv f g) =<span class="mi">1</span> fmerge (delta f) (delta g)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk278" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk278"><span class="highlight"><span class="nb">move</span>=&gt; [fI dfI] [gI dgI] n.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dfI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing (delta f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dgI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing (delta g)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">delta (conv f g) n = fmerge (delta f) (delta g) n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk279" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk279"><span class="highlight"><span class="nb">rewrite</span> -delta_fnorm; <span class="nb">last</span> <span class="bp">by</span> <span class="nb">apply</span>: increasing_conv.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dfI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing (delta f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dgI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing (delta g)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">delta (fnorm (conv f g)) n =
fmerge (delta f) (delta g) n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk27a" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk27a"><span class="highlight"><span class="nb">rewrite</span> -(delta_ext (conv_fnorm _ _)) //.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dfI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing (delta f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dgI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing (delta g)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">delta (conv (fnorm f) (fnorm g)) n =
fmerge (delta f) (delta g) n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk27b" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk27b"><span class="highlight"><span class="nb">have</span>/delta_ext-&gt; : conv (fnorm f) (fnorm g) =<span class="mi">1</span>
         conv (<span class="kr">fun</span> <span class="nv">n</span> =&gt; \sum_(i &lt; n) (delta (fnorm f)) i) 
              (<span class="kr">fun</span> <span class="nv">n</span> =&gt; \sum_(i &lt; n) (delta (fnorm g)) i).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dfI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing (delta f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dgI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing (delta g)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">conv (fnorm f) (fnorm g) =<span class="mi">1</span>
conv (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt; \sum_(i &lt; n) delta (fnorm f) i)
  (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt; \sum_(i &lt; n) delta (fnorm g) i)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk27c" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dfI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing (delta f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dgI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing (delta g)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk27c"><hr></label><div class="goal-conclusion"><span class="highlight">delta
  (conv
     (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt; \sum_(i &lt; n) delta (fnorm f) i)
     (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt; \sum_(i &lt; n) delta (fnorm g) i))
  n = fmerge (delta f) (delta g) n</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk27d" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk27d"><span class="highlight"><span class="bp">by</span> <span class="nb">apply</span>: conv_ext =&gt; i; <span class="nb">apply</span>: sum_delta.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dfI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing (delta f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dgI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing (delta g)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">delta
  (conv
     (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt; \sum_(i &lt; n) delta (fnorm f) i)
     (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt; \sum_(i &lt; n) delta (fnorm g) i))
  n = fmerge (delta f) (delta g) n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk27e" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk27e"><span class="highlight"><span class="nb">have</span>/delta_ext-&gt; :
  (conv (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt; \sum_(i &lt; n) delta (fnorm f) i)
        (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt; \sum_(i &lt; n) delta (fnorm g) i)) =<span class="mi">1</span>
  (<span class="kr">fun</span> <span class="nv">n</span> =&gt; \sum_(i &lt; n) (fmerge (delta (fnorm f)) (delta (fnorm g))) i).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dfI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing (delta f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dgI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing (delta g)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">conv (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt; \sum_(i &lt; n) delta (fnorm f) i)
  (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt; \sum_(i &lt; n) delta (fnorm g) i) =<span class="mi">1</span>
(<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt;
 \sum_(i &lt; n)
    fmerge (delta (fnorm f)) (delta (fnorm g)) i)</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk27f" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dfI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing (delta f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dgI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing (delta g)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk27f"><hr></label><div class="goal-conclusion"><span class="highlight">delta
  (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt;
   \sum_(i &lt; n)
      fmerge (delta (fnorm f)) (delta (fnorm g)) i) n =
fmerge (delta f) (delta g) n</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk280" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk280"><span class="highlight"><span class="nb">move</span>=&gt; k; <span class="nb">rewrite</span> -sum_fmerge_conv //.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dfI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing (delta f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dgI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing (delta g)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">increasing (delta (fnorm f))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk281" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dfI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing (delta f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dgI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing (delta g)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk281"><hr></label><div class="goal-conclusion"><span class="highlight">increasing (delta (fnorm g))</span></div></blockquote><input class="alectryon-extra-goal-toggle" id="extra-v-chk282" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dfI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing (delta f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dgI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing (delta g)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk282"><hr></label><div class="goal-conclusion"><span class="highlight">delta
  (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt;
   \sum_(i &lt; n)
      fmerge (delta (fnorm f)) (delta (fnorm g)) i) n =
fmerge (delta f) (delta g) n</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk283" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk283"><span class="highlight"><span class="bp">by</span> <span class="nb">apply</span>: increasing_ext dfI =&gt; i; <span class="nb">rewrite</span> delta_fnorm.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dfI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing (delta f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dgI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing (delta g)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n, k</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">increasing (delta (fnorm g))</span></div></blockquote><div class="alectryon-extra-goals"><input class="alectryon-extra-goal-toggle" id="extra-v-chk284" style="display: none" type="checkbox"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dfI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing (delta f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dgI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing (delta g)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><label class="goal-separator alectryon-extra-goal-label" for="extra-v-chk284"><hr></label><div class="goal-conclusion"><span class="highlight">delta
  (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt;
   \sum_(i &lt; n)
      fmerge (delta (fnorm f)) (delta (fnorm g)) i) n =
fmerge (delta f) (delta g) n</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk285" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk285"><span class="highlight"><span class="bp">by</span> <span class="nb">apply</span>: increasing_ext dgI =&gt; i; <span class="nb">rewrite</span> delta_fnorm.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dfI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing (delta f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dgI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing (delta g)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">delta
  (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt;
   \sum_(i &lt; n)
      fmerge (delta (fnorm f)) (delta (fnorm g)) i) n =
fmerge (delta f) (delta g) n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk286" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk286"><span class="highlight"><span class="nb">rewrite</span> /delta big_ord_recr /= addnC addnK.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dfI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing (delta f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dgI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing (delta g)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">n</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">fmerge (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt; fnorm f n.+<span class="mi">1</span> - fnorm f n)
  (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt; fnorm g n.+<span class="mi">1</span> - fnorm g n) n =
fmerge (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt; f n.+<span class="mi">1</span> - f n)
  (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt; g n.+<span class="mi">1</span> - g n) n</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">apply</span>: fmerge_aux_ext =&gt; i; <span class="nb">apply</span>: delta_fnorm.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk287" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk287"><span class="highlight"><span class="kn">Lemma</span> <span class="nf">convex_conv</span> <span class="nv">f</span> <span class="nv">g</span> : convex f -&gt; convex g -&gt; convex (conv f g).</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">convex f -&gt; convex g -&gt; convex (conv f g)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk288" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk288"><span class="highlight"><span class="kn">Proof</span>.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">convex f -&gt; convex g -&gt; convex (conv f g)</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk289" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk289"><span class="highlight"><span class="nb">move</span>=&gt; [fI dfI] [gI dgI]; <span class="nb">split</span>; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">apply</span>: increasing_conv.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dfI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing (delta f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dgI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing (delta g)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">increasing (delta (conv f g))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><input class="alectryon-toggle" id="extra-v-chk28a" style="display: none" type="checkbox"><label class="alectryon-input" for="extra-v-chk28a"><span class="highlight"><span class="nb">apply</span>: increasing_ext =&gt; [i|]; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">apply</span>/sym_equal/delta_conv.</span></label><small class="alectryon-output"><div class="alectryon-output-sticky-wrapper"><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div class="goal-hyp"><span class="hyp-names">f, g</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">nat -&gt; nat</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">fI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing f</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dfI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing (delta f)</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">gI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing g</span></span></span></span></div><div class="goal-hyp"><span class="hyp-names">dgI</span><span><span class="hyp-type-block"><span class="hyp-punct">:</span><span class="hyp-type"><span class="highlight">increasing (delta g)</span></span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="highlight">increasing (fmerge (delta f) (delta g))</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="bp">by</span> <span class="nb">apply</span>: increasing_fmerge.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Qed</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">End</span> <span class="nf">Convex</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Notation</span> <span class="s2">&quot;\min_ ( i &lt;= n ) F&quot;</span> := (bigmin (<span class="kr">fun</span> <span class="nv">i</span> =&gt; F) n)
 (<span class="kn">at level</span> <span class="mi">41</span>, F <span class="kn">at level</span> <span class="mi">41</span>, i, n <span class="kn">at level</span> <span class="mi">50</span>,
  <span class="kn">format</span> <span class="s2">&quot;\min_ ( i  &lt;=  n )  F&quot;</span>).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">

<span class="c">(* Mimic AC match for leq_trans *)</span>
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Ltac</span> <span class="nf">is_num</span> term :=
 <span class="kr">match</span> term <span class="kr">with</span> 
 | <span class="mi">0</span> =&gt; true 
 | S <span class="nl">?X</span> =&gt; is_num X
 | _ =&gt; false
<span class="kr">end</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Ltac</span> <span class="nf">split_term</span> term :=
 <span class="kr">match</span> term <span class="kr">with</span> 
 | <span class="nl">?X</span> * <span class="nl">?Y</span> =&gt; <span class="kr">match</span> is_num X <span class="kr">with</span> true =&gt;  <span class="kp">constr</span>:((X, Y))
              | false =&gt; 
              <span class="kr">let</span> <span class="nv">v</span> := <span class="kp">once</span> (split_term X) <span class="kr">in</span> <span class="kp">constr</span>:((fst v, snd v * Y)) 
              <span class="kr">end</span>
 | <span class="nl">?X</span> =&gt; <span class="kr">match</span> is_num X <span class="kr">with</span> true =&gt; <span class="kp">constr</span>:((X, <span class="mi">1</span>)) 
                             | _ =&gt; <span class="kp">constr</span>:((<span class="mi">1</span>, X)) <span class="kr">end</span>
 | _ =&gt; false
<span class="kr">end</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">

</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Ltac</span> <span class="nf">delta_term</span> n1 n2 t2 :=
  <span class="kr">let</span> <span class="nv">n</span> :=  <span class="kp">constr</span>:(n1 - n2) <span class="kr">in</span>
  <span class="kr">let</span> <span class="nv">n1</span> := <span class="kp">eval</span> <span class="nb">compute</span> <span class="kr">in</span> n <span class="kr">in</span>
  <span class="kr">let</span> <span class="nv">vt2</span> := <span class="kp">eval</span> <span class="nb">lazy</span> delta [fst snd] iota beta <span class="kr">in</span> t2 <span class="kr">in</span> 
  <span class="kr">let</span> <span class="nv">r</span> :=
    <span class="kr">match</span> n1 <span class="kr">with</span> 
    | <span class="mi">0</span> =&gt; <span class="kp">constr</span>:(<span class="mi">0</span>) 
    | <span class="mi">1</span> =&gt; <span class="kp">constr</span>:(t2) 
    | <span class="nl">?X</span>  =&gt; 
    <span class="kr">match</span> vt2 <span class="kr">with</span> | <span class="mi">1</span> =&gt; X | _ =&gt; <span class="kp">constr</span>:(X * vt2) <span class="kr">end</span>
    <span class="kr">end</span> <span class="kr">in</span>
   <span class="kp">eval</span> <span class="nb">lazy</span> delta [fst snd] iota beta <span class="kr">in</span> r.</span></span><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp"><span class="highlight">    
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Ltac</span> <span class="nf">delta_lterm2</span> n1 t1 lt2 :=
 <span class="kr">match</span> lt2 <span class="kr">with</span> 
 |  <span class="nl">?X2</span> + <span class="nl">?Y2</span> =&gt;
     <span class="kr">let</span> <span class="nv">v2</span> := split_term Y2 <span class="kr">in</span>
     <span class="kr">let</span> <span class="nv">n2</span> := <span class="kp">constr</span>:(fst v2) <span class="kr">in</span>
     <span class="kr">let</span> <span class="nv">t2</span> := <span class="kp">constr</span>:(snd v2) <span class="kr">in</span>
     <span class="kr">let</span> <span class="nv">t</span> := <span class="kp">constr</span>:((t1, t2)) <span class="kr">in</span>
     <span class="kr">let</span> <span class="nv">vt</span> := <span class="kp">eval</span> <span class="nb">lazy</span> delta [fst snd] iota beta <span class="kr">in</span> t <span class="kr">in</span> 
     <span class="kr">match</span> vt <span class="kr">with</span> 
     | (<span class="nl">?X</span>, <span class="nl">?X</span>) =&gt; delta_term n1 n2 t2
     |  _  =&gt; delta_lterm2 n1 t1 X2
     <span class="kr">end</span>
 |   <span class="nl">?Y2</span> =&gt;
     <span class="kr">let</span> <span class="nv">v2</span> := split_term Y2 <span class="kr">in</span>
     <span class="kr">let</span> <span class="nv">n2</span> := <span class="kp">constr</span>:(fst v2) <span class="kr">in</span>
     <span class="kr">let</span> <span class="nv">t2</span> := <span class="kp">constr</span>:(snd v2) <span class="kr">in</span> 
     <span class="kr">let</span> <span class="nv">t</span> := <span class="kp">constr</span>:((t1, t2)) <span class="kr">in</span>
     <span class="kr">let</span> <span class="nv">vt</span> := <span class="kp">eval</span> <span class="nb">lazy</span> delta [fst snd] iota beta <span class="kr">in</span> t <span class="kr">in</span> 
     <span class="kr">match</span> vt <span class="kr">with</span> 
     | (<span class="nl">?X</span>, <span class="nl">?X</span>) =&gt; delta_term n1 n2 t2
     |  _  =&gt; delta_term n1 <span class="mi">0</span> t1
     <span class="kr">end</span>
<span class="kr">end</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Ltac</span> <span class="nf">make_sum</span> t1 t2 :=
  <span class="kr">match</span> t1 <span class="kr">with</span> <span class="mi">0</span> =&gt; t2 | _ =&gt; 
  <span class="kr">match</span> t2 <span class="kr">with</span> <span class="mi">0</span> =&gt; t1 | _ =&gt; <span class="kp">constr</span>:(t1 + t2) <span class="kr">end</span> <span class="kr">end</span>.</span></span><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp"><span class="highlight">  
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Ltac</span> <span class="nf">delta_lterm1</span> lt1 lt2 :=
 <span class="kr">match</span> lt1 <span class="kr">with</span> 
 |  <span class="nl">?X1</span> + <span class="nl">?Y1</span> =&gt;
     <span class="kr">let</span> <span class="nv">v1</span> := split_term Y1 <span class="kr">in</span>
     <span class="kr">let</span> <span class="nv">n1</span> := <span class="kp">constr</span>:(fst v1) <span class="kr">in</span>
     <span class="kr">let</span> <span class="nv">t1</span> := <span class="kp">constr</span>:(snd v1) <span class="kr">in</span> 
     <span class="kr">let</span> <span class="nv">r1</span> := delta_lterm1 X1 lt2 <span class="kr">in</span>
     <span class="kr">let</span> <span class="nv">r2</span> := delta_lterm2 n1 t1 lt2 <span class="kr">in</span> make_sum r1 r2

 |   <span class="nl">?Y1</span> =&gt;
     <span class="kr">let</span> <span class="nv">v1</span> := split_term Y1 <span class="kr">in</span>
     <span class="kr">let</span> <span class="nv">n1</span> := <span class="kp">constr</span>:(fst v1) <span class="kr">in</span>
     <span class="kr">let</span> <span class="nv">t1</span> := <span class="kp">constr</span>:(snd v1) <span class="kr">in</span> delta_lterm2 n1 t1 lt2
<span class="kr">end</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Ltac</span> <span class="nf">test</span> t1 t2 := <span class="kr">let</span> <span class="nv">xx</span> := delta_lterm1 t1 t2 <span class="kr">in</span> <span class="nb">pose</span> kk := xx.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Ltac</span> <span class="nf">applyr</span> H :=
  <span class="nb">rewrite</span> -<span class="nl">?mul2n</span> <span class="kr">in</span> H |- *;
  <span class="kr">match goal with</span> 
  H: is_true (leq _ <span class="nl">?X</span>) |- is_true (leq _ <span class="nl">?Y</span>) =&gt;
    <span class="nb">ring_simplify</span> X Y <span class="kr">in</span> H;
    <span class="nb">ring_simplify</span> X Y; <span class="nb">rewrite</span> ?[nat_of_bin _]/= <span class="kr">in</span> H |- *
  <span class="kr">end</span>;
  <span class="kr">let</span> <span class="nv">Z</span> := <span class="kp">fresh</span> <span class="s2">&quot;Z&quot;</span> <span class="kr">in</span>
  <span class="kr">match goal with</span> 
  H: is_true (leq _ <span class="nl">?X1</span>) |- is_true (leq _ <span class="nl">?Y1</span>) =&gt;
    <span class="kr">let</span> <span class="nv">v</span> := delta_lterm1 Y1 X1 <span class="kr">in</span>
    (<span class="kp">try</span> (<span class="nb">rewrite</span> [Z <span class="kr">in</span> _ &lt;= Z](_ : _ = v + X1))); 
    [ <span class="nb">apply</span>: leq_trans (leq_add (leqnn _) H); <span class="nb">rewrite</span> {H}// ?(add0n,addn0) 
     | <span class="bp">ring</span>]
  <span class="kr">end</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">  
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Ltac</span> <span class="nf">applyl</span> H :=
  <span class="nb">rewrite</span> -<span class="nl">?mul2n</span> <span class="kr">in</span> H |- *;
  <span class="kr">match goal with</span> 
  H: is_true (leq <span class="nl">?X</span> _) |- is_true (leq <span class="nl">?Y</span> _) =&gt;
    <span class="nb">ring_simplify</span> X Y; <span class="nb">ring_simplify</span> X Y <span class="kr">in</span> H;
    <span class="nb">rewrite</span> ?[nat_of_bin _]/= <span class="kr">in</span> H |- *
  <span class="kr">end</span>;
  <span class="kr">let</span> <span class="nv">Z</span> := <span class="kp">fresh</span> <span class="s2">&quot;Z&quot;</span> <span class="kr">in</span>
  <span class="kr">match goal with</span> 
  H: is_true (leq <span class="nl">?X1</span> _) |- is_true (leq <span class="nl">?Y1</span> _) =&gt;
    <span class="kr">let</span> <span class="nv">v</span> := delta_lterm1 Y1 X1 <span class="kr">in</span>
    (<span class="kp">try</span> <span class="nb">rewrite</span> [Z <span class="kr">in</span> Z &lt;= _](_ : Y1 = v + X1));
    [<span class="nb">apply</span>: leq_trans (leq_add (leqnn _) H) _;
     <span class="nb">rewrite</span> {H}// ?(add0n,addn0) | <span class="bp">ring</span>]
  <span class="kr">end</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Ltac</span> <span class="nf">gsimpl</span> :=
  <span class="nb">rewrite</span> -<span class="nl">?mul2n</span> <span class="kr">in</span> |- *;
  <span class="kr">match goal with</span> 
  |- is_true (leq <span class="nl">?X</span> <span class="nl">?Y</span>) =&gt;
    <span class="nb">ring_simplify</span> X Y; <span class="nb">rewrite</span> ?[nat_of_bin _]/=
  <span class="kr">end</span>;
  <span class="kr">let</span> <span class="nv">Z</span> := <span class="kp">fresh</span> <span class="s2">&quot;Z&quot;</span> <span class="kr">in</span>
  <span class="kr">match goal with</span> 
    |- is_true (leq <span class="nl">?X1</span> <span class="nl">?Y1</span>) =&gt;
    <span class="kr">let</span> <span class="nv">v</span> := delta_lterm1 Y1 X1 <span class="kr">in</span>
    <span class="kr">match</span> v <span class="kr">with</span> 
    | <span class="mi">0</span> =&gt; 
    <span class="kr">let</span> <span class="nv">v</span> := delta_lterm1 X1 Y1 <span class="kr">in</span>
    <span class="kr">let</span> <span class="nv">v1</span> := delta_lterm1 X1 v <span class="kr">in</span>
    <span class="kr">let</span> <span class="nv">v2</span> := delta_lterm1 Y1 v1 <span class="kr">in</span>
    (<span class="kp">try</span> (<span class="nb">rewrite</span> [Z <span class="kr">in</span> _ &lt;= Z](_ : Y1 = v2 + v1); <span class="nb">last</span> <span class="bp">by</span> <span class="bp">ring</span>));
    (<span class="kp">try</span> (<span class="nb">rewrite</span> [Z <span class="kr">in</span> Z &lt;= _](_ : X1 = v + v1); <span class="nb">last</span> <span class="bp">by</span> <span class="bp">ring</span>));
    <span class="nb">rewrite</span> <span class="nl">?leq_add2r</span>
    | _ =&gt; 
    <span class="kr">let</span> <span class="nv">v1</span> := delta_lterm1 Y1 v <span class="kr">in</span>
    <span class="kr">let</span> <span class="nv">v2</span> := delta_lterm1 X1 v1 <span class="kr">in</span>
    (<span class="kp">try</span> (<span class="nb">rewrite</span> [Z <span class="kr">in</span> _ &lt;= Z](_ : Y1 = v + v1); <span class="nb">last</span> <span class="bp">by</span> <span class="bp">ring</span>));
    (<span class="kp">try</span> (<span class="nb">rewrite</span> [Z <span class="kr">in</span> Z &lt;= _](_ : X1 = v2 + v1); <span class="nb">last</span> <span class="bp">by</span> <span class="bp">ring</span>));
    <span class="nb">rewrite</span> <span class="nl">?leq_add2r</span>
  <span class="kr">end</span>
  <span class="kr">end</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp"><span class="highlight">  
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Ltac</span> <span class="nf">sring</span> := <span class="nb">rewrite</span> -!mul2n; <span class="bp">ring</span>.</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Ltac</span> <span class="nf">changel</span> t :=
  <span class="kr">let</span> <span class="nv">X</span> := <span class="kp">fresh</span> <span class="s2">&quot;X&quot;</span> <span class="kr">in</span> 
  <span class="nb">rewrite</span> [X <span class="kr">in</span> X &lt;= _](_ : _ = t); <span class="nb">last</span> <span class="bp">by</span> (<span class="bp">ring</span> || sring).</span></span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="highlight"><span class="kn">Ltac</span> <span class="nf">changer</span> t := 
  <span class="kr">let</span> <span class="nv">X</span> := <span class="kp">fresh</span> <span class="s2">&quot;X&quot;</span> <span class="kr">in</span> 
  <span class="nb">rewrite</span> [X <span class="kr">in</span> _ &lt;= X](_ : _ = t); <span class="nb">last</span> <span class="bp">by</span> (<span class="bp">ring</span> || sring).</span></span></span></pre></article></body></html>