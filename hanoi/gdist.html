<!DOCTYPE html>
<html class="alectryon-standalone"><head><title>gdist.v</title><meta charset="utf-8"><meta content="Alectryon" name="generator"><meta name="viewport" content="width=device-width, initial-scale=1"><script>
    // Resolve backreferences
    document.addEventListener("DOMContentLoaded", function() {
        var references = document.querySelectorAll([
           ".alectryon-io .alectryon-extra-goals",
           ".alectryon-io .alectryon-goal",
           ".alectryon-io .alectryon-goals",
           ".alectryon-io .alectryon-output",
           ".alectryon-io .goal-conclusion",
           ".alectryon-io .goal-hyps",
           ".alectryon-io .goal-hyps > div"].join(", "));
        document.querySelectorAll('.alectryon-io q').forEach(function (q) {
            q.replaceWith(references[parseInt(q.innerText, 16)].cloneNode(true)) });
    });

    // Add checkboxes
    document.addEventListener("DOMContentLoaded", function() {
        var input = document.createElement("input");
        input.type = "checkbox";
        input.style = "display: none";

        input.className = "alectryon-extra-goal-toggle";
        document.querySelectorAll('.alectryon-io label.goal-separator').forEach(function(lbl, idx) {
            var goal = lbl.parentNode, box = input.cloneNode(true);
            lbl.htmlFor = box.id = "alectryon-hyps-chk" + idx;
            goal.parentNode.insertBefore(box, goal);
        });

        input.className = "alectryon-toggle";
        document.querySelectorAll('.alectryon-io .alectryon-output').forEach(function(div, idx) {
            var box = input.cloneNode(true), lbl = div.previousSibling;
            box.checked = div.classList.contains("a:show");
            if (lbl && lbl.tagName == "LABEL") {
                lbl.htmlFor = box.id = "alectryon-output-chk" + idx;
            }
            div.parentNode.insertBefore(box, lbl || div);
        });
    });
</script><link href="alectryon.css" rel="stylesheet"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/IBM-type/0.5.4/css/ibm-type.min.css" integrity="sha512-sky5cf9Ts6FY1kstGOBHSybfKqdHR41M0Ldb0BjNiv3ifltoQIsg0zIaQ+wwdwgQ0w9vKFW7Js50lxH9vqNSSw==" crossorigin="anonymous" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/firacode/5.2.0/fira_code.min.css" integrity="sha512-MbysAYimH1hH2xYzkkMHB6MqxBqfP0megxsCLknbYqHVwXTCg9IqHbk+ZP/vnhO8UEW6PaXAkKe2vQ+SWACxxA==" crossorigin="anonymous" /><script src="alectryon.js"></script><style type="text/css">pre { line-height: 125%; }
td.linenos pre { color: #000000; background-color: #f0f0f0; padding-left: 5px; padding-right: 5px; }
span.linenos { color: #000000; background-color: #f0f0f0; padding-left: 5px; padding-right: 5px; }
td.linenos pre.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight .c { color: #555753; font-style: italic } /* Comment */
.highlight .err { color: #a40000; border: 1px solid #cc0000 } /* Error */
.highlight .g { color: #000000 } /* Generic */
.highlight .k { color: #8f5902 } /* Keyword */
.highlight .l { color: #2e3436 } /* Literal */
.highlight .n { color: #000000 } /* Name */
.highlight .o { color: #000000 } /* Operator */
.highlight .x { color: #2e3436 } /* Other */
.highlight .p { color: #000000 } /* Punctuation */
.highlight .ch { color: #555753; font-weight: bold; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #555753; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #3465a4; font-style: italic } /* Comment.Preproc */
.highlight .cpf { color: #555753; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #555753; font-style: italic } /* Comment.Single */
.highlight .cs { color: #3465a4; font-weight: bold; font-style: italic } /* Comment.Special */
.highlight .gd { color: #a40000 } /* Generic.Deleted */
.highlight .ge { color: #000000; font-style: italic } /* Generic.Emph */
.highlight .gr { color: #a40000 } /* Generic.Error */
.highlight .gh { color: #a40000; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #4e9a06 } /* Generic.Inserted */
.highlight .go { color: #000000; font-style: italic } /* Generic.Output */
.highlight .gp { color: #8f5902 } /* Generic.Prompt */
.highlight .gs { color: #000000; font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #000000; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #000000; font-style: italic } /* Generic.Traceback */
.highlight .kc { color: #204a87; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #4e9a06; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #4e9a06; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #204a87 } /* Keyword.Pseudo */
.highlight .kr { color: #8f5902 } /* Keyword.Reserved */
.highlight .kt { color: #204a87 } /* Keyword.Type */
.highlight .ld { color: #2e3436 } /* Literal.Date */
.highlight .m { color: #2e3436 } /* Literal.Number */
.highlight .s { color: #ad7fa8 } /* Literal.String */
.highlight .na { color: #c4a000 } /* Name.Attribute */
.highlight .nb { color: #75507b } /* Name.Builtin */
.highlight .nc { color: #204a87 } /* Name.Class */
.highlight .no { color: #ce5c00 } /* Name.Constant */
.highlight .nd { color: #3465a4; font-weight: bold } /* Name.Decorator */
.highlight .ni { color: #c4a000; text-decoration: underline } /* Name.Entity */
.highlight .ne { color: #cc0000 } /* Name.Exception */
.highlight .nf { color: #a40000 } /* Name.Function */
.highlight .nl { color: #3465a4; font-weight: bold } /* Name.Label */
.highlight .nn { color: #000000 } /* Name.Namespace */
.highlight .nx { color: #000000 } /* Name.Other */
.highlight .py { color: #000000 } /* Name.Property */
.highlight .nt { color: #a40000 } /* Name.Tag */
.highlight .nv { color: #ce5c00 } /* Name.Variable */
.highlight .ow { color: #8f5902 } /* Operator.Word */
.highlight .w { color: #d3d7cf; text-decoration: underline } /* Text.Whitespace */
.highlight .mb { color: #2e3436 } /* Literal.Number.Bin */
.highlight .mf { color: #2e3436 } /* Literal.Number.Float */
.highlight .mh { color: #2e3436 } /* Literal.Number.Hex */
.highlight .mi { color: #2e3436 } /* Literal.Number.Integer */
.highlight .mo { color: #2e3436 } /* Literal.Number.Oct */
.highlight .sa { color: #ad7fa8 } /* Literal.String.Affix */
.highlight .sb { color: #ad7fa8 } /* Literal.String.Backtick */
.highlight .sc { color: #ad7fa8; font-weight: bold } /* Literal.String.Char */
.highlight .dl { color: #ad7fa8 } /* Literal.String.Delimiter */
.highlight .sd { color: #ad7fa8 } /* Literal.String.Doc */
.highlight .s2 { color: #ad7fa8 } /* Literal.String.Double */
.highlight .se { color: #ad7fa8; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #ad7fa8; text-decoration: underline } /* Literal.String.Heredoc */
.highlight .si { color: #ce5c00 } /* Literal.String.Interpol */
.highlight .sx { color: #ad7fa8 } /* Literal.String.Other */
.highlight .sr { color: #ad7fa8 } /* Literal.String.Regex */
.highlight .s1 { color: #ad7fa8 } /* Literal.String.Single */
.highlight .ss { color: #8f5902 } /* Literal.String.Symbol */
.highlight .bp { color: #5c35cc } /* Name.Builtin.Pseudo */
.highlight .fm { color: #a40000 } /* Name.Function.Magic */
.highlight .vc { color: #ce5c00 } /* Name.Variable.Class */
.highlight .vg { color: #ce5c00; text-decoration: underline } /* Name.Variable.Global */
.highlight .vi { color: #ce5c00 } /* Name.Variable.Instance */
.highlight .vm { color: #ce5c00 } /* Name.Variable.Magic */
.highlight .il { color: #2e3436 } /* Literal.Number.Integer.Long */</style></head><body><article class="alectryon-root alectryon-centered alectryon-minified"><div class="alectryon-banner">Built with <a href="https://github.com/cpitclaudel/alectryon/">Alectryon</a>, running Coq+SerAPI v8.13.0+0.13.0. Bubbles (<span class="alectryon-bubble"></span>) indicate interactive fragments: hover for details, tap to reveal contents. Use <kbd>Ctrl+‚Üë</kbd> <kbd>Ctrl+‚Üì</kbd> to navigate, <kbd>Ctrl+üñ±Ô∏è</kbd> to focus. On Mac, use <kbd>‚åò</kbd> instead of <kbd>Ctrl</kbd>.</div><pre class="alectryon-io highlight"><!-- Generator: Alectryon --><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">From</span> mathcomp <span class="kn">Require Import</span> all_ssreflect.</label><small class="alectryon-output"><div><div class="alectryon-messages"><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;[ rel _ _ | _ ]&quot;</span> was already used <span class="kr">in</span> scope
fun_scope. [notation-overridden,parsing]</blockquote><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;[ rel _ _ : _ | _ ]&quot;</span> was already used <span class="kr">in</span>
scope fun_scope. [notation-overridden,parsing]</blockquote><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;[ rel _ _ in _ &amp; _ | _ ]&quot;</span> was already used
<span class="kr">in</span> scope fun_scope. [notation-overridden,parsing]</blockquote><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;[ rel _ _ in _ &amp; _ ]&quot;</span> was already used <span class="kr">in</span>
scope fun_scope. [notation-overridden,parsing]</blockquote><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;[ rel _ _ in _ | _ ]&quot;</span> was already used <span class="kr">in</span>
scope fun_scope. [notation-overridden,parsing]</blockquote><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;[ rel _ _ in _ ]&quot;</span> was already used <span class="kr">in</span> scope
fun_scope. [notation-overridden,parsing]</blockquote><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;_ + _&quot;</span> was already used <span class="kr">in</span> scope nat_scope.
[notation-overridden,parsing]</blockquote><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;_ - _&quot;</span> was already used <span class="kr">in</span> scope nat_scope.
[notation-overridden,parsing]</blockquote><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;_ &lt;= _&quot;</span> was already used <span class="kr">in</span> scope nat_scope.
[notation-overridden,parsing]</blockquote><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;_ &lt; _&quot;</span> was already used <span class="kr">in</span> scope nat_scope.
[notation-overridden,parsing]</blockquote><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;_ &gt;= _&quot;</span> was already used <span class="kr">in</span> scope nat_scope.
[notation-overridden,parsing]</blockquote><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;_ &gt; _&quot;</span> was already used <span class="kr">in</span> scope nat_scope.
[notation-overridden,parsing]</blockquote><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;_ &lt;= _ &lt;= _&quot;</span> was already used <span class="kr">in</span> scope
nat_scope. [notation-overridden,parsing]</blockquote><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;_ &lt; _ &lt;= _&quot;</span> was already used <span class="kr">in</span> scope
nat_scope. [notation-overridden,parsing]</blockquote><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;_ &lt;= _ &lt; _&quot;</span> was already used <span class="kr">in</span> scope
nat_scope. [notation-overridden,parsing]</blockquote><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;_ &lt; _ &lt; _&quot;</span> was already used <span class="kr">in</span> scope
nat_scope. [notation-overridden,parsing]</blockquote><blockquote class="alectryon-message"><span class="kn">Notation</span> <span class="s2">&quot;_ * _&quot;</span> was already used <span class="kr">in</span> scope nat_scope.
[notation-overridden,parsing]</blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="sd">(******************************************************************************)</span>
<span class="c">(*             Definition of a distance on graph                              *)</span>
<span class="c">(*   connectn r n x == the set of all the elements connected to x in n steps  *)</span>
<span class="c">(*                                                                            *)</span>
<span class="c">(*   `d[t1, t2]_r   == the distance between t1 and t2 in r                    *)</span>
<span class="c">(*                     if they are not connected returns the cardinal of the  *)</span>
<span class="c">(*                     the subtype                                            *)</span>
<span class="sd">(******************************************************************************)</span>

</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Set Implicit Arguments</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Unset Strict Implicit</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Unset Printing Implicit Defensive</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">gdist</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variable</span> <span class="nv">T</span> : finType.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variable</span> <span class="nv">r</span> : rel T.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Fixpoint</span> <span class="nf">connectn</span> <span class="nv">n</span> <span class="nv">x</span> :=
  <span class="kr">if</span> n <span class="kr">is</span> n1.+<span class="mi">1</span> <span class="kr">then</span> \bigcup_(y <span class="kr">in</span> (rgraph r x)) connectn n1 y
  <span class="kr">else</span> [<span class="nb">set</span> x].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">connectnP</span> <span class="nv">n</span> <span class="nv">x</span> <span class="nv">y</span> :
  reflect 
    (<span class="kr">exists</span> <span class="nv">p</span> : seq T, [/\ path r x p, <span class="nb">last</span> x p = y &amp; size p = n])
    (y \<span class="kr">in</span> connectn n x).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><div><var>T</var><span class="hyp-type"><b>:</b><span>finType</span></span></div><div><var>r</var><span class="hyp-type"><b>:</b><span>rel T</span></span></div><div><var>n</var><span class="hyp-type"><b>:</b><span>nat</span></span></div><div><var>x, y</var><span class="hyp-type"><b>:</b><span>T</span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion">reflect
  (<span class="kr">exists</span> <span class="nv">p</span> : seq T,
     [/\ path r x p, <span class="nb">last</span> x p = y &amp; size p = n])
  (y \<span class="kr">in</span> connectn n x)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>2</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">elim</span>: n x y =&gt;  [x y|n IH x y /=].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>8</q></div><span class="goal-separator"><hr></span><div class="goal-conclusion">reflect
  (<span class="kr">exists</span> <span class="nv">p</span> : seq T,
     [/\ path r x p, <span class="nb">last</span> x p = y &amp; size p = <span class="mi">0</span>])
  (y \<span class="kr">in</span> connectn <span class="mi">0</span> x)</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>7</q><div><var>IH</var><span class="hyp-type"><b>:</b><span><span class="kr">forall</span> <span class="nv">x</span> <span class="nv">y</span> : T,
reflect
  (<span class="kr">exists</span> <span class="nv">p</span> : seq T,
     [/\ path r x p, <span class="nb">last</span> x p = y &amp; size p = n])
  (y \<span class="kr">in</span> connectn n x)</span></span></div><q>8</q></div><label class="goal-separator"><hr></label><div class="goal-conclusion">reflect
  (<span class="kr">exists</span> <span class="nv">p</span> : seq T,
     [/\ path r x p, <span class="nb">last</span> x p = y &amp; size p = n.+<span class="mi">1</span>])
  (y \<span class="kr">in</span> \bigcup_(y <span class="kr">in</span> rgraph r x) connectn n y)</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> inE; <span class="nb">apply</span>: (iffP idP) =&gt; [/eqP-&gt;|[[|a l] [] //= _ -&gt;//]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>e</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">p</span> : seq T,
  [/\ path r x p, <span class="nb">last</span> x p = x &amp; size p = <span class="mi">0</span>]</div></blockquote><q>10</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="kr">exists</span> [::].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>12</q><span class="goal-separator"><hr></span><q>14</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">apply</span>: (iffP idP) =&gt; [/bigcupP[i]|[[|i p]//= [H1 H2 H3]]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>7</q><q>13</q><div><var>x, y, i</var><span class="hyp-type"><b>:</b><span>T</span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i \<span class="kr">in</span> rgraph r x -&gt;
y \<span class="kr">in</span> connectn n i -&gt;
<span class="kr">exists</span> <span class="nv">p0</span> : seq T,
  [/\ path r x p0, <span class="nb">last</span> x p0 = y &amp; size p0 = n.+<span class="mi">1</span>]</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>7</q><q>13</q><q>8</q><div><var>H1</var><span class="hyp-type"><b>:</b><span>true</span></span></div><div><var>H2</var><span class="hyp-type"><b>:</b><span>x = y</span></span></div><div><var>H3</var><span class="hyp-type"><b>:</b><span><span class="mi">0</span> = n.+<span class="mi">1</span></span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion">y \<span class="kr">in</span> \bigcup_(y <span class="kr">in</span> rgraph r x) connectn n y</div></blockquote><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>7</q><q>13</q><q>20</q><div><var>p</var><span class="hyp-type"><b>:</b><span>seq T</span></span></div><div><var>H1</var><span class="hyp-type"><b>:</b><span>r x i &amp;&amp; path r i p</span></span></div><div><var>H2</var><span class="hyp-type"><b>:</b><span><span class="nb">last</span> i p = y</span></span></div><div><var>H3</var><span class="hyp-type"><b>:</b><span>(size p).+<span class="mi">1</span> = n.+<span class="mi">1</span></span></span></div></div><label class="goal-separator"><hr></label><q>28</q></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>1d</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> [i \<span class="kr">in</span> _]rgraphK =&gt; iRk /IH [p [H1 H2 H3]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>7</q><q>13</q><q>20</q><div><var>iRk</var><span class="hyp-type"><b>:</b><span>r x i</span></span></div><q>2b</q><div><var>H1</var><span class="hyp-type"><b>:</b><span>path r i p</span></span></div><q>2d</q><div><var>H3</var><span class="hyp-type"><b>:</b><span>size p = n</span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">p</span> : seq T,
  [/\ path r x p, <span class="nb">last</span> x p = y &amp; size p = n.+<span class="mi">1</span>]</div></blockquote><q>22</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="kr">exists</span> (<span class="nv">i</span> :: p); <span class="nb">split</span>; <span class="nb">rewrite</span> /= ?(iRk, H3).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>24</q><span class="goal-separator"><hr></span><q>28</q></blockquote><div class="alectryon-extra-goals"><q>29</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>39</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> [].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>2a</q><span class="goal-separator"><hr></span><q>28</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">case</span>/andP: H1 =&gt; H11 H12.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>7</q><q>13</q><q>20</q><q>2b</q><q>2d</q><q>2e</q><div><var>H11</var><span class="hyp-type"><b>:</b><span>r x i</span></span></div><div><var>H12</var><span class="hyp-type"><b>:</b><span>path r i p</span></span></div></div><span class="goal-separator"><hr></span><q>28</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> F : i \<span class="kr">in</span> rgraph r x <span class="bp">by</span> <span class="nb">rewrite</span> [_ \<span class="kr">in</span> _]rgraphK.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>7</q><q>13</q><q>20</q><q>2b</q><q>2d</q><q>2e</q><q>44</q><q>45</q><div><var>F</var><span class="hyp-type"><b>:</b><span>i \<span class="kr">in</span> rgraph r x</span></span></div></div><span class="goal-separator"><hr></span><q>28</q></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">apply</span>: (subsetP (bigcup_sup _ F)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>49</q><span class="goal-separator"><hr></span><div class="goal-conclusion">y \<span class="kr">in</span> connectn n i</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span>/IH; <span class="kr">exists</span> <span class="nv">p</span>; <span class="nb">split</span> =&gt; //; <span class="nb">case</span>: H3.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">gdist</span> <span class="nv">t1</span> <span class="nv">t2</span> :=
  find (<span class="kr">fun</span> <span class="nv">n</span> =&gt; t2 \<span class="kr">in</span> connectn n t1) (iota <span class="mi">0</span> #|T|).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Local Notation</span> <span class="s2">&quot; `d[ t1 , t2 ] &quot;</span> := (gdist t1 t2)
  (<span class="kn">format</span> <span class="s2">&quot; `d[ t1 ,  t2 ] &quot;</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gdist_eq0</span> <span class="nv">t1</span> <span class="nv">t2</span> : (`d[t1, t2] == <span class="mi">0</span>) = (t1 == t2).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><div><var>t1, t2</var><span class="hyp-type"><b>:</b><span>T</span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion">( `d[t1, t2]  == <span class="mi">0</span>) = (t1 == t2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>50</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> tG : #|T| &gt; <span class="mi">0</span> <span class="bp">by</span> <span class="nb">rewrite</span> (cardD1 t1).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><div><var>tG</var><span class="hyp-type"><b>:</b><span><span class="mi">0</span> &lt; #|T|</span></span></div></div><span class="goal-separator"><hr></span><q>54</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> /gdist.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>59</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(find (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt; t2 \<span class="kr">in</span> connectn n t1)
   (iota <span class="mi">0</span> #|T|) == <span class="mi">0</span>) = (t1 == t2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">case</span>: #|_| tG =&gt; // n _.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><q>7</q></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(find (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt; t2 \<span class="kr">in</span> connectn n t1)
   (iota <span class="mi">0</span> n.+<span class="mi">1</span>) == <span class="mi">0</span>) = (t1 == t2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> (iota_add _ <span class="mi">1</span>) /= inE [t2 == _]eq_sym.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>62</q><span class="goal-separator"><hr></span><div class="goal-conclusion">((<span class="kr">if</span> t1 == t2
  <span class="kr">then</span> <span class="mi">0</span>
  <span class="kr">else</span>
   (find (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt; t2 \<span class="kr">in</span> connectn n t1)
      (iota (<span class="mi">0</span> + <span class="mi">1</span>) n)).+<span class="mi">1</span>) == <span class="mi">0</span>) = (t1 == t2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: (t1 =P t2).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gdist_gt0</span> <span class="nv">t1</span> <span class="nv">t2</span> : (<span class="mi">0</span> &lt; `d[t1, t2]) = (t1 != t2).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>52</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="mi">0</span> &lt;  `d[t1, t2] ) = (t1 != t2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>69</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> ltnNge leqn0 gdist_eq0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gdist0</span> <span class="nv">t</span> : `d[t, t] = <span class="mi">0</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><div><var>t</var><span class="hyp-type"><b>:</b><span>T</span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"> `d[t, t]  = <span class="mi">0</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>6e</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span>/eqP; <span class="nb">rewrite</span> gdist_eq0.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gdist_card_le</span> <span class="nv">t1</span> <span class="nv">t2</span> : `d[t1, t2] &lt;= #|T|.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>52</q><span class="goal-separator"><hr></span><div class="goal-conclusion"> `d[t1, t2]  &lt;= #|T|</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>75</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> -[#|T|](size_iota <span class="mi">0</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>52</q><span class="goal-separator"><hr></span><div class="goal-conclusion"> `d[t1, t2]  &lt;= size (iota <span class="mi">0</span> #|T|)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="nb">apply</span>: find_size.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gdist_path_le</span> <span class="nv">t1</span> <span class="nv">t2</span> <span class="nv">p</span> :
  path r t1 p -&gt; <span class="nb">last</span> t1 p = t2 -&gt; `d[t1, t2] &lt;= size p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><q>2b</q></div><span class="goal-separator"><hr></span><div class="goal-conclusion">path r t1 p -&gt;
<span class="nb">last</span> t1 p = t2 -&gt;  `d[t1, t2]  &lt;= size p</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>7e</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; Hp Hl.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><q>2b</q><div><var>Hp</var><span class="hyp-type"><b>:</b><span>path r t1 p</span></span></div><div><var>Hl</var><span class="hyp-type"><b>:</b><span><span class="nb">last</span> t1 p = t2</span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"> `d[t1, t2]  &lt;= size p</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> [tLp|pLt] := leqP #|T| (size p).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><q>2b</q><q>87</q><q>88</q><div><var>tLp</var><span class="hyp-type"><b>:</b><span>#|T| &lt;= size p</span></span></div></div><span class="goal-separator"><hr></span><q>89</q></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><q>2b</q><q>87</q><q>88</q><div><var>pLt</var><span class="hyp-type"><b>:</b><span>size p &lt; #|T|</span></span></div></div><label class="goal-separator"><hr></label><q>89</q></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">apply</span>: leq_trans tLp.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>86</q><span class="goal-separator"><hr></span><q>77</q></blockquote><q>8f</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span>: gdist_card_le.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>91</q><span class="goal-separator"><hr></span><q>89</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> F : t2 \<span class="kr">in</span> connectn (size p) t1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>91</q><span class="goal-separator"><hr></span><div class="goal-conclusion">t2 \<span class="kr">in</span> connectn (size p) t1</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><q>2b</q><q>87</q><q>88</q><q>92</q><div><var>F</var><span class="hyp-type"><b>:</b><span>t2 \<span class="kr">in</span> connectn (size p) t1</span></span></div></div><label class="goal-separator"><hr></label><q>89</q></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span>/connectnP; <span class="kr">exists</span> <span class="nv">p</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>9f</q><span class="goal-separator"><hr></span><q>89</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">case</span>: leqP =&gt; // /(before_find _) // /(_ <span class="mi">0</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>9f</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(t2 \<span class="kr">in</span> connectn (nth <span class="mi">0</span> (iota <span class="mi">0</span> #|T|) (size p)) t1) =
false -&gt; false</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> seq.nth_iota // F.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gdist_connect</span> <span class="nv">t1</span> <span class="nv">t2</span> : connect r t1 t2 = (`d[t1,t2] &lt; #|T|).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>52</q><span class="goal-separator"><hr></span><div class="goal-conclusion">connect r t1 t2 = ( `d[t1, t2]  &lt; #|T|)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>a9</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">apply</span>/connectP/idP=&gt; [[p /shortenP[p&#39; Hp&#39; Hu _ Ht]]|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><div><var>p, p'</var><span class="hyp-type"><b>:</b><span>seq T</span></span></div><div><var>Hp'</var><span class="hyp-type"><b>:</b><span>path r t1 p&#39;</span></span></div><div><var>Hu</var><span class="hyp-type"><b>:</b><span>uniq (t1 :: p&#39;)</span></span></div><div><var>Ht</var><span class="hyp-type"><b>:</b><span>t2 = <span class="nb">last</span> t1 p&#39;</span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"> `d[t1, t2]  &lt; #|T|</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>52</q><label class="goal-separator"><hr></label><div class="goal-conclusion"> `d[t1, t2]  &lt; #|T| -&gt;
<span class="kr">exists2</span> p : seq T, path r t1 p &amp; t2 = <span class="nb">last</span> t1 p</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">apply</span>: leq_trans (_ : size p&#39; &lt; _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>b0</q><span class="goal-separator"><hr></span><div class="goal-conclusion"> `d[t1, t2]  &lt; (size p&#39;).+<span class="mi">1</span></div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>b0</q><label class="goal-separator"><hr></label><div class="goal-conclusion">size p&#39; &lt; #|T|</div></blockquote><q>b7</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span>: gdist_path_le.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>b0</q><span class="goal-separator"><hr></span><q>bf</q></blockquote><q>b6</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> -[_.+<span class="mi">1</span>]/(size (t1 :: p&#39;)) cardE.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>b0</q><span class="goal-separator"><hr></span><div class="goal-conclusion">size (t1 :: p&#39;) &lt;= size (enum T)</div></blockquote><q>b6</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">apply</span>: uniq_leq_size =&gt; // i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><q>b1</q><q>b2</q><q>b3</q><q>b4</q><div><var>i</var><span class="hyp-type"><b>:</b><span>T</span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i \<span class="kr">in</span> t1 :: p&#39; -&gt; i \<span class="kr">in</span> enum T</div></blockquote><q>b6</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> mem_enum.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>52</q><span class="goal-separator"><hr></span><q>b8</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> -[#|_|](size_iota <span class="mi">0</span>) -has_find.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>52</q><span class="goal-separator"><hr></span><div class="goal-conclusion">has (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt; t2 \<span class="kr">in</span> connectn n t1)
  (iota <span class="mi">0</span> #|T|) -&gt;
<span class="kr">exists2</span> p : seq T, path r t1 p &amp; t2 = <span class="nb">last</span> t1 p</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span> =&gt; /hasP[n _ /connectnP [p [H1p H2p H3p]]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><div><var>n</var><span class="hyp-type"><b>:</b><span>nat_eqType</span></span></div><q>2b</q><div><var>H1p</var><span class="hyp-type"><b>:</b><span>path r t1 p</span></span></div><div><var>H2p</var><span class="hyp-type"><b>:</b><span><span class="nb">last</span> t1 p = t2</span></span></div><div><var>H3p</var><span class="hyp-type"><b>:</b><span>size p = n</span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists2</span> p : seq T, path r t1 p &amp; t2 = <span class="nb">last</span> t1 p</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="kr">exists</span> <span class="nv">p</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gdist_nconnect</span> <span class="nv">t1</span> <span class="nv">t2</span> : ~~ connect r t1 t2 -&gt; `d[t1,t2] = #|T|.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>52</q><span class="goal-separator"><hr></span><div class="goal-conclusion">~~ connect r t1 t2 -&gt;  `d[t1, t2]  = #|T|</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>de</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; H; <span class="nb">apply</span>/eqP.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><div><var>H</var><span class="hyp-type"><b>:</b><span>~~ connect r t1 t2</span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"> `d[t1, t2]  == #|T|</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> := gdist_card_le t1 t2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>e5</q><span class="goal-separator"><hr></span><div class="goal-conclusion"> `d[t1, t2]  &lt;= #|T| -&gt;  `d[t1, t2]  == #|T|</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> leq_eqVlt -gdist_connect (negPf H) orbF.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* geodesic path *)</span>
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Definition</span> <span class="nf">gpath</span> <span class="nv">t1</span> <span class="nv">t2</span> <span class="nv">p</span> :=
  [&amp;&amp; path r t1 p, <span class="nb">last</span> t1 p == t2 &amp; `d[t1, t2] == size p].</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gpathP</span> <span class="nv">t1</span> <span class="nv">t2</span> <span class="nv">p</span> :
  reflect ([/\ path r t1 p, <span class="nb">last</span> t1 p = t2 &amp; `d[t1, t2] = size p])
          (gpath t1 t2 p).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>80</q><span class="goal-separator"><hr></span><div class="goal-conclusion">reflect
  [/\ path r t1 p, <span class="nb">last</span> t1 p = t2
    &amp;  `d[t1, t2]  = size p] (gpath t1 t2 p)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>ed</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">apply</span>: (iffP and3P) =&gt; [[t1Pp /eqP t1pLt2 /eqP t1t2D]|
                        [t1Pp t1pLt2 t1t2D]]; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><q>2b</q><div><var>t1Pp</var><span class="hyp-type"><b>:</b><span>path r t1 p</span></span></div><div><var>t1pLt2</var><span class="hyp-type"><b>:</b><span><span class="nb">last</span> t1 p = t2</span></span></div><div><var>t1t2D</var><span class="hyp-type"><b>:</b><span> `d[t1, t2]  = size p</span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion">[/\ path r t1 p, <span class="nb">last</span> t1 p == t2
  &amp;  `d[t1, t2]  == size p]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">split</span> =&gt; //; <span class="nb">apply</span>/eqP.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gpath_connect</span> <span class="nv">t1</span> <span class="nv">t2</span> : connect r t1 t2 -&gt; {p | gpath t1 t2 p}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>52</q><span class="goal-separator"><hr></span><div class="goal-conclusion">connect r t1 t2 -&gt; {p : seq T | gpath t1 t2 p}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>fa</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; t1Ct2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><div><var>t1Ct2</var><span class="hyp-type"><b>:</b><span>connect r t1 t2</span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{p : seq T | gpath t1 t2 p}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">case</span>: (pickP [pred p | gpath t1 t2 (p : `d[t1, t2].-tuple T)]) =&gt; [p Hp|HC].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><q>102</q><div><var>p</var><span class="hyp-type"><b>:</b><span>tuple_finType  `d[t1, t2]  T</span></span></div><div><var>Hp</var><span class="hyp-type"><b>:</b><span>[pred p | gpath t1 t2 p] p</span></span></div></div><span class="goal-separator"><hr></span><q>103</q></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><q>102</q><div><var>HC</var><span class="hyp-type"><b>:</b><span>[pred p | gpath t1 t2 p] =<span class="mi">1</span> xpred0</span></span></div></div><label class="goal-separator"><hr></label><q>103</q></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="kr">exists</span> <span class="nv">p</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>10c</q><span class="goal-separator"><hr></span><q>103</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: (t1Ct2); <span class="nb">rewrite</span> gdist_connect =&gt; dLT.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><q>102</q><q>10d</q><div><var>dLT</var><span class="hyp-type"><b>:</b><span> `d[t1, t2]  &lt; #|T|</span></span></div></div><span class="goal-separator"><hr></span><q>103</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">absurd</span> <span class="kt">False</span> =&gt; //.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>114</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: (dLT); <span class="nb">rewrite</span> -[#|_|](size_iota <span class="mi">0</span>) -has_find.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>114</q><span class="goal-separator"><hr></span><div class="goal-conclusion">has (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt; t2 \<span class="kr">in</span> connectn n t1)
  (iota <span class="mi">0</span> #|T|) -&gt; <span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span> =&gt; /(nth_find <span class="mi">0</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>114</q><span class="goal-separator"><hr></span><div class="goal-conclusion">t2
  \<span class="kr">in</span> connectn
        (nth <span class="mi">0</span> (iota <span class="mi">0</span> #|T|)
           (find (<span class="kr">fun</span> <span class="nv">n</span> : nat =&gt; t2 \<span class="kr">in</span> connectn n t1)
              (iota <span class="mi">0</span> #|T|))) t1 -&gt; <span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> -[find _ _]/`d[t1, t2].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>114</q><span class="goal-separator"><hr></span><div class="goal-conclusion">t2 \<span class="kr">in</span> connectn (nth <span class="mi">0</span> (iota <span class="mi">0</span> #|T|)  `d[t1, t2] ) t1 -&gt;
<span class="kt">False</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> nth_iota // add0n =&gt; /connectnP[p [H1p H2p /eqP H3p]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><q>102</q><q>10d</q><q>115</q><q>2b</q><q>d9</q><q>da</q><div><var>H3p</var><span class="hyp-type"><b>:</b><span>size p ==  `d[t1, t2] </span></span></div></div><span class="goal-separator"><hr></span><q>119</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> /idP[] := HC (Tuple H3p).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>129</q><span class="goal-separator"><hr></span><div class="goal-conclusion">[pred p | gpath t1 t2 p] (Tuple H3p)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span>/and3P; <span class="nb">split</span>=&gt; //=; <span class="nb">apply</span>/eqP=&gt; //; <span class="nb">rewrite</span> (eqP H3p).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gpath_last</span> <span class="nv">t1</span> <span class="nv">t2</span> <span class="nv">p</span> : gpath t1 t2 p -&gt; <span class="nb">last</span> t1 p = t2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>80</q><span class="goal-separator"><hr></span><div class="goal-conclusion">gpath t1 t2 p -&gt; <span class="nb">last</span> t1 p = t2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>130</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>/gpathP.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gpath_dist</span> <span class="nv">t1</span> <span class="nv">t2</span> <span class="nv">p</span> : gpath t1 t2 p -&gt; `d[t1, t2] = size p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>80</q><span class="goal-separator"><hr></span><div class="goal-conclusion">gpath t1 t2 p -&gt;  `d[t1, t2]  = size p</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>135</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>/gpathP.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gpath_path</span> <span class="nv">t1</span> <span class="nv">t2</span> <span class="nv">p</span> : gpath t1 t2 p -&gt; path r t1 p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>80</q><span class="goal-separator"><hr></span><div class="goal-conclusion">gpath t1 t2 p -&gt; path r t1 p</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>13a</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>/gpathP.</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">last_take</span> (<span class="nv">A</span> : <span class="kt">Type</span>) (<span class="nv">p</span> : seq A) <span class="nv">t</span> <span class="nv">t1</span> <span class="nv">j</span> : 
  j &lt;= size p -&gt; <span class="nb">last</span> t1 (take j p) = nth t (t1 :: p) j.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><div><var>A</var><span class="hyp-type"><b>:</b><span><span class="kt">Type</span></span></span></div><div><var>p</var><span class="hyp-type"><b>:</b><span>seq A</span></span></div><div><var>t, t1</var><span class="hyp-type"><b>:</b><span>A</span></span></div><div><var>j</var><span class="hyp-type"><b>:</b><span>nat</span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion">j &lt;= size p -&gt; <span class="nb">last</span> t1 (take j p) = nth t (t1 :: p) j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>13f</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">elim</span>: p t1 j =&gt; [t1 [|] //| a l IH t1 [|j]] //= H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>142</q><div><var>t, a</var><span class="hyp-type"><b>:</b><span>A</span></span></div><div><var>l</var><span class="hyp-type"><b>:</b><span>seq A</span></span></div><div><var>IH</var><span class="hyp-type"><b>:</b><span><span class="kr">forall</span> (<span class="nv">t1</span> : A) (<span class="nv">j</span> : nat),
j &lt;= size l -&gt;
<span class="nb">last</span> t1 (take j l) = nth t (t1 :: l) j</span></span></div><div><var>t1</var><span class="hyp-type"><b>:</b><span>A</span></span></div><q>145</q><div><var>H</var><span class="hyp-type"><b>:</b><span>j &lt; (size l).+<span class="mi">1</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">last</span> a (take j l) = nth t (a :: l) j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span>: IH.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
<span class="c">(* ugly proof !! *)</span>
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gpath_uniq</span> <span class="nv">t1</span> <span class="nv">t2</span> <span class="nv">p</span> : gpath t1 t2 p -&gt;  uniq (t1 :: p).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>80</q><span class="goal-separator"><hr></span><div class="goal-conclusion">gpath t1 t2 p -&gt; uniq (t1 :: p)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>153</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; gH; <span class="nb">apply</span>/(uniqP t1) =&gt; i j iH jH.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><q>2b</q><div><var>gH</var><span class="hyp-type"><b>:</b><span>gpath t1 t2 p</span></span></div><div><var>i, j</var><span class="hyp-type"><b>:</b><span>nat</span></span></div><div><var>iH</var><span class="hyp-type"><b>:</b><span>i \<span class="kr">in</span> gtn (size (t1 :: p))</span></span></div><div><var>jH</var><span class="hyp-type"><b>:</b><span>j \<span class="kr">in</span> gtn (size (t1 :: p))</span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth t1 (t1 :: p) i = nth t1 (t1 :: p) j -&gt; i = j</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">wlog</span> : i j iH jH / i &lt;= j.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>15a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">(<span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> : nat,
 i \<span class="kr">in</span> gtn (size (t1 :: p)) -&gt;
 j \<span class="kr">in</span> gtn (size (t1 :: p)) -&gt;
 i &lt;= j -&gt;
 nth t1 (t1 :: p) i = nth t1 (t1 :: p) j -&gt; i = j) -&gt;
nth t1 (t1 :: p) i = nth t1 (t1 :: p) j -&gt; i = j</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>15a</q><label class="goal-separator"><hr></label><div class="goal-conclusion">i &lt;= j -&gt;
nth t1 (t1 :: p) i = nth t1 (t1 :: p) j -&gt; i = j</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; H; <span class="nb">case</span>: (leqP i j) =&gt; [iLj|jLi]; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">apply</span>: H.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><q>2b</q><q>15b</q><q>15c</q><q>15d</q><q>15e</q><div><var>H</var><span class="hyp-type"><b>:</b><span><span class="kr">forall</span> <span class="nv">i</span> <span class="nv">j</span> : nat,
i \<span class="kr">in</span> gtn (size (t1 :: p)) -&gt;
j \<span class="kr">in</span> gtn (size (t1 :: p)) -&gt;
i &lt;= j -&gt;
nth t1 (t1 :: p) i = nth t1 (t1 :: p) j -&gt; i = j</span></span></div><div><var>jLi</var><span class="hyp-type"><b>:</b><span>j &lt; i</span></span></div></div><span class="goal-separator"><hr></span><q>15f</q></blockquote><q>164</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; /(@sym_equal _ _ _) /H-&gt;; <span class="nb">rewrite</span> // ltnW.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>15a</q><span class="goal-separator"><hr></span><q>166</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> leq_eqVlt =&gt; /orP[/eqP-&gt;//|iLj].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><q>2b</q><q>15b</q><q>15c</q><q>15d</q><q>15e</q><div><var>iLj</var><span class="hyp-type"><b>:</b><span>i &lt; j</span></span></div></div><span class="goal-separator"><hr></span><q>15f</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">case</span>/gpathP : gH  =&gt; t1Pp t1pLt2 dt1t2E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><q>2b</q><q>15c</q><q>15d</q><q>15e</q><q>174</q><q>f5</q><q>f6</q><div><var>dt1t2E</var><span class="hyp-type"><b>:</b><span> `d[t1, t2]  = size p</span></span></div></div><span class="goal-separator"><hr></span><q>15f</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">case</span>: j jH iLj =&gt; j // jH iLj.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><q>2b</q><div><var>i</var><span class="hyp-type"><b>:</b><span>nat</span></span></div><q>15d</q><q>f5</q><q>f6</q><q>179</q><q>145</q><div><var>jH</var><span class="hyp-type"><b>:</b><span>j.+<span class="mi">1</span> \<span class="kr">in</span> gtn (size (t1 :: p))</span></span></div><div><var>iLj</var><span class="hyp-type"><b>:</b><span>i &lt; j.+<span class="mi">1</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion">nth t1 (t1 :: p) i = nth t1 (t1 :: p) j.+<span class="mi">1</span> -&gt; i = j.+<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">case</span>: i iH iLj =&gt; [_ _ t1E | ] //.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><q>2b</q><q>f5</q><q>f6</q><q>179</q><q>145</q><q>17f</q><div><var>t1E</var><span class="hyp-type"><b>:</b><span>nth t1 (t1 :: p) <span class="mi">0</span> = nth t1 (t1 :: p) j.+<span class="mi">1</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> = j.+<span class="mi">1</span></div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><q>2b</q><q>f5</q><q>f6</q><q>179</q><q>145</q><q>17f</q></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="kr">forall</span> <span class="nv">n</span> : nat,
n.+<span class="mi">1</span> \<span class="kr">in</span> gtn (size (t1 :: p)) -&gt;
n.+<span class="mi">1</span> &lt; j.+<span class="mi">1</span> -&gt;
nth t1 (t1 :: p) n.+<span class="mi">1</span> = nth t1 (t1 :: p) j.+<span class="mi">1</span> -&gt;
n.+<span class="mi">1</span> = j.+<span class="mi">1</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">pose</span> p1 := drop j.+<span class="mi">1</span> p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><q>2b</q><q>f5</q><q>f6</q><q>179</q><q>145</q><q>17f</q><q>186</q><div><var>p1</var><span><span class="hyp-body"><b>:=</b><span>drop j.+<span class="mi">1</span> p</span></span><span class="hyp-type"><b>:</b><span>seq T</span></span></span></div></div><span class="goal-separator"><hr></span><q>187</q></blockquote><q>188</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> t1Pp1 : path r t1 p1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>18f</q><span class="goal-separator"><hr></span><div class="goal-conclusion">path r t1 p1</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><q>2b</q><q>f5</q><q>f6</q><q>179</q><q>145</q><q>17f</q><q>186</q><q>190</q><div><var>t1Pp1</var><span class="hyp-type"><b>:</b><span>path r t1 p1</span></span></div></div><label class="goal-separator"><hr></label><q>187</q></blockquote><q>189</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: (t1Pp); <span class="nb">rewrite</span> -[p](cat_take_drop j.+<span class="mi">1</span>) cat_path.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>18f</q><span class="goal-separator"><hr></span><div class="goal-conclusion">path r t1 (take j.+<span class="mi">1</span> p) &amp;&amp;
path r (<span class="nb">last</span> t1 (take j.+<span class="mi">1</span> p)) (drop j.+<span class="mi">1</span> p) -&gt;
path r t1 p1</div></blockquote><q>195</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> /= <span class="kr">in</span> t1E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><q>2b</q><q>f5</q><q>f6</q><q>179</q><q>145</q><q>17f</q><q>190</q><div><var>t1E</var><span class="hyp-type"><b>:</b><span>t1 = nth t1 p j</span></span></div></div><span class="goal-separator"><hr></span><q>19c</q></blockquote><q>195</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> (last_take t1) //= -t1E =&gt; /andP[].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>197</q><span class="goal-separator"><hr></span><q>187</q></blockquote><q>188</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> t1p1L : <span class="nb">last</span> t1 p1 = t2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>197</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">last</span> t1 p1 = t2</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><q>2b</q><q>f5</q><q>f6</q><q>179</q><q>145</q><q>17f</q><q>186</q><q>190</q><q>198</q><div><var>t1p1L</var><span class="hyp-type"><b>:</b><span><span class="nb">last</span> t1 p1 = t2</span></span></div></div><label class="goal-separator"><hr></label><q>187</q></blockquote><q>189</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: (t1pLt2); <span class="nb">rewrite</span> -[p](cat_take_drop j.+<span class="mi">1</span>) last_cat.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>197</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">last</span> (<span class="nb">last</span> t1 (take j.+<span class="mi">1</span> p)) (drop j.+<span class="mi">1</span> p) = t2 -&gt;
<span class="nb">last</span> t1 p1 = t2</div></blockquote><q>1a9</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> /= <span class="kr">in</span> t1E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><q>2b</q><q>f5</q><q>f6</q><q>179</q><q>145</q><q>17f</q><q>190</q><q>198</q><q>1a1</q></div><span class="goal-separator"><hr></span><q>1b0</q></blockquote><q>1a9</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> (last_take t1) //= -t1E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1ab</q><span class="goal-separator"><hr></span><q>187</q></blockquote><q>188</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> [] := boolP (`d[t1, t2] &lt;= size p1) =&gt; [|/negP[]]; <span class="nb">last first</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1ab</q><span class="goal-separator"><hr></span><div class="goal-conclusion"> `d[t1, t2]  &lt;= size p1</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>1ab</q><label class="goal-separator"><hr></label><div class="goal-conclusion"> `d[t1, t2]  &lt;= size p1 -&gt; <span class="mi">0</span> = j.+<span class="mi">1</span></div></blockquote><q>189</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span>: gdist_path_le.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1ab</q><span class="goal-separator"><hr></span><q>1be</q></blockquote><q>188</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> leqNgt =&gt; /negP[].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1ab</q><span class="goal-separator"><hr></span><div class="goal-conclusion">size p1 &lt;  `d[t1, t2] </div></blockquote><q>188</q></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> size_drop dt1t2E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1ab</q><span class="goal-separator"><hr></span><div class="goal-conclusion">size p - j.+<span class="mi">1</span> &lt; size p</div></blockquote><q>188</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> /= <span class="kr">in</span> t1E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><q>2b</q><q>f5</q><q>f6</q><q>179</q><q>145</q><q>17f</q><q>190</q><q>198</q><q>1ac</q><q>1a1</q></div><span class="goal-separator"><hr></span><q>1c9</q></blockquote><q>188</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -{<span class="mi">2</span>}[size p](subnK (_ : j &lt; size p)) // addnS ltnS leq_addr.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>18a</q><span class="goal-separator"><hr></span><q>18b</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; i iH; <span class="nb">rewrite</span> ltnS =&gt; iLj nE.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><q>2b</q><q>f5</q><q>f6</q><q>179</q><q>145</q><q>17f</q><q>17e</q><div><var>iH</var><span class="hyp-type"><b>:</b><span>i.+<span class="mi">1</span> \<span class="kr">in</span> gtn (size (t1 :: p))</span></span></div><q>174</q><div><var>nE</var><span class="hyp-type"><b>:</b><span>nth t1 (t1 :: p) i.+<span class="mi">1</span> = nth t1 (t1 :: p) j.+<span class="mi">1</span></span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion">i.+<span class="mi">1</span> = j.+<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">pose</span> p1 := take i.+<span class="mi">1</span> p ++ drop j.+<span class="mi">1</span> p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><q>2b</q><q>f5</q><q>f6</q><q>179</q><q>145</q><q>17f</q><q>17e</q><q>1d5</q><q>174</q><q>1d6</q><div><var>p1</var><span><span class="hyp-body"><b>:=</b><span>take i.+<span class="mi">1</span> p ++ drop j.+<span class="mi">1</span> p</span></span><span class="hyp-type"><b>:</b><span>seq T</span></span></span></div></div><span class="goal-separator"><hr></span><q>1d7</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> [] := boolP (`d[t1, t2] &lt;= size p1) =&gt; [|/negP[]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1db</q><span class="goal-separator"><hr></span><div class="goal-conclusion"> `d[t1, t2]  &lt;= size p1 -&gt; i.+<span class="mi">1</span> = j.+<span class="mi">1</span></div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>1db</q><label class="goal-separator"><hr></label><q>1bb</q></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> leqNgt =&gt; /negP[].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1db</q><span class="goal-separator"><hr></span><q>1c5</q></blockquote><q>1e1</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> size_cat size_take size_drop ifT //; <span class="nb">last first</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1db</q><span class="goal-separator"><hr></span><div class="goal-conclusion">i.+<span class="mi">1</span> &lt; size p</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>1db</q><label class="goal-separator"><hr></label><div class="goal-conclusion">i.+<span class="mi">1</span> + (size p - j.+<span class="mi">1</span>) &lt;  `d[t1, t2] </div></blockquote><q>1e2</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -ltnS <span class="kr">in</span> iLj; <span class="nb">apply</span>: leq_trans iLj _.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1db</q><span class="goal-separator"><hr></span><q>1ec</q></blockquote><q>1e1</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> dt1t2E -{<span class="mi">2</span>}[size p](subnK (_ : j &lt; size _)) //.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1db</q><span class="goal-separator"><hr></span><div class="goal-conclusion">i.+<span class="mi">1</span> + (size p - j.+<span class="mi">1</span>) &lt; size p - j.+<span class="mi">1</span> + j.+<span class="mi">1</span></div></blockquote><q>1e1</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> addnC ltn_add2l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1db</q><span class="goal-separator"><hr></span><q>1bb</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">apply</span>: gdist_path_le.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1db</q><span class="goal-separator"><hr></span><q>194</q></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>1db</q><label class="goal-separator"><hr></label><q>1a8</q></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: t1Pp; <span class="nb">rewrite</span> -[p](cat_take_drop i.+<span class="mi">1</span>).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><q>2b</q><q>f6</q><q>179</q><q>145</q><q>17f</q><q>17e</q><q>1d5</q><q>174</q><q>1d6</q><q>1dc</q></div><span class="goal-separator"><hr></span><div class="goal-conclusion">path r t1 (take i.+<span class="mi">1</span> p ++ drop i.+<span class="mi">1</span> p) -&gt; path r t1 p1</div></blockquote><q>1fa</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> -[drop _ _](cat_take_drop (j - i)) !cat_path.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1ff</q><span class="goal-separator"><hr></span><div class="goal-conclusion">[&amp;&amp; path r t1 (take i.+<span class="mi">1</span> p),
    path r (<span class="nb">last</span> t1 (take i.+<span class="mi">1</span> p))
      (take (j - i) (drop i.+<span class="mi">1</span> p))
  &amp; path r
      (<span class="nb">last</span> (<span class="nb">last</span> t1 (take i.+<span class="mi">1</span> p))
         (take (j - i) (drop i.+<span class="mi">1</span> p)))
      (drop (j - i) (drop i.+<span class="mi">1</span> p))] -&gt;
path r t1 (take i.+<span class="mi">1</span> p) &amp;&amp;
path r (<span class="nb">last</span> t1 (take i.+<span class="mi">1</span> p)) (drop j.+<span class="mi">1</span> p)</div></blockquote><q>1fa</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">case</span>/and3P =&gt; [-&gt; _] /=.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1ff</q><span class="goal-separator"><hr></span><div class="goal-conclusion">path r
  (<span class="nb">last</span> (<span class="nb">last</span> t1 (take i.+<span class="mi">1</span> p))
     (take (j - i) (drop i.+<span class="mi">1</span> p)))
  (drop (j - i) (drop i.+<span class="mi">1</span> p)) -&gt;
path r (<span class="nb">last</span> t1 (take i.+<span class="mi">1</span> p)) (drop j.+<span class="mi">1</span> p)</div></blockquote><q>1fa</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> !(last_take t1) /=; <span class="nb">last first</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1ff</q><span class="goal-separator"><hr></span><div class="goal-conclusion">j - i &lt;= size (drop i.+<span class="mi">1</span> p)</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>1ff</q><label class="goal-separator"><hr></label><div class="goal-conclusion">i &lt; size p</div></blockquote><blockquote class="alectryon-goal"><q>1ff</q><label class="goal-separator"><hr></label><div class="goal-conclusion">path r (nth t1 (nth t1 p i :: drop i.+<span class="mi">1</span> p) (j - i))
  (drop (j - i) (drop i.+<span class="mi">1</span> p)) -&gt;
path r (nth t1 p i) (drop j.+<span class="mi">1</span> p)</div></blockquote><q>1fb</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>20a</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> size_drop -subSS.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1ff</q><span class="goal-separator"><hr></span><div class="goal-conclusion">j.+<span class="mi">1</span> - i.+<span class="mi">1</span> &lt;= size p - i.+<span class="mi">1</span></div></blockquote><q>20d</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span>: leq_sub2r.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1ff</q><span class="goal-separator"><hr></span><q>20f</q></blockquote><div class="alectryon-extra-goals"><q>210</q><q>1fb</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>218</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span>: leq_trans iLj _; <span class="nb">rewrite</span> ltnW //.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1ff</q><span class="goal-separator"><hr></span><q>211</q></blockquote><q>1fa</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> drop_drop addnS subnK; <span class="nb">last</span> <span class="bp">by</span> <span class="nb">rewrite</span> ltnW.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1ff</q><span class="goal-separator"><hr></span><div class="goal-conclusion">path r (nth t1 (nth t1 p i :: drop i.+<span class="mi">1</span> p) (j - i))
  (drop j.+<span class="mi">1</span> p) -&gt; path r (nth t1 p i) (drop j.+<span class="mi">1</span> p)</div></blockquote><q>1fa</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">congr</span> path.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1ff</q><span class="goal-separator"><hr></span><div class="goal-conclusion">nth t1 (nth t1 p i :: drop i.+<span class="mi">1</span> p) (j - i) =
nth t1 p i</div></blockquote><q>1fa</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: (nE) =&gt; /= -&gt;.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1ff</q><span class="goal-separator"><hr></span><div class="goal-conclusion">nth t1 (nth t1 p j :: drop i.+<span class="mi">1</span> p) (j - i) =
nth t1 p j</div></blockquote><q>1fa</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> -[j - i]prednK //.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1ff</q><span class="goal-separator"><hr></span><div class="goal-conclusion">nth t1 (nth t1 p j :: drop i.+<span class="mi">1</span> p) (j - i).-<span class="mi">1</span>.+<span class="mi">1</span> =
nth t1 p j</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>1ff</q><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="mi">0</span> &lt; j - i</div></blockquote><q>1fb</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> /= nth_drop -subnS addnC subnK //.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1ff</q><span class="goal-separator"><hr></span><q>231</q></blockquote><q>1fa</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> subn_gt0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1db</q><span class="goal-separator"><hr></span><q>1a8</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> last_cat (last_take t1) // nE.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>1db</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">last</span> (nth t1 (t1 :: p) j.+<span class="mi">1</span>) (drop j.+<span class="mi">1</span> p) = t2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -t1pLt2 -{<span class="mi">3</span>}[p](cat_take_drop j.+<span class="mi">1</span>) last_cat (last_take t1).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">

</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gpath_catl</span> <span class="nv">t1</span> <span class="nv">t2</span> <span class="nv">p1</span> <span class="nv">p2</span> : 
   gpath t1 t2 (p1 ++ p2) -&gt; gpath t1 (<span class="nb">last</span> t1 p1) p1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><div><var>p1, p2</var><span class="hyp-type"><b>:</b><span>seq T</span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion">gpath t1 t2 (p1 ++ p2) -&gt; gpath t1 (<span class="nb">last</span> t1 p1) p1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>23d</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; /gpathP[].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>23f</q><span class="goal-separator"><hr></span><div class="goal-conclusion">path r t1 (p1 ++ p2) -&gt;
<span class="nb">last</span> t1 (p1 ++ p2) = t2 -&gt;
 `d[t1, t2]  = size (p1 ++ p2) -&gt;
gpath t1 (<span class="nb">last</span> t1 p1) p1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> cat_path last_cat =&gt; /andP[t1Pp1 t1p1LPp2] t1p1Lp2Lt2 dt1t2E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><q>240</q><q>198</q><div><var>t1p1LPp2</var><span class="hyp-type"><b>:</b><span>path r (<span class="nb">last</span> t1 p1) p2</span></span></div><div><var>t1p1Lp2Lt2</var><span class="hyp-type"><b>:</b><span><span class="nb">last</span> (<span class="nb">last</span> t1 p1) p2 = t2</span></span></div><div><var>dt1t2E</var><span class="hyp-type"><b>:</b><span> `d[t1, t2]  = size (p1 ++ p2)</span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion">gpath t1 (<span class="nb">last</span> t1 p1) p1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">apply</span>/gpathP; <span class="nb">split</span> =&gt; //.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>24a</q><span class="goal-separator"><hr></span><div class="goal-conclusion"> `d[t1, <span class="nb">last</span> t1 p1]  = size p1</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> : `d[t1, <span class="nb">last</span> t1 p1] &lt;= size p1 <span class="bp">by</span> <span class="nb">rewrite</span> gdist_path_le.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>24a</q><span class="goal-separator"><hr></span><div class="goal-conclusion"> `d[t1, <span class="nb">last</span> t1 p1]  &lt;= size p1 -&gt;
 `d[t1, <span class="nb">last</span> t1 p1]  = size p1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> leq_eqVlt =&gt; /orP[/eqP//|dLSp1].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><q>240</q><q>198</q><q>24b</q><q>24c</q><q>24d</q><div><var>dLSp1</var><span class="hyp-type"><b>:</b><span> `d[t1, <span class="nb">last</span> t1 p1]  &lt; size p1</span></span></div></div><span class="goal-separator"><hr></span><q>252</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> /gpath_connect[p3 /gpathP[H1 H2 H3]] : 
   connect r t1 (<span class="nb">last</span> t1 p1) <span class="bp">by</span> <span class="nb">apply</span>/connectP; <span class="kr">exists</span> <span class="nv">p1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><q>240</q><q>198</q><q>24b</q><q>24c</q><q>24d</q><q>25b</q><div><var>p3</var><span class="hyp-type"><b>:</b><span>seq T</span></span></div><div><var>H1</var><span class="hyp-type"><b>:</b><span>path r t1 p3</span></span></div><div><var>H2</var><span class="hyp-type"><b>:</b><span><span class="nb">last</span> t1 p3 = <span class="nb">last</span> t1 p1</span></span></div><div><var>H3</var><span class="hyp-type"><b>:</b><span> `d[t1, <span class="nb">last</span> t1 p1]  = size p3</span></span></div></div><span class="goal-separator"><hr></span><q>252</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> : size (p3 ++ p2) &lt; `d[t1, t2] <span class="bp">by</span> <span class="nb">rewrite</span> dt1t2E !size_cat -H3 ltn_add2r.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>25f</q><span class="goal-separator"><hr></span><div class="goal-conclusion">size (p3 ++ p2) &lt;  `d[t1, t2]  -&gt;
 `d[t1, <span class="nb">last</span> t1 p1]  = size p1</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> ltnNge =&gt; /negP[].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>25f</q><span class="goal-separator"><hr></span><div class="goal-conclusion"> `d[t1, t2]  &lt;= size (p3 ++ p2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">apply</span>: gdist_path_le; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> cat_path H1 // H2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>25f</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">last</span> t1 (p3 ++ p2) = t2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> last_cat H2.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gpath_catr</span> <span class="nv">t1</span> <span class="nv">t2</span> <span class="nv">p1</span> <span class="nv">p2</span> : 
   gpath t1 t2 (p1 ++ p2) -&gt; gpath (<span class="nb">last</span> t1 p1) t2 p2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>23f</q><span class="goal-separator"><hr></span><div class="goal-conclusion">gpath t1 t2 (p1 ++ p2) -&gt; gpath (<span class="nb">last</span> t1 p1) t2 p2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>271</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; /gpathP[].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>23f</q><span class="goal-separator"><hr></span><div class="goal-conclusion">path r t1 (p1 ++ p2) -&gt;
<span class="nb">last</span> t1 (p1 ++ p2) = t2 -&gt;
 `d[t1, t2]  = size (p1 ++ p2) -&gt;
gpath (<span class="nb">last</span> t1 p1) t2 p2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> cat_path last_cat =&gt; /andP[t1Pp1 t1p1LPp2] t1p1Lp2Lt2 dt1t2E.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>24a</q><span class="goal-separator"><hr></span><div class="goal-conclusion">gpath (<span class="nb">last</span> t1 p1) t2 p2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">apply</span>/gpathP; <span class="nb">split</span> =&gt; //.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>24a</q><span class="goal-separator"><hr></span><div class="goal-conclusion"> `d[<span class="nb">last</span> t1 p1, t2]  = size p2</div></blockquote></div></div></small><span class="alectryon-wsp"> 
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> : `d[<span class="nb">last</span> t1 p1, t2] &lt;= size p2 <span class="bp">by</span> <span class="nb">rewrite</span> gdist_path_le.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>24a</q><span class="goal-separator"><hr></span><div class="goal-conclusion"> `d[<span class="nb">last</span> t1 p1, t2]  &lt;= size p2 -&gt;
 `d[<span class="nb">last</span> t1 p1, t2]  = size p2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> leq_eqVlt =&gt; /orP[/eqP//|dLSp1].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><q>240</q><q>198</q><q>24b</q><q>24c</q><q>24d</q><div><var>dLSp1</var><span class="hyp-type"><b>:</b><span> `d[<span class="nb">last</span> t1 p1, t2]  &lt; size p2</span></span></div></div><span class="goal-separator"><hr></span><q>280</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> /gpath_connect[p3 /gpathP[H1 H2 H3]] : 
   connect r (<span class="nb">last</span> t1 p1) t2 <span class="bp">by</span> <span class="nb">apply</span>/connectP; <span class="kr">exists</span> <span class="nv">p2</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><q>240</q><q>198</q><q>24b</q><q>24c</q><q>24d</q><q>289</q><q>260</q><div><var>H1</var><span class="hyp-type"><b>:</b><span>path r (<span class="nb">last</span> t1 p1) p3</span></span></div><div><var>H2</var><span class="hyp-type"><b>:</b><span><span class="nb">last</span> (<span class="nb">last</span> t1 p1) p3 = t2</span></span></div><div><var>H3</var><span class="hyp-type"><b>:</b><span> `d[<span class="nb">last</span> t1 p1, t2]  = size p3</span></span></div></div><span class="goal-separator"><hr></span><q>280</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> : size (p1 ++ p3) &lt; `d[t1, t2] <span class="bp">by</span> <span class="nb">rewrite</span> dt1t2E !size_cat -H3 ltn_add2l.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>28d</q><span class="goal-separator"><hr></span><div class="goal-conclusion">size (p1 ++ p3) &lt;  `d[t1, t2]  -&gt;
 `d[<span class="nb">last</span> t1 p1, t2]  = size p2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> ltnNge =&gt; /negP[].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>28d</q><span class="goal-separator"><hr></span><div class="goal-conclusion"> `d[t1, t2]  &lt;= size (p1 ++ p3)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">apply</span>: gdist_path_le; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> cat_path H1 andbT.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>28d</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">last</span> t1 (p1 ++ p3) = t2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> last_cat.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gdist_cat</span> <span class="nv">t1</span> <span class="nv">t2</span> <span class="nv">p1</span> <span class="nv">p2</span> : 
   gpath t1 t2 (p1 ++ p2) -&gt; 
   `d[t1,t2] = `d[t1, <span class="nb">last</span> t1 p1] + `d[<span class="nb">last</span> t1 p1, t2].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>23f</q><span class="goal-separator"><hr></span><div class="goal-conclusion">gpath t1 t2 (p1 ++ p2) -&gt;
 `d[t1, t2]  =
 `d[t1, <span class="nb">last</span> t1 p1]  +  `d[<span class="nb">last</span> t1 p1, t2] </div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>29e</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; gH.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><q>240</q><div><var>gH</var><span class="hyp-type"><b>:</b><span>gpath t1 t2 (p1 ++ p2)</span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"> `d[t1, t2]  =
 `d[t1, <span class="nb">last</span> t1 p1]  +  `d[<span class="nb">last</span> t1 p1, t2] </div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> (gpath_dist gH).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>2a5</q><span class="goal-separator"><hr></span><div class="goal-conclusion">size (p1 ++ p2) =
 `d[t1, <span class="nb">last</span> t1 p1]  +  `d[<span class="nb">last</span> t1 p1, t2] </div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> (gpath_dist (gpath_catl gH)) (gpath_dist (gpath_catr gH)) //.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>2a5</q><span class="goal-separator"><hr></span><div class="goal-conclusion">size (p1 ++ p2) = size p1 + size p2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> size_cat.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gpath_consl</span> <span class="nv">t1</span> <span class="nv">t2</span> <span class="nv">t3</span> <span class="nv">p</span> :  gpath t1 t2 (t3 :: p) -&gt; `d[t1, t3] = <span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><div><var>t1, t2, t3</var><span class="hyp-type"><b>:</b><span>T</span></span></div><q>2b</q></div><span class="goal-separator"><hr></span><div class="goal-conclusion">gpath t1 t2 (t3 :: p) -&gt;  `d[t1, t3]  = <span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>2b1</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; /(@gpath_catl _ _ [::t3]) /= /gpathP[].</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gpath_consr</span> <span class="nv">t1</span> <span class="nv">t2</span> <span class="nv">t3</span> <span class="nv">p</span> : gpath t1 t2 (t3 :: p) -&gt; gpath t3 t2 p.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>2b3</q><span class="goal-separator"><hr></span><div class="goal-conclusion">gpath t1 t2 (t3 :: p) -&gt; gpath t3 t2 p</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>2b8</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; /(@gpath_catr _ _ [::t3]).</span><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gdist_cons</span> <span class="nv">t1</span> <span class="nv">t2</span> <span class="nv">t3</span> <span class="nv">p</span> : 
   gpath t1 t2 (t3 :: p) -&gt; `d[t1,t2] = `d[t3, t2].+<span class="mi">1</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>2b3</q><span class="goal-separator"><hr></span><div class="goal-conclusion">gpath t1 t2 (t3 :: p) -&gt;
 `d[t1, t2]  =  `d[t3, t2] .+<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>2bd</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; gH.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>2b4</q><q>2b</q><div><var>gH</var><span class="hyp-type"><b>:</b><span>gpath t1 t2 (t3 :: p)</span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"> `d[t1, t2]  =  `d[t3, t2] .+<span class="mi">1</span></div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> (@gdist_cat _ _ [::t3] p) // (gpath_consl gH).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp"> 
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gdist_triangular</span> <span class="nv">t1</span> <span class="nv">t2</span> <span class="nv">t3</span> : `d[t1, t2] &lt;= `d[t1, t3] + `d[t3, t2].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>2b4</q></div><span class="goal-separator"><hr></span><div class="goal-conclusion"> `d[t1, t2]  &lt;=  `d[t1, t3]  +  `d[t3, t2] </div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>2c8</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> [/gpath_connect[p pH]|/gdist_nconnect-&gt;] 
         := boolP (connect r t1 t3); <span class="nb">last first</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>2ca</q><span class="goal-separator"><hr></span><div class="goal-conclusion"> `d[t1, t2]  &lt;= #|T| +  `d[t3, t2] </div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>2b4</q><q>2b</q><div><var>pH</var><span class="hyp-type"><b>:</b><span>gpath t1 t3 p</span></span></div></div><label class="goal-separator"><hr></label><q>2cb</q></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span>: leq_trans (gdist_card_le _ _) (leq_addr _ _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>2d3</q><span class="goal-separator"><hr></span><q>2cb</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> [/gpath_connect [p2 p2H] |/gdist_nconnect-&gt;] 
         := boolP (connect r t3 t2); <span class="nb">last first</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>2d3</q><span class="goal-separator"><hr></span><div class="goal-conclusion"> `d[t1, t2]  &lt;=  `d[t1, t3]  + #|T|</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>2b4</q><q>2b</q><q>2d4</q><div><var>p2</var><span class="hyp-type"><b>:</b><span>seq T</span></span></div><div><var>p2H</var><span class="hyp-type"><b>:</b><span>gpath t3 t2 p2</span></span></div></div><label class="goal-separator"><hr></label><q>2cb</q></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span>: leq_trans (gdist_card_le _ _) (leq_addl _ _).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>2de</q><span class="goal-separator"><hr></span><q>2cb</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> (gpath_dist pH) (gpath_dist p2H) -size_cat.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>2de</q><span class="goal-separator"><hr></span><div class="goal-conclusion"> `d[t1, t2]  &lt;= size (p ++ p2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">apply</span>: gdist_path_le.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>2de</q><span class="goal-separator"><hr></span><div class="goal-conclusion">path r t1 (p ++ p2)</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>2de</q><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="nb">last</span> t1 (p ++ p2) = t2</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> cat_path (gpath_path pH).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>2de</q><span class="goal-separator"><hr></span><div class="goal-conclusion">true &amp;&amp; path r (<span class="nb">last</span> t1 p) p2</div></blockquote><q>2ec</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> (gpath_last pH) (gpath_path p2H).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>2de</q><span class="goal-separator"><hr></span><q>2ee</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> last_cat (gpath_last pH) (gpath_last p2H).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gdist1</span> <span class="nv">t1</span> <span class="nv">t2</span> : r t1 t2 -&gt; `d[t1, t2] = (t1 != t2).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>52</q><span class="goal-separator"><hr></span><div class="goal-conclusion">r t1 t2 -&gt;  `d[t1, t2]  = (t1 != t2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>2f7</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; Hr; <span class="nb">apply</span>/eqP.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><div><var>Hr</var><span class="hyp-type"><b>:</b><span>r t1 t2</span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"> `d[t1, t2]  == (t1 != t2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">case</span>: (t1 =P t2) =&gt; [&lt;-|/eqP HE]; <span class="kp">first</span> <span class="bp">by</span> <span class="nb">rewrite</span> gdist_eq0.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><q>2ff</q><div><var>HE</var><span class="hyp-type"><b>:</b><span>t1 != t2</span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"> `d[t1, t2]  == ~~ false</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> eqn_leq -{<span class="mi">1</span>}[nat_of_bool _]/(size [::t2]) gdist_path_le /= <span class="nl">?andbT</span> //.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>304</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt;  `d[t1, t2] </div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">case</span>: gdist (gdist_eq0 t1 t2); <span class="nb">rewrite</span> (negPf HE) .</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gdist_succ</span> <span class="nv">t1</span> <span class="nv">t2</span> : 
  <span class="mi">0</span> &lt; `d[t1, t2] &lt; #|T| -&gt; {t3 | r t1 t3 /\ `d[t3, t2] = `d[t1, t2].-<span class="mi">1</span>}.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>52</q><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt;  `d[t1, t2]  &lt; #|T| -&gt;
{t3 : T | r t1 t3 /\  `d[t3, t2]  =  `d[t1, t2] .-<span class="mi">1</span>}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>30c</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">case</span>/andP =&gt; dP dT.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><div><var>dP</var><span class="hyp-type"><b>:</b><span><span class="mi">0</span> &lt;  `d[t1, t2] </span></span></div><div><var>dT</var><span class="hyp-type"><b>:</b><span> `d[t1, t2]  &lt; #|T|</span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion">{t3 : T | r t1 t3 /\  `d[t3, t2]  =  `d[t1, t2] .-<span class="mi">1</span>}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>: dT dP.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>52</q><span class="goal-separator"><hr></span><div class="goal-conclusion"> `d[t1, t2]  &lt; #|T| -&gt;
<span class="mi">0</span> &lt;  `d[t1, t2]  -&gt;
{t3 : T | r t1 t3 /\  `d[t3, t2]  =  `d[t1, t2] .-<span class="mi">1</span>}</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> -gdist_connect =&gt; /gpath_connect[[|t3 p] pH].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><div><var>pH</var><span class="hyp-type"><b>:</b><span>gpath t1 t2 [::]</span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="mi">0</span> &lt;  `d[t1, t2]  -&gt;
{t3 : T | r t1 t3 /\  `d[t3, t2]  =  `d[t1, t2] .-<span class="mi">1</span>}</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>2b4</q><q>2b</q><div><var>pH</var><span class="hyp-type"><b>:</b><span>gpath t1 t2 (t3 :: p)</span></span></div></div><label class="goal-separator"><hr></label><q>320</q></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> (gpath_dist pH).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>323</q><span class="goal-separator"><hr></span><q>320</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kr">exists</span> <span class="nv">t3</span>; <span class="nb">split</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>2b4</q><q>2b</q><q>324</q><q>314</q></div><span class="goal-separator"><hr></span><div class="goal-conclusion">r t1 t3</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>32b</q><label class="goal-separator"><hr></label><div class="goal-conclusion"> `d[t3, t2]  =  `d[t1, t2] .-<span class="mi">1</span></div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">have</span> /andP[] := gpath_path (@gpath_catl _ _ [::t3] _ pH).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>32b</q><span class="goal-separator"><hr></span><q>32f</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> (gdist_cons pH).</span><span class="alectryon-wsp"> 
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gdist_neighboor</span> <span class="nv">t1</span> <span class="nv">t2</span> <span class="nv">t3</span> : r t1 t2 -&gt;
  r t2 t1 -&gt; [|| `d[t2, t3] == `d[t1, t3].-<span class="mi">1</span>,
                 `d[t2, t3] == `d[t1, t3] |
                 `d[t2, t3] == `d[t1, t3].+<span class="mi">1</span>].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>2ca</q><span class="goal-separator"><hr></span><div class="goal-conclusion">r t1 t2 -&gt;
r t2 t1 -&gt;
[||  `d[t2, t3]  ==  `d[t1, t3] .-<span class="mi">1</span>,
     `d[t2, t3]  ==  `d[t1, t3] 
  |  `d[t2, t3]  ==  `d[t1, t3] .+<span class="mi">1</span>]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>334</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; t1Rt2 t2Rt1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>2b4</q><div><var>t1Rt2</var><span class="hyp-type"><b>:</b><span>r t1 t2</span></span></div><div><var>t2Rt1</var><span class="hyp-type"><b>:</b><span>r t2 t1</span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion">[||  `d[t2, t3]  ==  `d[t1, t3] .-<span class="mi">1</span>,
     `d[t2, t3]  ==  `d[t1, t3] 
  |  `d[t2, t3]  ==  `d[t1, t3] .+<span class="mi">1</span>]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">have</span> : `d[t1, t3] - `d[t1, t2] &lt;= `d[t2, t3] &lt;= `d[t2, t1] + `d[t1, t3].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>33b</q><span class="goal-separator"><hr></span><div class="goal-conclusion"> `d[t1, t3]  -  `d[t1, t2]  &lt;=  `d[t2, t3]  &lt;=
 `d[t2, t1]  +  `d[t1, t3] </div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>33b</q><label class="goal-separator"><hr></label><div class="goal-conclusion"> `d[t1, t3]  -  `d[t1, t2]  &lt;=  `d[t2, t3]  &lt;=
 `d[t2, t1]  +  `d[t1, t3]  -&gt;
[||  `d[t2, t3]  ==  `d[t1, t3] .-<span class="mi">1</span>,
     `d[t2, t3]  ==  `d[t1, t3] 
  |  `d[t2, t3]  ==  `d[t1, t3] .+<span class="mi">1</span>]</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> leq_subLR !gdist_triangular.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>33b</q><span class="goal-separator"><hr></span><q>345</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> (gdist1 t1Rt2) (gdist1 t2Rt1).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>33b</q><span class="goal-separator"><hr></span><div class="goal-conclusion"> `d[t1, t3]  - (t1 != t2) &lt;=  `d[t2, t3]  &lt;=
(t2 != t1) +  `d[t1, t3]  -&gt;
[||  `d[t2, t3]  ==  `d[t1, t3] .-<span class="mi">1</span>,
     `d[t2, t3]  ==  `d[t1, t3] 
  |  `d[t2, t3]  ==  `d[t1, t3] .+<span class="mi">1</span>]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">(<span class="kp">do</span> <span class="mi">2</span> <span class="nb">case</span>: eqP) =&gt; //= E1 E2; <span class="nb">rewrite</span> <span class="nl">?subn0</span>.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>2b4</q><q>33c</q><q>33d</q><div><var>E1</var><span class="hyp-type"><b>:</b><span>t2 = t1</span></span></div><div><var>E2</var><span class="hyp-type"><b>:</b><span>t1 = t2</span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"> `d[t1, t3]  &lt;=  `d[t2, t3]  &lt;= <span class="mi">0</span> +  `d[t1, t3]  -&gt;
[||  `d[t2, t3]  ==  `d[t1, t3] .-<span class="mi">1</span>,
     `d[t2, t3]  ==  `d[t1, t3] 
  |  `d[t2, t3]  ==  `d[t1, t3] .+<span class="mi">1</span>]</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>2b4</q><q>33c</q><q>33d</q><div><var>E1</var><span class="hyp-type"><b>:</b><span>t2 &lt;&gt; t1</span></span></div><q>352</q></div><label class="goal-separator"><hr></label><div class="goal-conclusion"> `d[t1, t3]  &lt;=  `d[t2, t3]  &lt;= <span class="mi">1</span> +  `d[t1, t3]  -&gt;
[||  `d[t2, t3]  ==  `d[t1, t3] .-<span class="mi">1</span>,
     `d[t2, t3]  ==  `d[t1, t3] 
  |  `d[t2, t3]  ==  `d[t1, t3] .+<span class="mi">1</span>]</div></blockquote><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>2b4</q><q>33c</q><q>33d</q><q>351</q><div><var>E2</var><span class="hyp-type"><b>:</b><span>t1 &lt;&gt; t2</span></span></div></div><label class="goal-separator"><hr></label><div class="goal-conclusion"> `d[t1, t3]  - <span class="mi">1</span> &lt;=  `d[t2, t3]  &lt;= <span class="mi">0</span> +  `d[t1, t3]  -&gt;
[||  `d[t2, t3]  ==  `d[t1, t3] .-<span class="mi">1</span>,
     `d[t2, t3]  ==  `d[t1, t3] 
  |  `d[t2, t3]  ==  `d[t1, t3] .+<span class="mi">1</span>]</div></blockquote><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>2b4</q><q>33c</q><q>33d</q><q>357</q><q>35b</q></div><label class="goal-separator"><hr></label><div class="goal-conclusion"> `d[t1, t3]  - <span class="mi">1</span> &lt;=  `d[t2, t3]  &lt;= <span class="mi">1</span> +  `d[t1, t3]  -&gt;
[||  `d[t2, t3]  ==  `d[t1, t3] .-<span class="mi">1</span>,
     `d[t2, t3]  ==  `d[t1, t3] 
  |  `d[t2, t3]  ==  `d[t1, t3] .+<span class="mi">1</span>]</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>34e</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -eqn_leq =&gt; /eqP-&gt;; <span class="nb">rewrite</span> eqxx orbT.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>356</q><span class="goal-separator"><hr></span><q>358</q></blockquote><div class="alectryon-extra-goals"><q>359</q><q>35d</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>362</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">case</span>/andP=&gt; E3.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>2b4</q><q>33c</q><q>33d</q><q>357</q><q>352</q><div><var>E3</var><span class="hyp-type"><b>:</b><span> `d[t1, t3]  &lt;=  `d[t2, t3] </span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"> `d[t2, t3]  &lt;= <span class="mi">1</span> +  `d[t1, t3]  -&gt;
[||  `d[t2, t3]  ==  `d[t1, t3] .-<span class="mi">1</span>,
     `d[t2, t3]  ==  `d[t1, t3] 
  |  `d[t2, t3]  ==  `d[t1, t3] .+<span class="mi">1</span>]</div></blockquote><q>364</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> leq_eqVlt =&gt; /orP[/eqP-&gt;|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>369</q><span class="goal-separator"><hr></span><div class="goal-conclusion">[|| <span class="mi">1</span> +  `d[t1, t3]  ==  `d[t1, t3] .-<span class="mi">1</span>,
    <span class="mi">1</span> +  `d[t1, t3]  ==  `d[t1, t3] 
  | <span class="mi">1</span> +  `d[t1, t3]  ==  `d[t1, t3] .+<span class="mi">1</span>]</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>369</q><label class="goal-separator"><hr></label><div class="goal-conclusion"> `d[t2, t3]  &lt; <span class="mi">1</span> +  `d[t1, t3]  -&gt;
[||  `d[t2, t3]  ==  `d[t1, t3] .-<span class="mi">1</span>,
     `d[t2, t3]  ==  `d[t1, t3] 
  |  `d[t2, t3]  ==  `d[t1, t3] .+<span class="mi">1</span>]</div></blockquote><q>359</q><q>35d</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> eqxx !orbT.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>369</q><span class="goal-separator"><hr></span><q>372</q></blockquote><q>364</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> ltnS =&gt; E4.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>2b4</q><q>33c</q><q>33d</q><q>357</q><q>352</q><q>36a</q><div><var>E4</var><span class="hyp-type"><b>:</b><span> `d[t2, t3]  &lt;=  `d[t1, t3] </span></span></div></div><span class="goal-separator"><hr></span><q>33e</q></blockquote><q>364</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> [`d[_, _] == `d[_, _]]eqn_leq E3 E4 orbT.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>35a</q><span class="goal-separator"><hr></span><q>35c</q></blockquote><div class="alectryon-extra-goals"><q>35d</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>37c</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">case</span>/andP=&gt; E3.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>2b4</q><q>33c</q><q>33d</q><q>351</q><q>35b</q><div><var>E3</var><span class="hyp-type"><b>:</b><span> `d[t1, t3]  - <span class="mi">1</span> &lt;=  `d[t2, t3] </span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"> `d[t2, t3]  &lt;= <span class="mi">0</span> +  `d[t1, t3]  -&gt;
[||  `d[t2, t3]  ==  `d[t1, t3] .-<span class="mi">1</span>,
     `d[t2, t3]  ==  `d[t1, t3] 
  |  `d[t2, t3]  ==  `d[t1, t3] .+<span class="mi">1</span>]</div></blockquote><q>37e</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> leq_eqVlt =&gt; /orP[/eqP-&gt;|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>383</q><span class="goal-separator"><hr></span><div class="goal-conclusion">[|| <span class="mi">0</span> +  `d[t1, t3]  ==  `d[t1, t3] .-<span class="mi">1</span>,
    <span class="mi">0</span> +  `d[t1, t3]  ==  `d[t1, t3] 
  | <span class="mi">0</span> +  `d[t1, t3]  ==  `d[t1, t3] .+<span class="mi">1</span>]</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>383</q><label class="goal-separator"><hr></label><div class="goal-conclusion"> `d[t2, t3]  &lt; <span class="mi">0</span> +  `d[t1, t3]  -&gt;
[||  `d[t2, t3]  ==  `d[t1, t3] .-<span class="mi">1</span>,
     `d[t2, t3]  ==  `d[t1, t3] 
  |  `d[t2, t3]  ==  `d[t1, t3] .+<span class="mi">1</span>]</div></blockquote><q>35d</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> eqxx !orbT.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>383</q><span class="goal-separator"><hr></span><q>38c</q></blockquote><q>37e</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">case</span>: (`d[t1, t3]) E3 =&gt; //= d.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>2b4</q><q>33c</q><q>33d</q><q>351</q><q>35b</q><div><var>d</var><span class="hyp-type"><b>:</b><span>nat</span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion">d.+<span class="mi">1</span> - <span class="mi">1</span> &lt;=  `d[t2, t3]  -&gt;
 `d[t2, t3]  &lt; <span class="mi">0</span> + d.+<span class="mi">1</span> -&gt;
[||  `d[t2, t3]  == d,  `d[t2, t3]  == d.+<span class="mi">1</span>
  |  `d[t2, t3]  == d.+<span class="mi">2</span>]</div></blockquote><q>37e</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> subSS subn0 ltnS =&gt; E3 E4.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>2b4</q><q>33c</q><q>33d</q><q>351</q><q>35b</q><q>394</q><div><var>E3</var><span class="hyp-type"><b>:</b><span>d &lt;=  `d[t2, t3] </span></span></div><div><var>E4</var><span class="hyp-type"><b>:</b><span> `d[t2, t3]  &lt;= d</span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion">[||  `d[t2, t3]  == d,  `d[t2, t3]  == d.+<span class="mi">1</span>
  |  `d[t2, t3]  == d.+<span class="mi">2</span>]</div></blockquote><q>37e</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> [_ == d]eqn_leq E3 E4.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>35e</q><span class="goal-separator"><hr></span><q>35f</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">case</span>/andP=&gt; E3.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>2b4</q><q>33c</q><q>33d</q><q>357</q><q>35b</q><q>384</q></div><span class="goal-separator"><hr></span><q>36b</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> leq_eqVlt =&gt; /orP[/eqP-&gt;|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>3a3</q><span class="goal-separator"><hr></span><q>36f</q></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>3a3</q><label class="goal-separator"><hr></label><q>372</q></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> eqxx !orbT.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>3a3</q><span class="goal-separator"><hr></span><q>372</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> ltnS leq_eqVlt =&gt; /orP[/eqP-&gt;|].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>3a3</q><span class="goal-separator"><hr></span><div class="goal-conclusion">[||  `d[t1, t3]  ==  `d[t1, t3] .-<span class="mi">1</span>,
     `d[t1, t3]  ==  `d[t1, t3] 
  |  `d[t1, t3]  ==  `d[t1, t3] .+<span class="mi">1</span>]</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>3a3</q><label class="goal-separator"><hr></label><div class="goal-conclusion"> `d[t2, t3]  &lt;  `d[t1, t3]  -&gt;
[||  `d[t2, t3]  ==  `d[t1, t3] .-<span class="mi">1</span>,
     `d[t2, t3]  ==  `d[t1, t3] 
  |  `d[t2, t3]  ==  `d[t1, t3] .+<span class="mi">1</span>]</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> eqxx !orbT.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>3a3</q><span class="goal-separator"><hr></span><q>3b2</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">case</span>: (`d[t1, t3]) E3 =&gt; //= d.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>2b4</q><q>33c</q><q>33d</q><q>357</q><q>35b</q><q>394</q></div><span class="goal-separator"><hr></span><div class="goal-conclusion">d.+<span class="mi">1</span> - <span class="mi">1</span> &lt;=  `d[t2, t3]  -&gt;
 `d[t2, t3]  &lt; d.+<span class="mi">1</span> -&gt;
[||  `d[t2, t3]  == d,  `d[t2, t3]  == d.+<span class="mi">1</span>
  |  `d[t2, t3]  == d.+<span class="mi">2</span>]</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> subSS subn0 ltnS =&gt; E3 E4.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>2b4</q><q>33c</q><q>33d</q><q>357</q><q>35b</q><q>394</q><q>39a</q><q>39b</q></div><span class="goal-separator"><hr></span><q>39c</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> [_ == d]eqn_leq E3 E4.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">gdist</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Notation</span> <span class="s2">&quot; `d[ t1 , t2 ]_ r &quot;</span> := (gdist r t1 t2) (<span class="kn">at level</span> <span class="mi">10</span>,
  <span class="kn">format</span> <span class="s2">&quot;`d[ t1 ,  t2 ]_ r&quot;</span>).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Section</span> <span class="nf">gdistProp</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variable</span> <span class="nv">T</span> : finType.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Variable</span> <span class="nv">r</span> : rel T.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">eq_connectn</span> (<span class="nv">r1</span> <span class="nv">r2</span> : rel T) : r1 =<span class="mi">2</span> r2 -&gt; connectn r1 =<span class="mi">2</span> connectn r2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><div><var>r, r1, r2</var><span class="hyp-type"><b>:</b><span>rel T</span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion">r1 =<span class="mi">2</span> r2 -&gt; connectn r1 =<span class="mi">2</span> connectn r2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>3c0</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; r1Er2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>3c3</q><div><var>r1Er2</var><span class="hyp-type"><b>:</b><span>r1 =<span class="mi">2</span> r2</span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion">connectn r1 =<span class="mi">2</span> connectn r2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">elim</span> =&gt; //= n IH y; <span class="nb">apply</span>: eq_big =&gt; // i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>3c3</q><q>3ca</q><q>7</q><div><var>IH</var><span class="hyp-type"><b>:</b><span><span class="kr">forall</span> <span class="nv">y</span> : T, connectn r1 n y = connectn r2 n y</span></span></div><div><var>y, i</var><span class="hyp-type"><b>:</b><span>T</span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(i \<span class="kr">in</span> rgraph r1 y) = (i \<span class="kr">in</span> rgraph r2 y)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> ![_ \<span class="kr">in</span> _]rgraphK r1Er2.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">eq_dist</span> (<span class="nv">r1</span> <span class="nv">r2</span> : rel T) : r1 =<span class="mi">2</span> r2 -&gt; gdist r1 =<span class="mi">2</span> gdist r2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>3c2</q><span class="goal-separator"><hr></span><div class="goal-conclusion">r1 =<span class="mi">2</span> r2 -&gt; gdist r1 =<span class="mi">2</span> gdist r2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>3d4</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; r1Er2 t1 t2.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>3c3</q><q>3ca</q><q>53</q></div><span class="goal-separator"><hr></span><div class="goal-conclusion">`d[t1, t2]_r1 = `d[t1, t2]_r2</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">apply</span>: eq_find =&gt; n.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>3c3</q><q>3ca</q><q>53</q><q>7</q></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(t2 \<span class="kr">in</span> connectn r1 n t1) = (t2 \<span class="kr">in</span> connectn r2 n t1)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> (eq_connectn r1Er2).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gdist_sym</span> <span class="nv">t1</span> <span class="nv">t2</span> :
 `d[t1, t2]_r  =  `d[t2, t1]_(<span class="kr">fun</span> <span class="nv">z</span> : T =&gt; r^~ z).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>52</q><span class="goal-separator"><hr></span><div class="goal-conclusion">`d[t1, t2]_r = `d[t2, t1]_(<span class="kr">fun</span> <span class="nv">z</span> : T =&gt; r^~ z)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>3e3</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">apply</span>: eq_find =&gt; i.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><q>17e</q></div><span class="goal-separator"><hr></span><div class="goal-conclusion">(t2 \<span class="kr">in</span> connectn r i t1) =
(t1 \<span class="kr">in</span> connectn (<span class="kr">fun</span> <span class="nv">z</span> : T =&gt; r^~ z) i t2)</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">apply</span>/connectnP/connectnP =&gt; /= [] [p [H1p H2p H3p]].</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><q>17e</q><q>2b</q><q>d9</q><q>da</q><div><var>H3p</var><span class="hyp-type"><b>:</b><span>size p = i</span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">p</span> : seq T,
  [/\ path (<span class="kr">fun</span> <span class="nv">z</span> : T =&gt; r^~ z) t2 p, <span class="nb">last</span> t2 p = t1
    &amp; size p = i]</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><q>17e</q><q>2b</q><div><var>H1p</var><span class="hyp-type"><b>:</b><span>path (<span class="kr">fun</span> <span class="nv">z</span> : T =&gt; r^~ z) t2 p</span></span></div><div><var>H2p</var><span class="hyp-type"><b>:</b><span><span class="nb">last</span> t2 p = t1</span></span></div><q>3f0</q></div><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="kr">exists</span> <span class="nv">p</span> : seq T,
  [/\ path r t1 p, <span class="nb">last</span> t1 p = t2 &amp; size p = i]</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kr">exists</span> (<span class="nv">rev</span> (belast t1 p)); <span class="nb">split</span> =&gt; //.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>3ef</q><span class="goal-separator"><hr></span><div class="goal-conclusion">path (<span class="kr">fun</span> <span class="nv">z</span> : T =&gt; r^~ z) t2 (rev (belast t1 p))</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>3ef</q><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="nb">last</span> t2 (rev (belast t1 p)) = t1</div></blockquote><blockquote class="alectryon-goal"><q>3ef</q><label class="goal-separator"><hr></label><div class="goal-conclusion">size (rev (belast t1 p)) = i</div></blockquote><q>3f3</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>3f9</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -H2p rev_path.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>3ef</q><span class="goal-separator"><hr></span><q>3fe</q></blockquote><div class="alectryon-extra-goals"><q>3ff</q><q>3f3</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>403</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> -H2p; <span class="nb">case</span>: (p) =&gt; //= a p1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><q>17e</q><q>2b</q><q>d9</q><q>da</q><q>3f0</q><div><var>a</var><span class="hyp-type"><b>:</b><span>T</span></span></div><div><var>p1</var><span class="hyp-type"><b>:</b><span>seq T</span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">last</span> (<span class="nb">last</span> a p1) (rev (t1 :: belast a p1)) = t1</div></blockquote><q>405</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">    </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> rev_cons last_rcons.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>3ef</q><span class="goal-separator"><hr></span><q>400</q></blockquote><q>3f2</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> size_rev size_belast.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>3f4</q><span class="goal-separator"><hr></span><q>3f7</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kr">exists</span> (<span class="nv">rev</span> (belast t2 p)); <span class="nb">split</span> =&gt; //.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>3f4</q><span class="goal-separator"><hr></span><div class="goal-conclusion">path r t1 (rev (belast t2 p))</div></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>3f4</q><label class="goal-separator"><hr></label><div class="goal-conclusion"><span class="nb">last</span> t1 (rev (belast t2 p)) = t2</div></blockquote><blockquote class="alectryon-goal"><q>3f4</q><label class="goal-separator"><hr></label><div class="goal-conclusion">size (rev (belast t2 p)) = i</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>415</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -H2p rev_path.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>3f4</q><span class="goal-separator"><hr></span><q>41a</q></blockquote><div class="alectryon-extra-goals"><q>41b</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>41f</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">rewrite</span> -H2p; <span class="nb">case</span>: (p) =&gt; //= a p1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><q>17e</q><q>2b</q><q>3f5</q><q>3f6</q><q>3f0</q><q>40b</q><q>40c</q></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">last</span> (<span class="nb">last</span> a p1) (rev (t2 :: belast a p1)) = t2</div></blockquote><q>421</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> rev_cons last_rcons.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>3f4</q><span class="goal-separator"><hr></span><q>41c</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> size_rev size_belast.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gpath_rev</span> <span class="nv">t1</span> <span class="nv">t2</span> <span class="nv">p</span> : gpath r t1 t2 p -&gt; gpath (<span class="kr">fun</span> <span class="nv">z</span> : T =&gt; r^~ z) t2 t1 (rev (belast t1 p)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>80</q><span class="goal-separator"><hr></span><div class="goal-conclusion">gpath r t1 t2 p -&gt;
gpath (<span class="kr">fun</span> <span class="nv">z</span> : T =&gt; r^~ z) t2 t1 (rev (belast t1 p))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>42c</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; /gpathP[H1 H2] H3.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><q>2b</q><div><var>H1</var><span class="hyp-type"><b>:</b><span>path r t1 p</span></span></div><div><var>H2</var><span class="hyp-type"><b>:</b><span><span class="nb">last</span> t1 p = t2</span></span></div><div><var>H3</var><span class="hyp-type"><b>:</b><span>`d[t1, t2]_r = size p</span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion">gpath (<span class="kr">fun</span> <span class="nv">z</span> : T =&gt; r^~ z) t2 t1 (rev (belast t1 p))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">apply</span>/gpathP; <span class="nb">split</span> =&gt; //.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>433</q><span class="goal-separator"><hr></span><q>3fb</q></blockquote><div class="alectryon-extra-goals"><blockquote class="alectryon-goal"><q>433</q><label class="goal-separator"><hr></label><q>3fe</q></blockquote><blockquote class="alectryon-goal"><q>433</q><label class="goal-separator"><hr></label><div class="goal-conclusion">`d[t2, t1]_(<span class="kr">fun</span> <span class="nv">z</span> : T =&gt; r^~ z) =
size (rev (belast t1 p))</div></blockquote></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>439</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> -rev_path H2 <span class="kr">in</span> H1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>433</q><span class="goal-separator"><hr></span><q>3fe</q></blockquote><div class="alectryon-extra-goals"><q>43d</q></div></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input">-</label><small class="alectryon-output"><div><q>441</q></div></small><span class="alectryon-wsp"> </span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">case</span>: (p) H2 =&gt; //= a p1.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><q>2b</q><q>434</q><q>436</q><q>40b</q><q>40c</q></div><span class="goal-separator"><hr></span><div class="goal-conclusion"><span class="nb">last</span> a p1 = t2 -&gt;
<span class="nb">last</span> t2 (rev (t1 :: belast a p1)) = t1</div></blockquote><q>443</q></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">  </span><span class="alectryon-sentence"><label class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> /= rev_cons last_rcons.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>433</q><span class="goal-separator"><hr></span><q>43e</q></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> size_rev size_belast -gdist_sym.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gdistC</span> <span class="nv">t1</span> <span class="nv">t2</span> : symmetric r -&gt; `d[t1, t2]_r  =  `d[t2, t1]_r.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>52</q><span class="goal-separator"><hr></span><div class="goal-conclusion">symmetric r -&gt; `d[t1, t2]_r = `d[t2, t1]_r</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>44e</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; rSym; <span class="nb">rewrite</span> gdist_sym.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><div><var>rSym</var><span class="hyp-type"><b>:</b><span>symmetric r</span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion">`d[t2, t1]_(<span class="kr">fun</span> <span class="nv">z</span> : T =&gt; r^~ z) = `d[t2, t1]_r</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">apply</span>: eq_dist.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">eq_gpath</span> (<span class="nv">e1</span> <span class="nv">e2</span> : rel T) <span class="nv">t1</span> <span class="nv">t2</span> <span class="nv">c</span> :
    e1 =<span class="mi">2</span> e2 -&gt; gpath e1 t1 t2 c = gpath e2 t1 t2 c.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><div><var>r, e1, e2</var><span class="hyp-type"><b>:</b><span>rel T</span></span></div><q>53</q><div><var>c</var><span class="hyp-type"><b>:</b><span>seq T</span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion">e1 =<span class="mi">2</span> e2 -&gt; gpath e1 t1 t2 c = gpath e2 t1 t2 c</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>459</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">move</span>=&gt; e1Ee2; <span class="nb">apply</span>/gpathP/gpathP; <span class="nb">rewrite</span> (eq_path e1Ee2) (eq_dist e1Ee2).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Lemma</span> <span class="nf">gpathC</span> <span class="nv">t1</span> <span class="nv">t2</span> <span class="nv">p</span> : 
 symmetric r -&gt; gpath r t1 t2 p -&gt; gpath r t2 t1 (rev (belast t1 p)).</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><q>80</q><span class="goal-separator"><hr></span><div class="goal-conclusion">symmetric r -&gt;
gpath r t1 t2 p -&gt; gpath r t2 t1 (rev (belast t1 p))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="kn">Proof</span>.</label><small class="alectryon-output"><div><q>461</q></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><label class="alectryon-input"><span class="nb">move</span>=&gt; hIrr /gpath_rev.</label><small class="alectryon-output"><div><div class="alectryon-goals"><blockquote class="alectryon-goal"><div class="goal-hyps"><q>5</q><q>6</q><q>53</q><q>2b</q><div><var>hIrr</var><span class="hyp-type"><b>:</b><span>symmetric r</span></span></div></div><span class="goal-separator"><hr></span><div class="goal-conclusion">gpath (<span class="kr">fun</span> <span class="nv">z</span> : T =&gt; r^~ z) t2 t1 (rev (belast t1 p)) -&gt;
gpath r t2 t1 (rev (belast t1 p))</div></blockquote></div></div></small><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="bp">by</span> <span class="nb">rewrite</span> (@eq_gpath _ _ _ _ _ (_ : _ =<span class="mi">2</span> r)).</span><span class="alectryon-wsp">
</span></span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">Qed</span>.</span><span class="alectryon-wsp">
</span></span><span class="alectryon-wsp">
</span><span class="alectryon-sentence"><span class="alectryon-input"><span class="kn">End</span> <span class="nf">gdistProp</span>.</span><span class="alectryon-wsp">
</span></span></pre></article></body></html>